import{f as K,a as X,t as Zs,c as Wn}from"../chunks/qHRkqzZS.js";import{i as Xe}from"../chunks/DPx2lHXl.js";import{o as Ee,c as zi,a as Pi}from"../chunks/CSTSkMFu.js";import{I as Fr,h as Jt,ad as Js,am as to,C as eo,b as no,j as l,T as Re,D as ro,F as ao,G as Va,J as Lr,c as An,ag as io,K as Bi,a as qi,L as so,av as ji,ak as Hi,p as Oi,Z as H,aw as Ya,ax as Dr,O as ea,a9 as Xa,ay as wa,az as oo,aA as ka,aB as Wa,aC as lo,aj as co,aD as uo,d as fo,aE as ho,ae as po,aF as vo,aG as go,aH as mo,aI as yo,aJ as xo,g as Ui,N as Ma,aK as bo,aL as Vi,ab as _o,M as Yi,aM as wo,y as v,n as ko,z as p,w as Tt,t as Me,au as Fn,x as Ae,A as _,aN as ot,k as Rt,aO as We,Y as F,B as At,aP as Ga,aQ as Zt,v as Ce,as as ue,X as Rn,aR as sr}from"../chunks/BD_qM0Sa.js";import{a as Mo,l as yr,s as Y,e as Ve}from"../chunks/TAZr9h0G.js";import{p as te,b as nn,i as Et,c as Qa,s as Ao}from"../chunks/C8hyNlV_.js";import{w as $o,b as Co}from"../chunks/DnmJKswC.js";import{s as So}from"../chunks/CkuBDuny.js";function Dn(t,e){return e}function Ro(t,e,n,r){for(var a=[],i=e.length,s=0;s<i;s++)lo(e[s].e,a,!0);var o=i>0&&a.length===0&&n!==null;if(o){var c=n.parentNode;co(c),c.append(n),r.clear(),Oe(t,e[0].prev,e[i-1].next)}uo(a,()=>{for(var u=0;u<i;u++){var d=e[u];o||(r.delete(d.k),Oe(t,d.prev,d.next)),fo(d.e,!o)}})}function zn(t,e,n,r,a,i=null){var s=t,o={flags:e,items:new Map,first:null},c=(e&ji)!==0;if(c){var u=t;s=Jt?Fr(Js(u)):u.appendChild(to())}Jt&&eo();var d=null,f=!1,h=Re(()=>{var m=n();return Oi(m)?m:m==null?[]:Hi(m)});no(()=>{var m=l(h),A=m.length;if(f&&A===0)return;f=A===0;let L=!1;if(Jt){var y=ro(s)===ao;y!==(A===0)&&(s=Va(),Fr(s),Lr(!1),L=!0)}if(Jt){for(var g=null,x,b=0;b<A;b++){if(An.nodeType===8&&An.data===io){s=An,L=!0,Lr(!1);break}var C=m[b],$=r(C,b);x=Xi(An,o,g,null,C,$,b,a,e,n),o.items.set($,x),g=x}A>0&&Fr(Va())}Jt||To(m,o,s,a,e,r,n),i!==null&&(A===0?d?Bi(d):d=qi(()=>i(s)):d!==null&&so(d,()=>{d=null})),L&&Lr(!0),l(h)}),Jt&&(s=An)}function To(t,e,n,r,a,i,s){var z,V,I,q;var o=(a&oo)!==0,c=(a&(ka|wa))!==0,u=t.length,d=e.items,f=e.first,h=f,m,A=null,L,y=[],g=[],x,b,C,$;if(o)for($=0;$<u;$+=1)x=t[$],b=i(x,$),C=d.get(b),C!==void 0&&((z=C.a)==null||z.measure(),(L??(L=new Set)).add(C));for($=0;$<u;$+=1){if(x=t[$],b=i(x,$),C=d.get(b),C===void 0){var N=h?h.e.nodes_start:n;A=Xi(N,e,A,A===null?e.first:A.next,x,b,$,r,a,s),d.set(b,A),y=[],g=[],h=A.next;continue}if(c&&No(C,x,$,a),(C.e.f&Dr)!==0&&(Bi(C.e),o&&((V=C.a)==null||V.unfix(),(L??(L=new Set)).delete(C))),C!==h){if(m!==void 0&&m.has(C)){if(y.length<g.length){var M=g[0],T;A=M.prev;var S=y[0],E=y[y.length-1];for(T=0;T<y.length;T+=1)Ka(y[T],M,n);for(T=0;T<g.length;T+=1)m.delete(g[T]);Oe(e,S.prev,E.next),Oe(e,A,S),Oe(e,E,M),h=M,A=E,$-=1,y=[],g=[]}else m.delete(C),Ka(C,h,n),Oe(e,C.prev,C.next),Oe(e,C,A===null?e.first:A.next),Oe(e,A,C),A=C;continue}for(y=[],g=[];h!==null&&h.k!==b;)(h.e.f&Dr)===0&&(m??(m=new Set)).add(h),g.push(h),h=h.next;if(h===null)continue;C=h}y.push(C),A=C,h=C.next}if(h!==null||m!==void 0){for(var w=m===void 0?[]:Hi(m);h!==null;)(h.e.f&Dr)===0&&w.push(h),h=h.next;var P=w.length;if(P>0){var k=(a&ji)!==0&&u===0?n:null;if(o){for($=0;$<P;$+=1)(I=w[$].a)==null||I.measure();for($=0;$<P;$+=1)(q=w[$].a)==null||q.fix()}Ro(e,w,k,d)}}o&&ea(()=>{var it;if(L!==void 0)for(C of L)(it=C.a)==null||it.apply()}),Xa.first=e.first&&e.first.e,Xa.last=A&&A.e}function No(t,e,n,r){(r&ka)!==0&&Wa(t.v,e),(r&wa)!==0?Wa(t.i,n):t.i=n}function Xi(t,e,n,r,a,i,s,o,c,u){var d=(c&ka)!==0,f=(c&ho)===0,h=d?f?H(a):Ya(a):a,m=(c&wa)===0?s:Ya(s),A={i:m,v:h,k:i,a:null,e:null,prev:n,next:r};try{return A.e=qi(()=>o(t,h,m,u),Jt),A.e.prev=n&&n.e,A.e.next=r&&r.e,n===null?e.first=A:(n.next=A,n.e.next=A.e),r!==null&&(r.prev=A,r.e.prev=A.e),A}finally{}}function Ka(t,e,n){for(var r=t.next?t.next.e.nodes_start:n,a=e?e.e.nodes_start:n,i=t.e.nodes_start;i!==r;){var s=po(i);a.before(i),i=s}}function Oe(t,e,n){e===null?t.first=n:(e.next=n,e.e.next=n&&n.e),n!==null&&(n.prev=e,n.e.prev=e&&e.e)}function Wi(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(n=Wi(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Eo(){for(var t,e,n=0,r="",a=arguments.length;n<a;n++)(t=arguments[n])&&(e=Wi(t))&&(r&&(r+=" "),r+=e);return r}function Gn(t){return typeof t=="object"?Eo(t):t??""}const Za=[...` 	
\r\f \v\uFEFF`];function Io(t,e,n){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),n){for(var a in n)if(n[a])r=r?r+" "+a:a;else if(r.length)for(var i=a.length,s=0;(s=r.indexOf(a,s))>=0;){var o=s+i;(s===0||Za.includes(r[s-1]))&&(o===r.length||Za.includes(r[o]))?r=(s===0?"":r.substring(0,s))+r.substring(o+1):s=o}}return r===""?null:r}function Fo(t,e){return t==null?null:String(t)}function Kt(t,e,n,r,a,i){var s=t.__className;if(Jt||s!==n||s===void 0){var o=Io(n,r,i);(!Jt||o!==t.getAttribute("class"))&&(o==null?t.removeAttribute("class"):t.className=o),t.__className=n}else if(i&&a!==i)for(var c in i){var u=!!i[c];(a==null||u!==!!a[c])&&t.classList.toggle(c,u)}return i}function Gi(t,e,n,r){var a=t.__style;if(Jt||a!==e){var i=Fo(e);(!Jt||i!==t.getAttribute("style"))&&(i==null?t.removeAttribute("style"):t.style.cssText=i),t.__style=e}return r}const Lo=Symbol("is custom element"),Do=Symbol("is html");function wt(t){if(Jt){var e=!1,n=()=>{if(!e){if(e=!0,t.hasAttribute("value")){var r=t.value;rt(t,"value",null),t.value=r}if(t.hasAttribute("checked")){var a=t.checked;rt(t,"checked",null),t.checked=a}}};t.__on_r=n,vo(n),Mo()}}function rt(t,e,n,r){var a=zo(t);Jt&&(a[e]=t.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&t.nodeName==="LINK")||a[e]!==(a[e]=n)&&(e==="loading"&&(t[go]=n),n==null?t.removeAttribute(e):typeof n!="string"&&Po(t).includes(e)?t[e]=n:t.setAttribute(e,n))}function zo(t){return t.__attributes??(t.__attributes={[Lo]:t.nodeName.includes("-"),[Do]:t.namespaceURI===mo})}var Ja=new Map;function Po(t){var e=Ja.get(t.nodeName);if(e)return e;Ja.set(t.nodeName,e=[]);for(var n,r=t,a=Element.prototype;a!==r;){n=xo(r);for(var i in n)n[i].set&&e.push(i);r=yo(r)}return e}const Bo=()=>performance.now(),Se={tick:t=>requestAnimationFrame(t),now:()=>Bo(),tasks:new Set};function Qi(){const t=Se.now();Se.tasks.forEach(e=>{e.c(t)||(Se.tasks.delete(e),e.f())}),Se.tasks.size!==0&&Se.tick(Qi)}function qo(t){let e;return Se.tasks.size===0&&Se.tick(Qi),{promise:new Promise(n=>{Se.tasks.add(e={c:t,f:n})}),abort(){Se.tasks.delete(e)}}}function se(t,e,n=e){var r=bo();yr(t,"input",a=>{var i=a?t.defaultValue:t.value;if(i=Br(t)?qr(i):i,n(i),r&&i!==(i=e())){var s=t.selectionStart,o=t.selectionEnd;t.value=i??"",o!==null&&(t.selectionStart=s,t.selectionEnd=Math.min(o,t.value.length))}}),(Jt&&t.defaultValue!==t.value||Ui(e)==null&&t.value)&&n(Br(t)?qr(t.value):t.value),Ma(()=>{var a=e();Br(t)&&a===qr(t.value)||t.type==="date"&&!a&&!t.value||a!==t.value&&(t.value=a??"")})}const zr=new Set;function Pr(t,e,n,r,a=r){var i=n.getAttribute("type")==="checkbox",s=t;let o=!1;if(e!==null)for(var c of e)s=s[c]??(s[c]=[]);s.push(n),yr(n,"change",()=>{var u=n.__value;i&&(u=ti(s,u,n.checked)),a(u)},()=>a(i?[]:null)),Ma(()=>{var u=r();if(Jt&&n.defaultChecked!==n.checked){o=!0;return}i?(u=u||[],n.checked=u.includes(n.__value)):n.checked=Vi(n.__value,u)}),_o(()=>{var u=s.indexOf(n);u!==-1&&s.splice(u,1)}),zr.has(s)||(zr.add(s),ea(()=>{s.sort((u,d)=>u.compareDocumentPosition(d)===4?-1:1),zr.delete(s)})),ea(()=>{if(o){var u;if(i)u=ti(s,u,n.checked);else{var d=s.find(f=>f.checked);u=d==null?void 0:d.__value}a(u)}})}function fe(t,e,n=e){yr(t,"change",r=>{var a=r?t.defaultChecked:t.checked;n(a)}),(Jt&&t.defaultChecked!==t.checked||Ui(e)==null)&&n(t.checked),Ma(()=>{var r=e();t.checked=!!r})}function ti(t,e,n){for(var r=new Set,a=0;a<t.length;a+=1)t[a].checked&&r.add(t[a].__value);return n||r.delete(e),Array.from(r)}function Br(t){var e=t.type;return e==="number"||e==="range"}function qr(t){return t===""?null:+t}function Ki(t,e,n){if(t.multiple)return e==null?void 0:Oi(e)?Ho(t,e):wo();for(var r of t.options){var a=Ln(r);if(Vi(a,e)){r.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function jo(t,e){Yi(()=>{var n=new MutationObserver(()=>{var r=t.__value;Ki(t,r)});return n.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{n.disconnect()}})}function ei(t,e,n=e){var r=!0;yr(t,"change",a=>{var i=a?"[selected]":":checked",s;if(t.multiple)s=[].map.call(t.querySelectorAll(i),Ln);else{var o=t.querySelector(i)??t.querySelector("option:not([disabled])");s=o&&Ln(o)}n(s)}),Yi(()=>{var a=e();if(Ki(t,a,r),r&&a===void 0){var i=t.querySelector(":checked");i!==null&&(a=Ln(i),n(a))}t.__value=a,r=!1}),jo(t)}function Ho(t,e){for(var n of t.options)n.selected=e.includes(Ln(n))}function Ln(t){return"__value"in t?t.__value:t.value}var Oo=K("<div><!></div>");function Uo(t,e){var n=Oo(),r=v(n);So(r,()=>e.children??ko),p(n),Tt(()=>Kt(n,1,`mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 ${e.class&&e.class}`)),X(t,n)}var ni={},jr={},Hr=34,$n=10,Or=13;function Zi(t){return new Function("d","return {"+t.map(function(e,n){return JSON.stringify(e)+": d["+n+'] || ""'}).join(",")+"}")}function Vo(t,e){var n=Zi(t);return function(r,a){return e(n(r),a,t)}}function ri(t){var e=Object.create(null),n=[];return t.forEach(function(r){for(var a in r)a in e||n.push(e[a]=a)}),n}function ae(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function Yo(t){return t<0?"-"+ae(-t,6):t>9999?"+"+ae(t,6):ae(t,4)}function Xo(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),a=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":Yo(t.getUTCFullYear())+"-"+ae(t.getUTCMonth()+1,2)+"-"+ae(t.getUTCDate(),2)+(a?"T"+ae(e,2)+":"+ae(n,2)+":"+ae(r,2)+"."+ae(a,3)+"Z":r?"T"+ae(e,2)+":"+ae(n,2)+":"+ae(r,2)+"Z":n||e?"T"+ae(e,2)+":"+ae(n,2)+"Z":"")}function Wo(t){var e=new RegExp('["'+t+`
\r]`),n=t.charCodeAt(0);function r(f,h){var m,A,L=a(f,function(y,g){if(m)return m(y,g-1);A=y,m=h?Vo(y,h):Zi(y)});return L.columns=A||[],L}function a(f,h){var m=[],A=f.length,L=0,y=0,g,x=A<=0,b=!1;f.charCodeAt(A-1)===$n&&--A,f.charCodeAt(A-1)===Or&&--A;function C(){if(x)return jr;if(b)return b=!1,ni;var N,M=L,T;if(f.charCodeAt(M)===Hr){for(;L++<A&&f.charCodeAt(L)!==Hr||f.charCodeAt(++L)===Hr;);return(N=L)>=A?x=!0:(T=f.charCodeAt(L++))===$n?b=!0:T===Or&&(b=!0,f.charCodeAt(L)===$n&&++L),f.slice(M+1,N-1).replace(/""/g,'"')}for(;L<A;){if((T=f.charCodeAt(N=L++))===$n)b=!0;else if(T===Or)b=!0,f.charCodeAt(L)===$n&&++L;else if(T!==n)continue;return f.slice(M,N)}return x=!0,f.slice(M,A)}for(;(g=C())!==jr;){for(var $=[];g!==ni&&g!==jr;)$.push(g),g=C();h&&($=h($,y++))==null||m.push($)}return m}function i(f,h){return f.map(function(m){return h.map(function(A){return d(m[A])}).join(t)})}function s(f,h){return h==null&&(h=ri(f)),[h.map(d).join(t)].concat(i(f,h)).join(`
`)}function o(f,h){return h==null&&(h=ri(f)),i(f,h).join(`
`)}function c(f){return f.map(u).join(`
`)}function u(f){return f.map(d).join(t)}function d(f){return f==null?"":f instanceof Date?Xo(f):e.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:a,format:s,formatBody:o,formatRows:c,formatRow:u,formatValue:d}}var Go=Wo(","),Qo=Go.parse;function Ko(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function Zo(t,e){return fetch(t,e).then(Ko)}function Jo(t){return function(e,n,r){return arguments.length===2&&typeof n=="function"&&(r=n,n=void 0),Zo(e,n).then(function(a){return t(a,r)})}}var tl=Jo(Qo);function ai(t){return Object.prototype.toString.call(t)==="[object Date]"}function el(t){return t}function nl(t){const e=t-1;return e*e*e+1}function na(t,e){if(t===e||t!==t)return()=>t;const n=typeof t;if(n!==typeof e||Array.isArray(t)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(t)){const r=e.map((a,i)=>na(t[i],a));return a=>r.map(i=>i(a))}if(n==="object"){if(!t||!e)throw new Error("Object cannot be null");if(ai(t)&&ai(e)){const i=t.getTime(),o=e.getTime()-i;return c=>new Date(i+c*o)}const r=Object.keys(e),a={};return r.forEach(i=>{a[i]=na(t[i],e[i])}),i=>{const s={};return r.forEach(o=>{s[o]=a[o](i)}),s}}if(n==="number"){const r=e-t;return a=>t+a*r}return()=>e}function rl(t,e={}){const n=$o(t);let r,a=t;function i(s,o){if(a=s,t==null)return n.set(t=s),Promise.resolve();let c=r,u=!1,{delay:d=0,duration:f=400,easing:h=el,interpolate:m=na}={...e,...o};if(f===0)return c&&(c.abort(),c=null),n.set(t=a),Promise.resolve();const A=Se.now()+d;let L;return r=qo(y=>{if(y<A)return!0;u||(L=m(t,s),typeof f=="function"&&(f=f(t,s)),u=!0),c&&(c.abort(),c=null);const g=y-A;return g>f?(n.set(t=s),!1):(n.set(t=L(h(g/f))),!0)}),r.promise}return{set:i,update:(s,o)=>i(s(a,t),o),subscribe:n.subscribe}}var al=K('<div class="text-center"><h2 class="text-4xl font-extrabold tracking-tight tabular-nums svelte-19d6zus"> </h2> <p class="text-text-secondary text-xs tracking-wide uppercase"> </p></div>'),il=K('<div class="mt-6 flex flex-wrap justify-center gap-8"></div>');function sl(t,e){Me(e,!0);let n=te(e,"duration",3,1200);const r=Fn(()=>e.stats.map(()=>rl(0,{duration:n(),easing:nl})));Ee(()=>{let i=0;e.stats.forEach(({value:s},o)=>{setTimeout(()=>l(r)[o].set(s),i),i+=n()+400})});var a=il();zn(a,21,()=>e.stats,Dn,(i,s,o)=>{let c=()=>l(s).label;var u=al(),d=v(u),f=v(d,!0);p(d);var h=_(d,2),m=v(h,!0);p(h),p(u),Tt(()=>{Y(f,e.stats[o].value),Y(m,c())}),X(i,u)}),p(a),X(t,a),Ae()}var ol=K(`<div class="slide-container svelte-5descd"><div class="content svelte-5descd"><h1 class="title svelte-5descd">Vitals&nbsp;Unveiled:<br/> <span class="text-text-accent">When "Routine" Surgeries Take Unexpected Turns</span></h1> <p class="description svelte-5descd">Imagine an operating room humming along in perfect rhythm—dozens of cases lined up, each one
			expected to end smoothly. Yet among those <strong>6 388</strong> surgeries lie stories of sudden
			blood-loss emergencies, unplanned ICU detours, and the quiet heartbreak of lives forever changed.</p> <p class="description svelte-5descd">Today, we invite you on a journey through Seoul National University's VitalDB. We'll follow
			every heartbeat, incision, and lab result in search of the subtle signs that tip a "routine"
			case into crisis.</p> <p class="description svelte-5descd">Scroll down to meet our patients, feel the pulse of the OR phases, test your own predictions,
			and discover the hidden signals that could one day warn us—before the routine becomes critical.</p> <!></div></div>`);function ll(t,e){Me(e,!0);var n=ol(),r=v(n),a=_(v(r),8);const i=Fn(()=>[{label:"Total Surgeries",value:e.cases.length},{label:"ICU Transfers",value:e.cases.filter(s=>(s.icu_days??0)>0).length},{label:"In-Hospital Deaths",value:e.cases.filter(s=>s.death_inhosp===1).length}]);sl(a,{get stats(){return l(i)}}),p(r),p(n),X(t,n),Ae()}var ra="http://www.w3.org/1999/xhtml";const ii={svg:"http://www.w3.org/2000/svg",xhtml:ra,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function xr(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),ii.hasOwnProperty(e)?{space:ii[e],local:t}:t}function cl(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===ra&&e.documentElement.namespaceURI===ra?e.createElement(t):e.createElementNS(n,t)}}function ul(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Ji(t){var e=xr(t);return(e.local?ul:cl)(e)}function fl(){}function Aa(t){return t==null?fl:function(){return this.querySelector(t)}}function dl(t){typeof t!="function"&&(t=Aa(t));for(var e=this._groups,n=e.length,r=new Array(n),a=0;a<n;++a)for(var i=e[a],s=i.length,o=r[a]=new Array(s),c,u,d=0;d<s;++d)(c=i[d])&&(u=t.call(c,c.__data__,d,i))&&("__data__"in c&&(u.__data__=c.__data__),o[d]=u);return new de(r,this._parents)}function hl(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function pl(){return[]}function ts(t){return t==null?pl:function(){return this.querySelectorAll(t)}}function vl(t){return function(){return hl(t.apply(this,arguments))}}function gl(t){typeof t=="function"?t=vl(t):t=ts(t);for(var e=this._groups,n=e.length,r=[],a=[],i=0;i<n;++i)for(var s=e[i],o=s.length,c,u=0;u<o;++u)(c=s[u])&&(r.push(t.call(c,c.__data__,u,s)),a.push(c));return new de(r,a)}function es(t){return function(){return this.matches(t)}}function ns(t){return function(e){return e.matches(t)}}var ml=Array.prototype.find;function yl(t){return function(){return ml.call(this.children,t)}}function xl(){return this.firstElementChild}function bl(t){return this.select(t==null?xl:yl(typeof t=="function"?t:ns(t)))}var _l=Array.prototype.filter;function wl(){return Array.from(this.children)}function kl(t){return function(){return _l.call(this.children,t)}}function Ml(t){return this.selectAll(t==null?wl:kl(typeof t=="function"?t:ns(t)))}function Al(t){typeof t!="function"&&(t=es(t));for(var e=this._groups,n=e.length,r=new Array(n),a=0;a<n;++a)for(var i=e[a],s=i.length,o=r[a]=[],c,u=0;u<s;++u)(c=i[u])&&t.call(c,c.__data__,u,i)&&o.push(c);return new de(r,this._parents)}function rs(t){return new Array(t.length)}function $l(){return new de(this._enter||this._groups.map(rs),this._parents)}function or(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}or.prototype={constructor:or,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Cl(t){return function(){return t}}function Sl(t,e,n,r,a,i){for(var s=0,o,c=e.length,u=i.length;s<u;++s)(o=e[s])?(o.__data__=i[s],r[s]=o):n[s]=new or(t,i[s]);for(;s<c;++s)(o=e[s])&&(a[s]=o)}function Rl(t,e,n,r,a,i,s){var o,c,u=new Map,d=e.length,f=i.length,h=new Array(d),m;for(o=0;o<d;++o)(c=e[o])&&(h[o]=m=s.call(c,c.__data__,o,e)+"",u.has(m)?a[o]=c:u.set(m,c));for(o=0;o<f;++o)m=s.call(t,i[o],o,i)+"",(c=u.get(m))?(r[o]=c,c.__data__=i[o],u.delete(m)):n[o]=new or(t,i[o]);for(o=0;o<d;++o)(c=e[o])&&u.get(h[o])===c&&(a[o]=c)}function Tl(t){return t.__data__}function Nl(t,e){if(!arguments.length)return Array.from(this,Tl);var n=e?Rl:Sl,r=this._parents,a=this._groups;typeof t!="function"&&(t=Cl(t));for(var i=a.length,s=new Array(i),o=new Array(i),c=new Array(i),u=0;u<i;++u){var d=r[u],f=a[u],h=f.length,m=El(t.call(d,d&&d.__data__,u,r)),A=m.length,L=o[u]=new Array(A),y=s[u]=new Array(A),g=c[u]=new Array(h);n(d,f,L,y,g,m,e);for(var x=0,b=0,C,$;x<A;++x)if(C=L[x]){for(x>=b&&(b=x+1);!($=y[b])&&++b<A;);C._next=$||null}}return s=new de(s,r),s._enter=o,s._exit=c,s}function El(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Il(){return new de(this._exit||this._groups.map(rs),this._parents)}function Fl(t,e,n){var r=this.enter(),a=this,i=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(a=e(a),a&&(a=a.selection())),n==null?i.remove():n(i),r&&a?r.merge(a).order():a}function Ll(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,a=n.length,i=r.length,s=Math.min(a,i),o=new Array(a),c=0;c<s;++c)for(var u=n[c],d=r[c],f=u.length,h=o[c]=new Array(f),m,A=0;A<f;++A)(m=u[A]||d[A])&&(h[A]=m);for(;c<a;++c)o[c]=n[c];return new de(o,this._parents)}function Dl(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],a=r.length-1,i=r[a],s;--a>=0;)(s=r[a])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function zl(t){t||(t=Pl);function e(f,h){return f&&h?t(f.__data__,h.__data__):!f-!h}for(var n=this._groups,r=n.length,a=new Array(r),i=0;i<r;++i){for(var s=n[i],o=s.length,c=a[i]=new Array(o),u,d=0;d<o;++d)(u=s[d])&&(c[d]=u);c.sort(e)}return new de(a,this._parents).order()}function Pl(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Bl(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function ql(){return Array.from(this)}function jl(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],a=0,i=r.length;a<i;++a){var s=r[a];if(s)return s}return null}function Hl(){let t=0;for(const e of this)++t;return t}function Ol(){return!this.node()}function Ul(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var a=e[n],i=0,s=a.length,o;i<s;++i)(o=a[i])&&t.call(o,o.__data__,i,a);return this}function Vl(t){return function(){this.removeAttribute(t)}}function Yl(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Xl(t,e){return function(){this.setAttribute(t,e)}}function Wl(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Gl(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Ql(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Kl(t,e){var n=xr(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Yl:Vl:typeof e=="function"?n.local?Ql:Gl:n.local?Wl:Xl)(n,e))}function as(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Zl(t){return function(){this.style.removeProperty(t)}}function Jl(t,e,n){return function(){this.style.setProperty(t,e,n)}}function tc(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function ec(t,e,n){return arguments.length>1?this.each((e==null?Zl:typeof e=="function"?tc:Jl)(t,e,n??"")):mn(this.node(),t)}function mn(t,e){return t.style.getPropertyValue(e)||as(t).getComputedStyle(t,null).getPropertyValue(e)}function nc(t){return function(){delete this[t]}}function rc(t,e){return function(){this[t]=e}}function ac(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function ic(t,e){return arguments.length>1?this.each((e==null?nc:typeof e=="function"?ac:rc)(t,e)):this.node()[t]}function is(t){return t.trim().split(/^|\s+/)}function $a(t){return t.classList||new ss(t)}function ss(t){this._node=t,this._names=is(t.getAttribute("class")||"")}ss.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function os(t,e){for(var n=$a(t),r=-1,a=e.length;++r<a;)n.add(e[r])}function ls(t,e){for(var n=$a(t),r=-1,a=e.length;++r<a;)n.remove(e[r])}function sc(t){return function(){os(this,t)}}function oc(t){return function(){ls(this,t)}}function lc(t,e){return function(){(e.apply(this,arguments)?os:ls)(this,t)}}function cc(t,e){var n=is(t+"");if(arguments.length<2){for(var r=$a(this.node()),a=-1,i=n.length;++a<i;)if(!r.contains(n[a]))return!1;return!0}return this.each((typeof e=="function"?lc:e?sc:oc)(n,e))}function uc(){this.textContent=""}function fc(t){return function(){this.textContent=t}}function dc(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function hc(t){return arguments.length?this.each(t==null?uc:(typeof t=="function"?dc:fc)(t)):this.node().textContent}function pc(){this.innerHTML=""}function vc(t){return function(){this.innerHTML=t}}function gc(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function mc(t){return arguments.length?this.each(t==null?pc:(typeof t=="function"?gc:vc)(t)):this.node().innerHTML}function yc(){this.nextSibling&&this.parentNode.appendChild(this)}function xc(){return this.each(yc)}function bc(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function _c(){return this.each(bc)}function wc(t){var e=typeof t=="function"?t:Ji(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function kc(){return null}function Mc(t,e){var n=typeof t=="function"?t:Ji(t),r=e==null?kc:typeof e=="function"?e:Aa(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Ac(){var t=this.parentNode;t&&t.removeChild(this)}function $c(){return this.each(Ac)}function Cc(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Sc(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Rc(t){return this.select(t?Sc:Cc)}function Tc(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Nc(t){return function(e){t.call(this,e,this.__data__)}}function Ec(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Ic(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,a=e.length,i;n<a;++n)i=e[n],(!t.type||i.type===t.type)&&i.name===t.name?this.removeEventListener(i.type,i.listener,i.options):e[++r]=i;++r?e.length=r:delete this.__on}}}function Fc(t,e,n){return function(){var r=this.__on,a,i=Nc(e);if(r){for(var s=0,o=r.length;s<o;++s)if((a=r[s]).type===t.type&&a.name===t.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=i,a.options=n),a.value=e;return}}this.addEventListener(t.type,i,n),a={type:t.type,name:t.name,value:e,listener:i,options:n},r?r.push(a):this.__on=[a]}}function Lc(t,e,n){var r=Ec(t+""),a,i=r.length,s;if(arguments.length<2){var o=this.node().__on;if(o){for(var c=0,u=o.length,d;c<u;++c)for(a=0,d=o[c];a<i;++a)if((s=r[a]).type===d.type&&s.name===d.name)return d.value}return}for(o=e?Fc:Ic,a=0;a<i;++a)this.each(o(r[a],e,n));return this}function cs(t,e,n){var r=as(t),a=r.CustomEvent;typeof a=="function"?a=new a(e,n):(a=r.document.createEvent("Event"),n?(a.initEvent(e,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(e,!1,!1)),t.dispatchEvent(a)}function Dc(t,e){return function(){return cs(this,t,e)}}function zc(t,e){return function(){return cs(this,t,e.apply(this,arguments))}}function Pc(t,e){return this.each((typeof e=="function"?zc:Dc)(t,e))}function*Bc(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],a=0,i=r.length,s;a<i;++a)(s=r[a])&&(yield s)}var us=[null];function de(t,e){this._groups=t,this._parents=e}function _n(){return new de([[document.documentElement]],us)}function qc(){return this}de.prototype=_n.prototype={constructor:de,select:dl,selectAll:gl,selectChild:bl,selectChildren:Ml,filter:Al,data:Nl,enter:$l,exit:Il,join:Fl,merge:Ll,selection:qc,order:Dl,sort:zl,call:Bl,nodes:ql,node:jl,size:Hl,empty:Ol,each:Ul,attr:Kl,style:ec,property:ic,classed:cc,text:hc,html:mc,raise:xc,lower:_c,append:wc,insert:Mc,remove:$c,clone:Rc,datum:Tc,on:Lc,dispatch:Pc,[Symbol.iterator]:Bc};function W(t){return typeof t=="string"?new de([[document.querySelector(t)]],[document.documentElement]):new de([[t]],us)}function jc(t){let e;for(;e=t.sourceEvent;)t=e;return t}function aa(t,e){if(t=jc(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var a=e.getBoundingClientRect();return[t.clientX-a.left-e.clientLeft,t.clientY-a.top-e.clientTop]}}return[t.pageX,t.pageY]}function vn(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function fs(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ds(t){let e,n,r;t.length!==2?(e=vn,n=(o,c)=>vn(t(o),c),r=(o,c)=>t(o)-c):(e=t===vn||t===fs?t:Hc,n=t,r=t);function a(o,c,u=0,d=o.length){if(u<d){if(e(c,c)!==0)return d;do{const f=u+d>>>1;n(o[f],c)<0?u=f+1:d=f}while(u<d)}return u}function i(o,c,u=0,d=o.length){if(u<d){if(e(c,c)!==0)return d;do{const f=u+d>>>1;n(o[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function s(o,c,u=0,d=o.length){const f=a(o,c,u,d-1);return f>u&&r(o[f-1],c)>-r(o[f],c)?f-1:f}return{left:a,center:s,right:i}}function Hc(){return 0}function Oc(t){return t===null?NaN:+t}function*Uc(t,e){if(e===void 0)for(let n of t)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)(r=e(r,++n,t))!=null&&(r=+r)>=r&&(yield r)}}const Vc=ds(vn),hs=Vc.right;ds(Oc).center;function Yc(t,e){let n=0;for(let r of t)r!=null&&(r=+r)>=r&&++n;return n}function tr(t,e){let n,r;if(e===void 0)for(const a of t)a!=null&&(n===void 0?a>=a&&(n=r=a):(n>a&&(n=a),r<a&&(r=a)));else{let a=-1;for(let i of t)(i=e(i,++a,t))!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)))}return[n,r]}class ia extends Map{constructor(e,n=Gc){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,a]of e)this.set(r,a)}get(e){return super.get(si(this,e))}has(e){return super.has(si(this,e))}set(e,n){return super.set(Xc(this,e),n)}delete(e){return super.delete(Wc(this,e))}}function si({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function Xc({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function Wc({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function Gc(t){return t!==null&&typeof t=="object"?t.valueOf():t}function ps(t){return t}function Qc(t,e,...n){return Kc(t,ps,e,n)}function Kc(t,e,n,r){return function a(i,s){if(s>=r.length)return n(i);const o=new ia,c=r[s++];let u=-1;for(const d of i){const f=c(d,++u,i),h=o.get(f);h?h.push(d):o.set(f,[d])}for(const[d,f]of o)o.set(d,a(f,s));return e(o)}(t,0)}function Zc(t=vn){if(t===vn)return vs;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||r===0?r:(t(n,n)===0)-(t(e,e)===0)}}function vs(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}var Jc=Array.prototype,tu=Jc.slice;function Ur(t){return()=>t}const eu=Math.sqrt(50),nu=Math.sqrt(10),ru=Math.sqrt(2);function lr(t,e,n){const r=(e-t)/Math.max(0,n),a=Math.floor(Math.log10(r)),i=r/Math.pow(10,a),s=i>=eu?10:i>=nu?5:i>=ru?2:1;let o,c,u;return a<0?(u=Math.pow(10,-a)/s,o=Math.round(t*u),c=Math.round(e*u),o/u<t&&++o,c/u>e&&--c,u=-u):(u=Math.pow(10,a)*s,o=Math.round(t/u),c=Math.round(e/u),o*u<t&&++o,c*u>e&&--c),c<o&&.5<=n&&n<2?lr(t,e,n*2):[o,c,u]}function gs(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[a,i,s]=r?lr(e,t,n):lr(t,e,n);if(!(i>=a))return[];const o=i-a+1,c=new Array(o);if(r)if(s<0)for(let u=0;u<o;++u)c[u]=(i-u)/-s;else for(let u=0;u<o;++u)c[u]=(i-u)*s;else if(s<0)for(let u=0;u<o;++u)c[u]=(a+u)/-s;else for(let u=0;u<o;++u)c[u]=(a+u)*s;return c}function yn(t,e,n){return e=+e,t=+t,n=+n,lr(t,e,n)[2]}function au(t,e,n){e=+e,t=+t,n=+n;const r=e<t,a=r?yn(e,t,n):yn(t,e,n);return(r?-1:1)*(a<0?1/-a:a)}function iu(t,e,n){let r;for(;;){const a=yn(t,e,n);if(a===r||a===0||!isFinite(a))return[t,e];a>0?(t=Math.floor(t/a)*a,e=Math.ceil(e/a)*a):a<0&&(t=Math.ceil(t*a)/a,e=Math.floor(e*a)/a),r=a}}function su(t){return Math.max(1,Math.ceil(Math.log(Yc(t))/Math.LN2)+1)}function ou(){var t=ps,e=tr,n=su;function r(a){Array.isArray(a)||(a=Array.from(a));var i,s=a.length,o,c,u=new Array(s);for(i=0;i<s;++i)u[i]=t(a[i],i,a);var d=e(u),f=d[0],h=d[1],m=n(u,f,h);if(!Array.isArray(m)){const b=h,C=+m;if(e===tr&&([f,h]=iu(f,h,C)),m=gs(f,h,C),m[0]<=f&&(c=yn(f,h,C)),m[m.length-1]>=h)if(b>=h&&e===tr){const $=yn(f,h,C);isFinite($)&&($>0?h=(Math.floor(h/$)+1)*$:$<0&&(h=(Math.ceil(h*-$)+1)/-$))}else m.pop()}for(var A=m.length,L=0,y=A;m[L]<=f;)++L;for(;m[y-1]>h;)--y;(L||y<A)&&(m=m.slice(L,y),A=y-L);var g=new Array(A+1),x;for(i=0;i<=A;++i)x=g[i]=[],x.x0=i>0?m[i-1]:f,x.x1=i<A?m[i]:h;if(isFinite(c)){if(c>0)for(i=0;i<s;++i)(o=u[i])!=null&&f<=o&&o<=h&&g[Math.min(A,Math.floor((o-f)/c))].push(a[i]);else if(c<0){for(i=0;i<s;++i)if((o=u[i])!=null&&f<=o&&o<=h){const b=Math.floor((f-o)*c);g[Math.min(A,b+(m[b]<=o))].push(a[i])}}}else for(i=0;i<s;++i)(o=u[i])!=null&&f<=o&&o<=h&&g[hs(m,o,0,A)].push(a[i]);return g}return r.value=function(a){return arguments.length?(t=typeof a=="function"?a:Ur(a),r):t},r.domain=function(a){return arguments.length?(e=typeof a=="function"?a:Ur([a[0],a[1]]),r):e},r.thresholds=function(a){return arguments.length?(n=typeof a=="function"?a:Ur(Array.isArray(a)?tu.call(a):a),r):n},r}function Te(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let a of t)(a=e(a,++r,t))!=null&&(n<a||n===void 0&&a>=a)&&(n=a)}return n}function sa(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let a of t)(a=e(a,++r,t))!=null&&(n>a||n===void 0&&a>=a)&&(n=a)}return n}function ms(t,e,n=0,r=1/0,a){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(a=a===void 0?vs:Zc(a);r>n;){if(r-n>600){const c=r-n+1,u=e-n+1,d=Math.log(c),f=.5*Math.exp(2*d/3),h=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),m=Math.max(n,Math.floor(e-u*f/c+h)),A=Math.min(r,Math.floor(e+(c-u)*f/c+h));ms(t,e,m,A,a)}const i=t[e];let s=n,o=r;for(Cn(t,n,e),a(t[r],i)>0&&Cn(t,n,r);s<o;){for(Cn(t,s,o),++s,--o;a(t[s],i)<0;)++s;for(;a(t[o],i)>0;)--o}a(t[n],i)===0?Cn(t,n,o):(++o,Cn(t,o,r)),o<=e&&(n=o+1),e<=o&&(r=o-1)}return t}function Cn(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Pn(t,e,n){if(t=Float64Array.from(Uc(t,n)),!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return sa(t);if(e>=1)return Te(t);var r,a=(r-1)*e,i=Math.floor(a),s=Te(ms(t,i).subarray(0,i+1)),o=sa(t.subarray(i+1));return s+(o-s)*(a-i)}}function oi(t,e){let n=0,r=0;for(let a of t)a!=null&&(a=+a)>=a&&(++n,r+=a);if(n)return r/n}function er(t,e){return Pn(t,.5,e)}function ys(t,e,n){t=+t,e=+e,n=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+n;for(var r=-1,a=Math.max(0,Math.ceil((e-t)/n))|0,i=new Array(a);++r<a;)i[r]=t+r*n;return i}function lu(t,e){let n=0;if(e===void 0)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let a of t)(a=+e(a,++r,t))&&(n+=a)}return n}function Ca(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function cu(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const li=Symbol("implicit");function br(){var t=new ia,e=[],n=[],r=li;function a(i){let s=t.get(i);if(s===void 0){if(r!==li)return r;t.set(i,s=e.push(i)-1)}return n[s%n.length]}return a.domain=function(i){if(!arguments.length)return e.slice();e=[],t=new ia;for(const s of i)t.has(s)||t.set(s,e.push(s)-1);return a},a.range=function(i){return arguments.length?(n=Array.from(i),a):n.slice()},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return br(e,n).unknown(r)},Ca.apply(a,arguments),a}function _r(){var t=br().unknown(void 0),e=t.domain,n=t.range,r=0,a=1,i,s,o=!1,c=0,u=0,d=.5;delete t.unknown;function f(){var h=e().length,m=a<r,A=m?a:r,L=m?r:a;i=(L-A)/Math.max(1,h-c+u*2),o&&(i=Math.floor(i)),A+=(L-A-i*(h-c))*d,s=i*(1-c),o&&(A=Math.round(A),s=Math.round(s));var y=ys(h).map(function(g){return A+i*g});return n(m?y.reverse():y)}return t.domain=function(h){return arguments.length?(e(h),f()):e()},t.range=function(h){return arguments.length?([r,a]=h,r=+r,a=+a,f()):[r,a]},t.rangeRound=function(h){return[r,a]=h,r=+r,a=+a,o=!0,f()},t.bandwidth=function(){return s},t.step=function(){return i},t.round=function(h){return arguments.length?(o=!!h,f()):o},t.padding=function(h){return arguments.length?(c=Math.min(1,u=+h),f()):c},t.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),f()):c},t.paddingOuter=function(h){return arguments.length?(u=+h,f()):u},t.align=function(h){return arguments.length?(d=Math.max(0,Math.min(1,h)),f()):d},t.copy=function(){return _r(e(),[r,a]).round(o).paddingInner(c).paddingOuter(u).align(d)},Ca.apply(f(),arguments)}function Sa(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function xs(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Hn(){}var Bn=.7,cr=1/Bn,gn="\\s*([+-]?\\d+)\\s*",qn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ne="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",uu=/^#([0-9a-f]{3,8})$/,fu=new RegExp(`^rgb\\(${gn},${gn},${gn}\\)$`),du=new RegExp(`^rgb\\(${Ne},${Ne},${Ne}\\)$`),hu=new RegExp(`^rgba\\(${gn},${gn},${gn},${qn}\\)$`),pu=new RegExp(`^rgba\\(${Ne},${Ne},${Ne},${qn}\\)$`),vu=new RegExp(`^hsl\\(${qn},${Ne},${Ne}\\)$`),gu=new RegExp(`^hsla\\(${qn},${Ne},${Ne},${qn}\\)$`),ci={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Sa(Hn,rn,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:ui,formatHex:ui,formatHex8:mu,formatHsl:yu,formatRgb:fi,toString:fi});function ui(){return this.rgb().formatHex()}function mu(){return this.rgb().formatHex8()}function yu(){return bs(this).formatHsl()}function fi(){return this.rgb().formatRgb()}function rn(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=uu.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?di(e):n===3?new oe(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Qn(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Qn(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=fu.exec(t))?new oe(e[1],e[2],e[3],1):(e=du.exec(t))?new oe(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=hu.exec(t))?Qn(e[1],e[2],e[3],e[4]):(e=pu.exec(t))?Qn(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=vu.exec(t))?vi(e[1],e[2]/100,e[3]/100,1):(e=gu.exec(t))?vi(e[1],e[2]/100,e[3]/100,e[4]):ci.hasOwnProperty(t)?di(ci[t]):t==="transparent"?new oe(NaN,NaN,NaN,0):null}function di(t){return new oe(t>>16&255,t>>8&255,t&255,1)}function Qn(t,e,n,r){return r<=0&&(t=e=n=NaN),new oe(t,e,n,r)}function xu(t){return t instanceof Hn||(t=rn(t)),t?(t=t.rgb(),new oe(t.r,t.g,t.b,t.opacity)):new oe}function ur(t,e,n,r){return arguments.length===1?xu(t):new oe(t,e,n,r??1)}function oe(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Sa(oe,ur,xs(Hn,{brighter(t){return t=t==null?cr:Math.pow(cr,t),new oe(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Bn:Math.pow(Bn,t),new oe(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new oe(en(this.r),en(this.g),en(this.b),fr(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:hi,formatHex:hi,formatHex8:bu,formatRgb:pi,toString:pi}));function hi(){return`#${tn(this.r)}${tn(this.g)}${tn(this.b)}`}function bu(){return`#${tn(this.r)}${tn(this.g)}${tn(this.b)}${tn((isNaN(this.opacity)?1:this.opacity)*255)}`}function pi(){const t=fr(this.opacity);return`${t===1?"rgb(":"rgba("}${en(this.r)}, ${en(this.g)}, ${en(this.b)}${t===1?")":`, ${t})`}`}function fr(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function en(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function tn(t){return t=en(t),(t<16?"0":"")+t.toString(16)}function vi(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ke(t,e,n,r)}function bs(t){if(t instanceof ke)return new ke(t.h,t.s,t.l,t.opacity);if(t instanceof Hn||(t=rn(t)),!t)return new ke;if(t instanceof ke)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,a=Math.min(e,n,r),i=Math.max(e,n,r),s=NaN,o=i-a,c=(i+a)/2;return o?(e===i?s=(n-r)/o+(n<r)*6:n===i?s=(r-e)/o+2:s=(e-n)/o+4,o/=c<.5?i+a:2-i-a,s*=60):o=c>0&&c<1?0:s,new ke(s,o,c,t.opacity)}function _u(t,e,n,r){return arguments.length===1?bs(t):new ke(t,e,n,r??1)}function ke(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Sa(ke,_u,xs(Hn,{brighter(t){return t=t==null?cr:Math.pow(cr,t),new ke(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Bn:Math.pow(Bn,t),new ke(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,a=2*n-r;return new oe(Vr(t>=240?t-240:t+120,a,r),Vr(t,a,r),Vr(t<120?t+240:t-120,a,r),this.opacity)},clamp(){return new ke(gi(this.h),Kn(this.s),Kn(this.l),fr(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=fr(this.opacity);return`${t===1?"hsl(":"hsla("}${gi(this.h)}, ${Kn(this.s)*100}%, ${Kn(this.l)*100}%${t===1?")":`, ${t})`}`}}));function gi(t){return t=(t||0)%360,t<0?t+360:t}function Kn(t){return Math.max(0,Math.min(1,t||0))}function Vr(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function wu(t,e,n,r,a){var i=t*t,s=i*t;return((1-3*t+3*i-s)*e+(4-6*i+3*s)*n+(1+3*t+3*i-3*s)*r+s*a)/6}function ku(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),a=t[r],i=t[r+1],s=r>0?t[r-1]:2*a-i,o=r<e-1?t[r+2]:2*i-a;return wu((n-r/e)*e,s,a,i,o)}}const Ra=t=>()=>t;function Mu(t,e){return function(n){return t+n*e}}function Au(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function $u(t){return(t=+t)==1?_s:function(e,n){return n-e?Au(e,n,t):Ra(isNaN(e)?n:e)}}function _s(t,e){var n=e-t;return n?Mu(t,n):Ra(isNaN(t)?e:t)}const dr=function t(e){var n=$u(e);function r(a,i){var s=n((a=ur(a)).r,(i=ur(i)).r),o=n(a.g,i.g),c=n(a.b,i.b),u=_s(a.opacity,i.opacity);return function(d){return a.r=s(d),a.g=o(d),a.b=c(d),a.opacity=u(d),a+""}}return r.gamma=t,r}(1);function Cu(t){return function(e){var n=e.length,r=new Array(n),a=new Array(n),i=new Array(n),s,o;for(s=0;s<n;++s)o=ur(e[s]),r[s]=o.r||0,a[s]=o.g||0,i[s]=o.b||0;return r=t(r),a=t(a),i=t(i),o.opacity=1,function(c){return o.r=r(c),o.g=a(c),o.b=i(c),o+""}}}var Su=Cu(ku);function Ru(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),a;return function(i){for(a=0;a<n;++a)r[a]=t[a]*(1-i)+e[a]*i;return r}}function Tu(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Nu(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,a=new Array(r),i=new Array(n),s;for(s=0;s<r;++s)a[s]=On(t[s],e[s]);for(;s<n;++s)i[s]=e[s];return function(o){for(s=0;s<r;++s)i[s]=a[s](o);return i}}function Eu(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function we(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Iu(t,e){var n={},r={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?n[a]=On(t[a],e[a]):r[a]=e[a];return function(i){for(a in n)r[a]=n[a](i);return r}}var oa=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Yr=new RegExp(oa.source,"g");function Fu(t){return function(){return t}}function Lu(t){return function(e){return t(e)+""}}function ws(t,e){var n=oa.lastIndex=Yr.lastIndex=0,r,a,i,s=-1,o=[],c=[];for(t=t+"",e=e+"";(r=oa.exec(t))&&(a=Yr.exec(e));)(i=a.index)>n&&(i=e.slice(n,i),o[s]?o[s]+=i:o[++s]=i),(r=r[0])===(a=a[0])?o[s]?o[s]+=a:o[++s]=a:(o[++s]=null,c.push({i:s,x:we(r,a)})),n=Yr.lastIndex;return n<e.length&&(i=e.slice(n),o[s]?o[s]+=i:o[++s]=i),o.length<2?c[0]?Lu(c[0].x):Fu(e):(e=c.length,function(u){for(var d=0,f;d<e;++d)o[(f=c[d]).i]=f.x(u);return o.join("")})}function On(t,e){var n=typeof e,r;return e==null||n==="boolean"?Ra(e):(n==="number"?we:n==="string"?(r=rn(e))?(e=r,dr):ws:e instanceof rn?dr:e instanceof Date?Eu:Tu(e)?Ru:Array.isArray(e)?Nu:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Iu:we)(t,e)}function ks(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var mi=180/Math.PI,la={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ms(t,e,n,r,a,i){var s,o,c;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,c/=o),t*r<e*n&&(t=-t,e=-e,c=-c,s=-s),{translateX:a,translateY:i,rotate:Math.atan2(e,t)*mi,skewX:Math.atan(c)*mi,scaleX:s,scaleY:o}}var Zn;function Du(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?la:Ms(e.a,e.b,e.c,e.d,e.e,e.f)}function zu(t){return t==null||(Zn||(Zn=document.createElementNS("http://www.w3.org/2000/svg","g")),Zn.setAttribute("transform",t),!(t=Zn.transform.baseVal.consolidate()))?la:(t=t.matrix,Ms(t.a,t.b,t.c,t.d,t.e,t.f))}function As(t,e,n,r){function a(u){return u.length?u.pop()+" ":""}function i(u,d,f,h,m,A){if(u!==f||d!==h){var L=m.push("translate(",null,e,null,n);A.push({i:L-4,x:we(u,f)},{i:L-2,x:we(d,h)})}else(f||h)&&m.push("translate("+f+e+h+n)}function s(u,d,f,h){u!==d?(u-d>180?d+=360:d-u>180&&(u+=360),h.push({i:f.push(a(f)+"rotate(",null,r)-2,x:we(u,d)})):d&&f.push(a(f)+"rotate("+d+r)}function o(u,d,f,h){u!==d?h.push({i:f.push(a(f)+"skewX(",null,r)-2,x:we(u,d)}):d&&f.push(a(f)+"skewX("+d+r)}function c(u,d,f,h,m,A){if(u!==f||d!==h){var L=m.push(a(m)+"scale(",null,",",null,")");A.push({i:L-4,x:we(u,f)},{i:L-2,x:we(d,h)})}else(f!==1||h!==1)&&m.push(a(m)+"scale("+f+","+h+")")}return function(u,d){var f=[],h=[];return u=t(u),d=t(d),i(u.translateX,u.translateY,d.translateX,d.translateY,f,h),s(u.rotate,d.rotate,f,h),o(u.skewX,d.skewX,f,h),c(u.scaleX,u.scaleY,d.scaleX,d.scaleY,f,h),u=d=null,function(m){for(var A=-1,L=h.length,y;++A<L;)f[(y=h[A]).i]=y.x(m);return f.join("")}}}var Pu=As(Du,"px, ","px)","deg)"),Bu=As(zu,", ",")",")");function qu(t){return function(){return t}}function ju(t){return+t}var yi=[0,1];function Ue(t){return t}function ca(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:qu(isNaN(e)?NaN:.5)}function Hu(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function Ou(t,e,n){var r=t[0],a=t[1],i=e[0],s=e[1];return a<r?(r=ca(a,r),i=n(s,i)):(r=ca(r,a),i=n(i,s)),function(o){return i(r(o))}}function Uu(t,e,n){var r=Math.min(t.length,e.length)-1,a=new Array(r),i=new Array(r),s=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<r;)a[s]=ca(t[s],t[s+1]),i[s]=n(e[s],e[s+1]);return function(o){var c=hs(t,o,1,r)-1;return i[c](a[c](o))}}function Vu(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Yu(){var t=yi,e=yi,n=On,r,a,i,s=Ue,o,c,u;function d(){var h=Math.min(t.length,e.length);return s!==Ue&&(s=Hu(t[0],t[h-1])),o=h>2?Uu:Ou,c=u=null,f}function f(h){return h==null||isNaN(h=+h)?i:(c||(c=o(t.map(r),e,n)))(r(s(h)))}return f.invert=function(h){return s(a((u||(u=o(e,t.map(r),we)))(h)))},f.domain=function(h){return arguments.length?(t=Array.from(h,ju),d()):t.slice()},f.range=function(h){return arguments.length?(e=Array.from(h),d()):e.slice()},f.rangeRound=function(h){return e=Array.from(h),n=ks,d()},f.clamp=function(h){return arguments.length?(s=h?!0:Ue,d()):s!==Ue},f.interpolate=function(h){return arguments.length?(n=h,d()):n},f.unknown=function(h){return arguments.length?(i=h,f):i},function(h,m){return r=h,a=m,d()}}function Xu(){return Yu()(Ue,Ue)}function Wu(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function hr(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function xn(t){return t=hr(Math.abs(t)),t?t[1]:NaN}function Gu(t,e){return function(n,r){for(var a=n.length,i=[],s=0,o=t[0],c=0;a>0&&o>0&&(c+o+1>r&&(o=Math.max(1,r-c)),i.push(n.substring(a-=o,a+o)),!((c+=o+1)>r));)o=t[s=(s+1)%t.length];return i.reverse().join(e)}}function Qu(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Ku=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function pr(t){if(!(e=Ku.exec(t)))throw new Error("invalid format: "+t);var e;return new Ta({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}pr.prototype=Ta.prototype;function Ta(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Ta.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Zu(t){t:for(var e=t.length,n=1,r=-1,a;n<e;++n)switch(t[n]){case".":r=a=n;break;case"0":r===0&&(r=n),a=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(a+1):t}var $s;function Ju(t,e){var n=hr(t,e);if(!n)return t+"";var r=n[0],a=n[1],i=a-($s=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=r.length;return i===s?r:i>s?r+new Array(i-s+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+hr(t,Math.max(0,e+i-1))[0]}function xi(t,e){var n=hr(t,e);if(!n)return t+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}const bi={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Wu,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>xi(t*100,e),r:xi,s:Ju,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function _i(t){return t}var wi=Array.prototype.map,ki=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function tf(t){var e=t.grouping===void 0||t.thousands===void 0?_i:Gu(wi.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",i=t.numerals===void 0?_i:Qu(wi.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"−":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(f){f=pr(f);var h=f.fill,m=f.align,A=f.sign,L=f.symbol,y=f.zero,g=f.width,x=f.comma,b=f.precision,C=f.trim,$=f.type;$==="n"?(x=!0,$="g"):bi[$]||(b===void 0&&(b=12),C=!0,$="g"),(y||h==="0"&&m==="=")&&(y=!0,h="0",m="=");var N=L==="$"?n:L==="#"&&/[boxX]/.test($)?"0"+$.toLowerCase():"",M=L==="$"?r:/[%p]/.test($)?s:"",T=bi[$],S=/[defgprs%]/.test($);b=b===void 0?6:/[gprs]/.test($)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function E(w){var P=N,k=M,z,V,I;if($==="c")k=T(w)+k,w="";else{w=+w;var q=w<0||1/w<0;if(w=isNaN(w)?c:T(Math.abs(w),b),C&&(w=Zu(w)),q&&+w==0&&A!=="+"&&(q=!1),P=(q?A==="("?A:o:A==="-"||A==="("?"":A)+P,k=($==="s"?ki[8+$s/3]:"")+k+(q&&A==="("?")":""),S){for(z=-1,V=w.length;++z<V;)if(I=w.charCodeAt(z),48>I||I>57){k=(I===46?a+w.slice(z+1):w.slice(z))+k,w=w.slice(0,z);break}}}x&&!y&&(w=e(w,1/0));var it=P.length+w.length+k.length,G=it<g?new Array(g-it+1).join(h):"";switch(x&&y&&(w=e(G+w,G.length?g-k.length:1/0),G=""),m){case"<":w=P+w+k+G;break;case"=":w=P+G+w+k;break;case"^":w=G.slice(0,it=G.length>>1)+P+w+k+G.slice(it);break;default:w=G+P+w+k;break}return i(w)}return E.toString=function(){return f+""},E}function d(f,h){var m=u((f=pr(f),f.type="f",f)),A=Math.max(-8,Math.min(8,Math.floor(xn(h)/3)))*3,L=Math.pow(10,-A),y=ki[8+A/3];return function(g){return m(L*g)+y}}return{format:u,formatPrefix:d}}var Jn,ie,Cs;ef({thousands:",",grouping:[3],currency:["$",""]});function ef(t){return Jn=tf(t),ie=Jn.format,Cs=Jn.formatPrefix,Jn}function nf(t){return Math.max(0,-xn(Math.abs(t)))}function rf(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(xn(e)/3)))*3-xn(Math.abs(t)))}function af(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,xn(e)-xn(t))+1}function sf(t,e,n,r){var a=au(t,e,n),i;switch(r=pr(r??",f"),r.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(i=rf(a,s))&&(r.precision=i),Cs(r,s)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(i=af(a,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=i-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(i=nf(a))&&(r.precision=i-(r.type==="%")*2);break}}return ie(r)}function Ss(t){var e=t.domain;return t.ticks=function(n){var r=e();return gs(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var a=e();return sf(a[0],a[a.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),a=0,i=r.length-1,s=r[a],o=r[i],c,u,d=10;for(o<s&&(u=s,s=o,o=u,u=a,a=i,i=u);d-- >0;){if(u=yn(s,o,n),u===c)return r[a]=s,r[i]=o,e(r);if(u>0)s=Math.floor(s/u)*u,o=Math.ceil(o/u)*u;else if(u<0)s=Math.ceil(s*u)/u,o=Math.floor(o*u)/u;else break;c=u}return t},t}function Ye(){var t=Xu();return t.copy=function(){return Vu(t,Ye())},Ca.apply(t,arguments),Ss(t)}function of(){var t=0,e=1,n,r,a,i,s=Ue,o=!1,c;function u(f){return f==null||isNaN(f=+f)?c:s(a===0?.5:(f=(i(f)-n)*a,o?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([t,e]=f,n=i(t=+t),r=i(e=+e),a=n===r?0:1/(r-n),u):[t,e]},u.clamp=function(f){return arguments.length?(o=!!f,u):o},u.interpolator=function(f){return arguments.length?(s=f,u):s};function d(f){return function(h){var m,A;return arguments.length?([m,A]=h,s=f(m,A),u):[s(0),s(1)]}}return u.range=d(On),u.rangeRound=d(ks),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return i=f,n=f(t),r=f(e),a=n===r?0:1/(r-n),u}}function lf(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Rs(){var t=Ss(of()(Ue));return t.copy=function(){return lf(t,Rs())},cu.apply(t,arguments)}function cf(t){return t}var Xr=1,Wr=2,ua=3,Tn=4,Mi=1e-6;function uf(t){return"translate("+t+",0)"}function ff(t){return"translate(0,"+t+")"}function df(t){return e=>+t(e)}function hf(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function pf(){return!this.__axis}function Ts(t,e){var n=[],r=null,a=null,i=6,s=6,o=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,u=t===Xr||t===Tn?-1:1,d=t===Tn||t===Wr?"x":"y",f=t===Xr||t===ua?uf:ff;function h(m){var A=r??(e.ticks?e.ticks.apply(e,n):e.domain()),L=a??(e.tickFormat?e.tickFormat.apply(e,n):cf),y=Math.max(i,0)+o,g=e.range(),x=+g[0]+c,b=+g[g.length-1]+c,C=(e.bandwidth?hf:df)(e.copy(),c),$=m.selection?m.selection():m,N=$.selectAll(".domain").data([null]),M=$.selectAll(".tick").data(A,e).order(),T=M.exit(),S=M.enter().append("g").attr("class","tick"),E=M.select("line"),w=M.select("text");N=N.merge(N.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),M=M.merge(S),E=E.merge(S.append("line").attr("stroke","currentColor").attr(d+"2",u*i)),w=w.merge(S.append("text").attr("fill","currentColor").attr(d,u*y).attr("dy",t===Xr?"0em":t===ua?"0.71em":"0.32em")),m!==$&&(N=N.transition(m),M=M.transition(m),E=E.transition(m),w=w.transition(m),T=T.transition(m).attr("opacity",Mi).attr("transform",function(P){return isFinite(P=C(P))?f(P+c):this.getAttribute("transform")}),S.attr("opacity",Mi).attr("transform",function(P){var k=this.parentNode.__axis;return f((k&&isFinite(k=k(P))?k:C(P))+c)})),T.remove(),N.attr("d",t===Tn||t===Wr?s?"M"+u*s+","+x+"H"+c+"V"+b+"H"+u*s:"M"+c+","+x+"V"+b:s?"M"+x+","+u*s+"V"+c+"H"+b+"V"+u*s:"M"+x+","+c+"H"+b),M.attr("opacity",1).attr("transform",function(P){return f(C(P)+c)}),E.attr(d+"2",u*i),w.attr(d,u*y).text(L),$.filter(pf).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Wr?"start":t===Tn?"end":"middle"),$.each(function(){this.__axis=C})}return h.scale=function(m){return arguments.length?(e=m,h):e},h.ticks=function(){return n=Array.from(arguments),h},h.tickArguments=function(m){return arguments.length?(n=m==null?[]:Array.from(m),h):n.slice()},h.tickValues=function(m){return arguments.length?(r=m==null?null:Array.from(m),h):r&&r.slice()},h.tickFormat=function(m){return arguments.length?(a=m,h):a},h.tickSize=function(m){return arguments.length?(i=s=+m,h):i},h.tickSizeInner=function(m){return arguments.length?(i=+m,h):i},h.tickSizeOuter=function(m){return arguments.length?(s=+m,h):s},h.tickPadding=function(m){return arguments.length?(o=+m,h):o},h.offset=function(m){return arguments.length?(c=+m,h):c},h}function Un(t){return Ts(ua,t)}function wr(t){return Ts(Tn,t)}function fn(t){return function(){return t}}const fa=Math.PI,da=2*fa,Je=1e-6,vf=da-Je;function Ns(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function gf(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Ns;const n=10**e;return function(r){this._+=r[0];for(let a=1,i=r.length;a<i;++a)this._+=Math.round(arguments[a]*n)/n+r[a]}}class mf{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Ns:gf(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,a){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+a}`}bezierCurveTo(e,n,r,a,i,s){this._append`C${+e},${+n},${+r},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(e,n,r,a,i){if(e=+e,n=+n,r=+r,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,o=this._y1,c=r-e,u=a-n,d=s-e,f=o-n,h=d*d+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(h>Je)if(!(Math.abs(f*c-u*d)>Je)||!i)this._append`L${this._x1=e},${this._y1=n}`;else{let m=r-s,A=a-o,L=c*c+u*u,y=m*m+A*A,g=Math.sqrt(L),x=Math.sqrt(h),b=i*Math.tan((fa-Math.acos((L+h-y)/(2*g*x)))/2),C=b/x,$=b/g;Math.abs(C-1)>Je&&this._append`L${e+C*d},${n+C*f}`,this._append`A${i},${i},0,0,${+(f*m>d*A)},${this._x1=e+$*c},${this._y1=n+$*u}`}}arc(e,n,r,a,i,s){if(e=+e,n=+n,r=+r,s=!!s,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(a),c=r*Math.sin(a),u=e+o,d=n+c,f=1^s,h=s?a-i:i-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Je||Math.abs(this._y1-d)>Je)&&this._append`L${u},${d}`,r&&(h<0&&(h=h%da+da),h>vf?this._append`A${r},${r},0,1,${f},${e-o},${n-c}A${r},${r},0,1,${f},${this._x1=u},${this._y1=d}`:h>Je&&this._append`A${r},${r},0,${+(h>=fa)},${f},${this._x1=e+r*Math.cos(i)},${this._y1=n+r*Math.sin(i)}`)}rect(e,n,r,a){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+a}h${-r}Z`}toString(){return this._}}function yf(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new mf(e)}function xf(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Es(t){this._context=t}Es.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function bf(t){return new Es(t)}function _f(t){return t[0]}function wf(t){return t[1]}function kf(t,e){var n=fn(!0),r=null,a=bf,i=null,s=yf(o);t=typeof t=="function"?t:t===void 0?_f:fn(t),e=typeof e=="function"?e:e===void 0?wf:fn(e);function o(c){var u,d=(c=xf(c)).length,f,h=!1,m;for(r==null&&(i=a(m=s())),u=0;u<=d;++u)!(u<d&&n(f=c[u],u,c))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+t(f,u,c),+e(f,u,c));if(m)return i=null,m+""||null}return o.x=function(c){return arguments.length?(t=typeof c=="function"?c:fn(+c),o):t},o.y=function(c){return arguments.length?(e=typeof c=="function"?c:fn(+c),o):e},o.defined=function(c){return arguments.length?(n=typeof c=="function"?c:fn(!!c),o):n},o.curve=function(c){return arguments.length?(a=c,r!=null&&(i=a(r)),o):a},o.context=function(c){return arguments.length?(c==null?r=i=null:i=a(r=c),o):r},o}var Mf={value:()=>{}};function Na(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new nr(n)}function nr(t){this._=t}function Af(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",a=n.indexOf(".");if(a>=0&&(r=n.slice(a+1),n=n.slice(0,a)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}nr.prototype=Na.prototype={constructor:nr,on:function(t,e){var n=this._,r=Af(t+"",n),a,i=-1,s=r.length;if(arguments.length<2){for(;++i<s;)if((a=(t=r[i]).type)&&(a=$f(n[a],t.name)))return a;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++i<s;)if(a=(t=r[i]).type)n[a]=Ai(n[a],t.name,e);else if(e==null)for(a in n)n[a]=Ai(n[a],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new nr(t)},call:function(t,e){if((a=arguments.length-2)>0)for(var n=new Array(a),r=0,a,i;r<a;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=this._[t],r=0,a=i.length;r<a;++r)i[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],a=0,i=r.length;a<i;++a)r[a].value.apply(e,n)}};function $f(t,e){for(var n=0,r=t.length,a;n<r;++n)if((a=t[n]).name===e)return a.value}function Ai(t,e,n){for(var r=0,a=t.length;r<a;++r)if(t[r].name===e){t[r]=Mf,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}const ha={capture:!0,passive:!1};function pa(t){t.preventDefault(),t.stopImmediatePropagation()}function Cf(t){var e=t.document.documentElement,n=W(t).on("dragstart.drag",pa,ha);"onselectstart"in e?n.on("selectstart.drag",pa,ha):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Sf(t,e){var n=t.document.documentElement,r=W(t).on("dragstart.drag",null);e&&(r.on("click.drag",pa,ha),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var bn=0,Nn=0,Sn=0,Is=1e3,vr,En,gr=0,an=0,kr=0,jn=typeof performance=="object"&&performance.now?performance:Date,Fs=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ea(){return an||(Fs(Rf),an=jn.now()+kr)}function Rf(){an=0}function mr(){this._call=this._time=this._next=null}mr.prototype=Ls.prototype={constructor:mr,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Ea():+n)+(e==null?0:+e),!this._next&&En!==this&&(En?En._next=this:vr=this,En=this),this._call=t,this._time=n,va()},stop:function(){this._call&&(this._call=null,this._time=1/0,va())}};function Ls(t,e,n){var r=new mr;return r.restart(t,e,n),r}function Tf(){Ea(),++bn;for(var t=vr,e;t;)(e=an-t._time)>=0&&t._call.call(void 0,e),t=t._next;--bn}function $i(){an=(gr=jn.now())+kr,bn=Nn=0;try{Tf()}finally{bn=0,Ef(),an=0}}function Nf(){var t=jn.now(),e=t-gr;e>Is&&(kr-=e,gr=t)}function Ef(){for(var t,e=vr,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:vr=n);En=t,va(r)}function va(t){if(!bn){Nn&&(Nn=clearTimeout(Nn));var e=t-an;e>24?(t<1/0&&(Nn=setTimeout($i,t-jn.now()-kr)),Sn&&(Sn=clearInterval(Sn))):(Sn||(gr=jn.now(),Sn=setInterval(Nf,Is)),bn=1,Fs($i))}}function Ci(t,e,n){var r=new mr;return e=e==null?0:+e,r.restart(a=>{r.stop(),t(a+e)},e,n),r}var If=Na("start","end","cancel","interrupt"),Ff=[],Ds=0,Si=1,ga=2,rr=3,Ri=4,ma=5,ar=6;function Mr(t,e,n,r,a,i){var s=t.__transition;if(!s)t.__transition={};else if(n in s)return;Lf(t,n,{name:e,index:r,group:a,on:If,tween:Ff,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Ds})}function Ia(t,e){var n=$e(t,e);if(n.state>Ds)throw new Error("too late; already scheduled");return n}function Ie(t,e){var n=$e(t,e);if(n.state>rr)throw new Error("too late; already running");return n}function $e(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Lf(t,e,n){var r=t.__transition,a;r[e]=n,n.timer=Ls(i,0,n.time);function i(u){n.state=Si,n.timer.restart(s,n.delay,n.time),n.delay<=u&&s(u-n.delay)}function s(u){var d,f,h,m;if(n.state!==Si)return c();for(d in r)if(m=r[d],m.name===n.name){if(m.state===rr)return Ci(s);m.state===Ri?(m.state=ar,m.timer.stop(),m.on.call("interrupt",t,t.__data__,m.index,m.group),delete r[d]):+d<e&&(m.state=ar,m.timer.stop(),m.on.call("cancel",t,t.__data__,m.index,m.group),delete r[d])}if(Ci(function(){n.state===rr&&(n.state=Ri,n.timer.restart(o,n.delay,n.time),o(u))}),n.state=ga,n.on.call("start",t,t.__data__,n.index,n.group),n.state===ga){for(n.state=rr,a=new Array(h=n.tween.length),d=0,f=-1;d<h;++d)(m=n.tween[d].value.call(t,t.__data__,n.index,n.group))&&(a[++f]=m);a.length=f+1}}function o(u){for(var d=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=ma,1),f=-1,h=a.length;++f<h;)a[f].call(t,d);n.state===ma&&(n.on.call("end",t,t.__data__,n.index,n.group),c())}function c(){n.state=ar,n.timer.stop(),delete r[e];for(var u in r)return;delete t.__transition}}function ya(t,e){var n=t.__transition,r,a,i=!0,s;if(n){e=e==null?null:e+"";for(s in n){if((r=n[s]).name!==e){i=!1;continue}a=r.state>ga&&r.state<ma,r.state=ar,r.timer.stop(),r.on.call(a?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[s]}i&&delete t.__transition}}function Df(t){return this.each(function(){ya(this,t)})}function zf(t,e){var n,r;return function(){var a=Ie(this,t),i=a.tween;if(i!==n){r=n=i;for(var s=0,o=r.length;s<o;++s)if(r[s].name===e){r=r.slice(),r.splice(s,1);break}}a.tween=r}}function Pf(t,e,n){var r,a;if(typeof n!="function")throw new Error;return function(){var i=Ie(this,t),s=i.tween;if(s!==r){a=(r=s).slice();for(var o={name:e,value:n},c=0,u=a.length;c<u;++c)if(a[c].name===e){a[c]=o;break}c===u&&a.push(o)}i.tween=a}}function Bf(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=$e(this.node(),n).tween,a=0,i=r.length,s;a<i;++a)if((s=r[a]).name===t)return s.value;return null}return this.each((e==null?zf:Pf)(n,t,e))}function Fa(t,e,n){var r=t._id;return t.each(function(){var a=Ie(this,r);(a.value||(a.value={}))[e]=n.apply(this,arguments)}),function(a){return $e(a,r).value[e]}}function zs(t,e){var n;return(typeof e=="number"?we:e instanceof rn?dr:(n=rn(e))?(e=n,dr):ws)(t,e)}function qf(t){return function(){this.removeAttribute(t)}}function jf(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Hf(t,e,n){var r,a=n+"",i;return function(){var s=this.getAttribute(t);return s===a?null:s===r?i:i=e(r=s,n)}}function Of(t,e,n){var r,a=n+"",i;return function(){var s=this.getAttributeNS(t.space,t.local);return s===a?null:s===r?i:i=e(r=s,n)}}function Uf(t,e,n){var r,a,i;return function(){var s,o=n(this),c;return o==null?void this.removeAttribute(t):(s=this.getAttribute(t),c=o+"",s===c?null:s===r&&c===a?i:(a=c,i=e(r=s,o)))}}function Vf(t,e,n){var r,a,i;return function(){var s,o=n(this),c;return o==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),c=o+"",s===c?null:s===r&&c===a?i:(a=c,i=e(r=s,o)))}}function Yf(t,e){var n=xr(t),r=n==="transform"?Bu:zs;return this.attrTween(t,typeof e=="function"?(n.local?Vf:Uf)(n,r,Fa(this,"attr."+t,e)):e==null?(n.local?jf:qf)(n):(n.local?Of:Hf)(n,r,e))}function Xf(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Wf(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Gf(t,e){var n,r;function a(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&Wf(t,i)),n}return a._value=e,a}function Qf(t,e){var n,r;function a(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&Xf(t,i)),n}return a._value=e,a}function Kf(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=xr(t);return this.tween(n,(r.local?Gf:Qf)(r,e))}function Zf(t,e){return function(){Ia(this,t).delay=+e.apply(this,arguments)}}function Jf(t,e){return e=+e,function(){Ia(this,t).delay=e}}function td(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Zf:Jf)(e,t)):$e(this.node(),e).delay}function ed(t,e){return function(){Ie(this,t).duration=+e.apply(this,arguments)}}function nd(t,e){return e=+e,function(){Ie(this,t).duration=e}}function rd(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?ed:nd)(e,t)):$e(this.node(),e).duration}function ad(t,e){if(typeof e!="function")throw new Error;return function(){Ie(this,t).ease=e}}function id(t){var e=this._id;return arguments.length?this.each(ad(e,t)):$e(this.node(),e).ease}function sd(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Ie(this,t).ease=n}}function od(t){if(typeof t!="function")throw new Error;return this.each(sd(this._id,t))}function ld(t){typeof t!="function"&&(t=es(t));for(var e=this._groups,n=e.length,r=new Array(n),a=0;a<n;++a)for(var i=e[a],s=i.length,o=r[a]=[],c,u=0;u<s;++u)(c=i[u])&&t.call(c,c.__data__,u,i)&&o.push(c);return new qe(r,this._parents,this._name,this._id)}function cd(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,a=n.length,i=Math.min(r,a),s=new Array(r),o=0;o<i;++o)for(var c=e[o],u=n[o],d=c.length,f=s[o]=new Array(d),h,m=0;m<d;++m)(h=c[m]||u[m])&&(f[m]=h);for(;o<r;++o)s[o]=e[o];return new qe(s,this._parents,this._name,this._id)}function ud(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function fd(t,e,n){var r,a,i=ud(e)?Ia:Ie;return function(){var s=i(this,t),o=s.on;o!==r&&(a=(r=o).copy()).on(e,n),s.on=a}}function dd(t,e){var n=this._id;return arguments.length<2?$e(this.node(),n).on.on(t):this.each(fd(n,t,e))}function hd(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function pd(){return this.on("end.remove",hd(this._id))}function vd(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Aa(t));for(var r=this._groups,a=r.length,i=new Array(a),s=0;s<a;++s)for(var o=r[s],c=o.length,u=i[s]=new Array(c),d,f,h=0;h<c;++h)(d=o[h])&&(f=t.call(d,d.__data__,h,o))&&("__data__"in d&&(f.__data__=d.__data__),u[h]=f,Mr(u[h],e,n,h,u,$e(d,n)));return new qe(i,this._parents,e,n)}function gd(t){var e=this._name,n=this._id;typeof t!="function"&&(t=ts(t));for(var r=this._groups,a=r.length,i=[],s=[],o=0;o<a;++o)for(var c=r[o],u=c.length,d,f=0;f<u;++f)if(d=c[f]){for(var h=t.call(d,d.__data__,f,c),m,A=$e(d,n),L=0,y=h.length;L<y;++L)(m=h[L])&&Mr(m,e,n,L,h,A);i.push(h),s.push(d)}return new qe(i,s,e,n)}var md=_n.prototype.constructor;function yd(){return new md(this._groups,this._parents)}function xd(t,e){var n,r,a;return function(){var i=mn(this,t),s=(this.style.removeProperty(t),mn(this,t));return i===s?null:i===n&&s===r?a:a=e(n=i,r=s)}}function Ps(t){return function(){this.style.removeProperty(t)}}function bd(t,e,n){var r,a=n+"",i;return function(){var s=mn(this,t);return s===a?null:s===r?i:i=e(r=s,n)}}function _d(t,e,n){var r,a,i;return function(){var s=mn(this,t),o=n(this),c=o+"";return o==null&&(c=o=(this.style.removeProperty(t),mn(this,t))),s===c?null:s===r&&c===a?i:(a=c,i=e(r=s,o))}}function wd(t,e){var n,r,a,i="style."+e,s="end."+i,o;return function(){var c=Ie(this,t),u=c.on,d=c.value[i]==null?o||(o=Ps(e)):void 0;(u!==n||a!==d)&&(r=(n=u).copy()).on(s,a=d),c.on=r}}function kd(t,e,n){var r=(t+="")=="transform"?Pu:zs;return e==null?this.styleTween(t,xd(t,r)).on("end.style."+t,Ps(t)):typeof e=="function"?this.styleTween(t,_d(t,r,Fa(this,"style."+t,e))).each(wd(this._id,t)):this.styleTween(t,bd(t,r,e),n).on("end.style."+t,null)}function Md(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Ad(t,e,n){var r,a;function i(){var s=e.apply(this,arguments);return s!==a&&(r=(a=s)&&Md(t,s,n)),r}return i._value=e,i}function $d(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Ad(t,e,n??""))}function Cd(t){return function(){this.textContent=t}}function Sd(t){return function(){var e=t(this);this.textContent=e??""}}function Rd(t){return this.tween("text",typeof t=="function"?Sd(Fa(this,"text",t)):Cd(t==null?"":t+""))}function Td(t){return function(e){this.textContent=t.call(this,e)}}function Nd(t){var e,n;function r(){var a=t.apply(this,arguments);return a!==n&&(e=(n=a)&&Td(a)),e}return r._value=t,r}function Ed(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Nd(t))}function Id(){for(var t=this._name,e=this._id,n=Bs(),r=this._groups,a=r.length,i=0;i<a;++i)for(var s=r[i],o=s.length,c,u=0;u<o;++u)if(c=s[u]){var d=$e(c,e);Mr(c,t,n,u,s,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new qe(r,this._parents,t,n)}function Fd(){var t,e,n=this,r=n._id,a=n.size();return new Promise(function(i,s){var o={value:s},c={value:function(){--a===0&&i()}};n.each(function(){var u=Ie(this,r),d=u.on;d!==t&&(e=(t=d).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(c)),u.on=e}),a===0&&i()})}var Ld=0;function qe(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function xa(t){return _n().transition(t)}function Bs(){return++Ld}var Pe=_n.prototype;qe.prototype=xa.prototype={constructor:qe,select:vd,selectAll:gd,selectChild:Pe.selectChild,selectChildren:Pe.selectChildren,filter:ld,merge:cd,selection:yd,transition:Id,call:Pe.call,nodes:Pe.nodes,node:Pe.node,size:Pe.size,empty:Pe.empty,each:Pe.each,on:dd,attr:Yf,attrTween:Kf,style:kd,styleTween:$d,text:Rd,textTween:Ed,remove:pd,tween:Bf,delay:td,duration:rd,ease:id,easeVarying:od,end:Fd,[Symbol.iterator]:Pe[Symbol.iterator]};function Dd(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var zd={time:null,delay:0,duration:250,ease:Dd};function Pd(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Bd(t){var e,n;t instanceof qe?(e=t._id,t=t._name):(e=Bs(),(n=zd).time=Ea(),t=t==null?null:t+"");for(var r=this._groups,a=r.length,i=0;i<a;++i)for(var s=r[i],o=s.length,c,u=0;u<o;++u)(c=s[u])&&Mr(c,t,e,u,s,n||Pd(c,e));return new qe(r,this._parents,t,e)}_n.prototype.interrupt=Df;_n.prototype.transition=Bd;const Gr=t=>()=>t;function qd(t,{sourceEvent:e,target:n,selection:r,mode:a,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:r,enumerable:!0,configurable:!0},mode:{value:a,enumerable:!0,configurable:!0},_:{value:i}})}function jd(t){t.stopImmediatePropagation()}function Qr(t){t.preventDefault(),t.stopImmediatePropagation()}var Ti={name:"drag"},Kr={name:"space"},dn={name:"handle"},hn={name:"center"};const{abs:Ni,max:Gt,min:Qt}=Math;function Ei(t){return[+t[0],+t[1]]}function Ii(t){return[Ei(t[0]),Ei(t[1])]}var ir={name:"x",handles:["w","e"].map(ba),input:function(t,e){return t==null?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Zr={},Be={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Fi={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Li={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},Hd={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},Od={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function ba(t){return{type:t}}function Ud(t){return!t.ctrlKey&&!t.button}function Vd(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function Yd(){return navigator.maxTouchPoints||"ontouchstart"in this}function Jr(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function Xd(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function Wd(){return Gd(ir)}function Gd(t){var e=Vd,n=Ud,r=Yd,a=!0,i=Na("start","brush","end"),s=6,o;function c(y){var g=y.property("__brush",L).selectAll(".overlay").data([ba("overlay")]);g.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Be.overlay).merge(g).each(function(){var b=Jr(this).extent;W(this).attr("x",b[0][0]).attr("y",b[0][1]).attr("width",b[1][0]-b[0][0]).attr("height",b[1][1]-b[0][1])}),y.selectAll(".selection").data([ba("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Be.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var x=y.selectAll(".handle").data(t.handles,function(b){return b.type});x.exit().remove(),x.enter().append("rect").attr("class",function(b){return"handle handle--"+b.type}).attr("cursor",function(b){return Be[b.type]}),y.each(u).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",h).filter(r).on("touchstart.brush",h).on("touchmove.brush",m).on("touchend.brush touchcancel.brush",A).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}c.move=function(y,g,x){y.tween?y.on("start.brush",function(b){d(this,arguments).beforestart().start(b)}).on("interrupt.brush end.brush",function(b){d(this,arguments).end(b)}).tween("brush",function(){var b=this,C=b.__brush,$=d(b,arguments),N=C.selection,M=t.input(typeof g=="function"?g.apply(this,arguments):g,C.extent),T=On(N,M);function S(E){C.selection=E===1&&M===null?null:T(E),u.call(b),$.brush()}return N!==null&&M!==null?S:S(1)}):y.each(function(){var b=this,C=arguments,$=b.__brush,N=t.input(typeof g=="function"?g.apply(b,C):g,$.extent),M=d(b,C).beforestart();ya(b),$.selection=N===null?null:N,u.call(b),M.start(x).brush(x).end(x)})},c.clear=function(y,g){c.move(y,null,g)};function u(){var y=W(this),g=Jr(this).selection;g?(y.selectAll(".selection").style("display",null).attr("x",g[0][0]).attr("y",g[0][1]).attr("width",g[1][0]-g[0][0]).attr("height",g[1][1]-g[0][1]),y.selectAll(".handle").style("display",null).attr("x",function(x){return x.type[x.type.length-1]==="e"?g[1][0]-s/2:g[0][0]-s/2}).attr("y",function(x){return x.type[0]==="s"?g[1][1]-s/2:g[0][1]-s/2}).attr("width",function(x){return x.type==="n"||x.type==="s"?g[1][0]-g[0][0]+s:s}).attr("height",function(x){return x.type==="e"||x.type==="w"?g[1][1]-g[0][1]+s:s})):y.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function d(y,g,x){var b=y.__brush.emitter;return b&&(!x||!b.clean)?b:new f(y,g,x)}function f(y,g,x){this.that=y,this.args=g,this.state=y.__brush,this.active=0,this.clean=x}f.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(y,g){return this.starting?(this.starting=!1,this.emit("start",y,g)):this.emit("brush",y),this},brush:function(y,g){return this.emit("brush",y,g),this},end:function(y,g){return--this.active===0&&(delete this.state.emitter,this.emit("end",y,g)),this},emit:function(y,g,x){var b=W(this.that).datum();i.call(y,this.that,new qd(y,{sourceEvent:g,target:c,selection:t.output(this.state.selection),mode:x,dispatch:i}),b)}};function h(y){if(o&&!y.touches||!n.apply(this,arguments))return;var g=this,x=y.target.__data__.type,b=(a&&y.metaKey?x="overlay":x)==="selection"?Ti:a&&y.altKey?hn:dn,C=t===Zr?null:Hd[x],$=t===ir?null:Od[x],N=Jr(g),M=N.extent,T=N.selection,S=M[0][0],E,w,P=M[0][1],k,z,V=M[1][0],I,q,it=M[1][1],G,pt,B=0,U=0,j,st=C&&$&&a&&y.shiftKey,ct,yt,R=Array.from(y.touches||[y],O=>{const ft=O.identifier;return O=aa(O,g),O.point0=O.slice(),O.identifier=ft,O});ya(g);var Q=d(g,arguments,!0).beforestart();if(x==="overlay"){T&&(j=!0);const O=[R[0],R[1]||R[0]];N.selection=T=[[E=t===Zr?S:Qt(O[0][0],O[1][0]),k=t===ir?P:Qt(O[0][1],O[1][1])],[I=t===Zr?V:Gt(O[0][0],O[1][0]),G=t===ir?it:Gt(O[0][1],O[1][1])]],R.length>1&&dt(y)}else E=T[0][0],k=T[0][1],I=T[1][0],G=T[1][1];w=E,z=k,q=I,pt=G;var kt=W(g).attr("pointer-events","none"),at=kt.selectAll(".overlay").attr("cursor",Be[x]);if(y.touches)Q.moved=lt,Q.ended=tt;else{var J=W(y.view).on("mousemove.brush",lt,!0).on("mouseup.brush",tt,!0);a&&J.on("keydown.brush",Nt,!0).on("keyup.brush",ht,!0),Cf(y.view)}u.call(g),Q.start(y,b.name);function lt(O){for(const ft of O.changedTouches||[O])for(const Dt of R)Dt.identifier===ft.identifier&&(Dt.cur=aa(ft,g));if(st&&!ct&&!yt&&R.length===1){const ft=R[0];Ni(ft.cur[0]-ft[0])>Ni(ft.cur[1]-ft[1])?yt=!0:ct=!0}for(const ft of R)ft.cur&&(ft[0]=ft.cur[0],ft[1]=ft.cur[1]);j=!0,Qr(O),dt(O)}function dt(O){const ft=R[0],Dt=ft.point0;var Ft;switch(B=ft[0]-Dt[0],U=ft[1]-Dt[1],b){case Kr:case Ti:{C&&(B=Gt(S-E,Qt(V-I,B)),w=E+B,q=I+B),$&&(U=Gt(P-k,Qt(it-G,U)),z=k+U,pt=G+U);break}case dn:{R[1]?(C&&(w=Gt(S,Qt(V,R[0][0])),q=Gt(S,Qt(V,R[1][0])),C=1),$&&(z=Gt(P,Qt(it,R[0][1])),pt=Gt(P,Qt(it,R[1][1])),$=1)):(C<0?(B=Gt(S-E,Qt(V-E,B)),w=E+B,q=I):C>0&&(B=Gt(S-I,Qt(V-I,B)),w=E,q=I+B),$<0?(U=Gt(P-k,Qt(it-k,U)),z=k+U,pt=G):$>0&&(U=Gt(P-G,Qt(it-G,U)),z=k,pt=G+U));break}case hn:{C&&(w=Gt(S,Qt(V,E-B*C)),q=Gt(S,Qt(V,I+B*C))),$&&(z=Gt(P,Qt(it,k-U*$)),pt=Gt(P,Qt(it,G+U*$)));break}}q<w&&(C*=-1,Ft=E,E=I,I=Ft,Ft=w,w=q,q=Ft,x in Fi&&at.attr("cursor",Be[x=Fi[x]])),pt<z&&($*=-1,Ft=k,k=G,G=Ft,Ft=z,z=pt,pt=Ft,x in Li&&at.attr("cursor",Be[x=Li[x]])),N.selection&&(T=N.selection),ct&&(w=T[0][0],q=T[1][0]),yt&&(z=T[0][1],pt=T[1][1]),(T[0][0]!==w||T[0][1]!==z||T[1][0]!==q||T[1][1]!==pt)&&(N.selection=[[w,z],[q,pt]],u.call(g),Q.brush(O,b.name))}function tt(O){if(jd(O),O.touches){if(O.touches.length)return;o&&clearTimeout(o),o=setTimeout(function(){o=null},500)}else Sf(O.view,j),J.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);kt.attr("pointer-events","all"),at.attr("cursor",Be.overlay),N.selection&&(T=N.selection),Xd(T)&&(N.selection=null,u.call(g)),Q.end(O,b.name)}function Nt(O){switch(O.keyCode){case 16:{st=C&&$;break}case 18:{b===dn&&(C&&(I=q-B*C,E=w+B*C),$&&(G=pt-U*$,k=z+U*$),b=hn,dt(O));break}case 32:{(b===dn||b===hn)&&(C<0?I=q-B:C>0&&(E=w-B),$<0?G=pt-U:$>0&&(k=z-U),b=Kr,at.attr("cursor",Be.selection),dt(O));break}default:return}Qr(O)}function ht(O){switch(O.keyCode){case 16:{st&&(ct=yt=st=!1,dt(O));break}case 18:{b===hn&&(C<0?I=q:C>0&&(E=w),$<0?G=pt:$>0&&(k=z),b=dn,dt(O));break}case 32:{b===Kr&&(O.altKey?(C&&(I=q-B*C,E=w+B*C),$&&(G=pt-U*$,k=z+U*$),b=hn):(C<0?I=q:C>0&&(E=w),$<0?G=pt:$>0&&(k=z),b=dn),at.attr("cursor",Be[x]),dt(O));break}default:return}Qr(O)}}function m(y){d(this,arguments).moved(y)}function A(y){d(this,arguments).ended(y)}function L(){var y=this.__brush||{selection:null};return y.extent=Ii(e.apply(this,arguments)),y.dim=t,y}return c.extent=function(y){return arguments.length?(e=typeof y=="function"?y:Gr(Ii(y)),c):e},c.filter=function(y){return arguments.length?(n=typeof y=="function"?y:Gr(!!y),c):n},c.touchable=function(y){return arguments.length?(r=typeof y=="function"?y:Gr(!!y),c):r},c.handleSize=function(y){return arguments.length?(s=+y,c):s},c.keyModifiers=function(y){return arguments.length?(a=!!y,c):a},c.on=function(){var y=i.on.apply(i,arguments);return y===i?c:y},c}var Qd=K('<div class="age-range-indicator svelte-s2n15r"><span class="svelte-s2n15r"> </span> <button class="clear-btn svelte-s2n15r">Clear filter</button></div>'),Kd=K('<div class="age-distribution svelte-s2n15r"><div class="chart svelte-s2n15r"><svg class="h-auto w-full"></svg></div> <!></div>');function Zd(t,e){Me(e,!1);const n=H(),r=H();let a=te(e,"data",24,()=>[]),i=te(e,"showPercentage",8,!1),s=te(e,"showBySex",8,!0),o=H(),c=H([null,null]);const u=zi();function d(g){const x=[...g].sort((M,T)=>M-T),b=er(x)||0,C=Pn(x,.25)||0,$=Pn(x,.75)||0,N=$-C;return{median:b,q1:C,q3:$,iqr:N}}function f(){if(!a().length)return;W(l(o)).selectAll("*").remove();const g={top:30,right:30,bottom:60,left:60},x=600-g.left-g.right,b=350-g.top-g.bottom,C=l(n).filter(R=>R.age!==void 0&&!isNaN(R.age)),$=C.map(R=>R.age),N=d($),M=a().filter(R=>R.age!==void 0&&!isNaN(R.age)).map(R=>R.age),T=Ye().domain(tr(M)).nice().range([0,x]),S=ou().domain(T.domain()).thresholds(T.ticks(20));let E,w;const P=S($),k=C.length,z=R=>i()?R.length/k*100:R.length,V=Te(P,R=>z(R))||0,I=C.filter(R=>R.sex==="M").map(R=>R.age),q=C.filter(R=>R.sex==="F").map(R=>R.age),it=S(I),G=S(q),pt=Math.max(Te(it,R=>z(R))||0,Te(G,R=>z(R))||0),B=Math.max(V,pt);s()?E={male:it,female:G}:E=P,w=B;const U=Ye().domain([0,w*1.1]).range([b,0]);W("body").selectAll(".age-tooltip").data([0]).enter().append("div").attr("class","age-tooltip").style("opacity",0).style("position","absolute").style("background-color","white").style("border","1px solid #ddd").style("border-radius","3px").style("padding","8px").style("pointer-events","none").style("font-size","12px").style("box-shadow","0 2px 5px rgba(0,0,0,0.2)").style("text-align","center").style("z-index","10");const j=W(l(o)).attr("viewBox",`0 0 ${x+g.left+g.right} ${b+g.top+g.bottom}`).append("g").attr("transform",`translate(${g.left},${g.top})`);if(s()){const R=br().domain(["Male","Female"]).range(["#4682b4","#db7093"]),Q=E,kt=xa().duration(500),at=j.append("g").selectAll(".bar-male").data(Q.male).enter().append("rect").attr("class","bar-male").attr("x",tt=>T(tt.x0)).attr("width",tt=>Math.max(0,T(tt.x1)-T(tt.x0)-1)).attr("y",b).attr("height",0).attr("fill",R("Male")).attr("opacity",.7).attr("stroke",R("Male")).attr("stroke-width",1);at.transition(kt).attr("y",tt=>U(z(tt))).attr("height",tt=>b-U(z(tt)));const J=W("body").select(".age-tooltip");at.on("mouseover",function(tt,Nt){const ht=Nt.length,O=(ht/I.length*100).toFixed(1),ft=`${Nt.x0}-${Nt.x1}`;J.transition().duration(200).style("opacity",.9),J.html(`
                            <strong>Age: ${ft}</strong><br/>
                            <strong>Male</strong><br/>
                            Count: ${ht}<br/>
                            Percentage: ${O}%
                        `).style("left",tt.pageX+10+"px").style("top",tt.pageY-28+"px"),W(this).attr("stroke","black").attr("stroke-width",2)}).on("mouseout",function(){J.transition().duration(500).style("opacity",0),W(this).attr("stroke",R("Male")).attr("stroke-width",1)});const lt=j.append("g").selectAll(".bar-female").data(Q.female).enter().append("rect").attr("class","bar-female").attr("x",tt=>T(tt.x0)).attr("width",tt=>Math.max(0,T(tt.x1)-T(tt.x0)-1)).attr("y",b).attr("height",0).attr("fill",R("Female")).attr("opacity",.7).attr("stroke",R("Female")).attr("stroke-width",1);lt.transition(kt).attr("y",tt=>U(z(tt))).attr("height",tt=>b-U(z(tt))),lt.on("mouseover",function(tt,Nt){const ht=Nt.length,O=(ht/q.length*100).toFixed(1),ft=`${Nt.x0}-${Nt.x1}`;J.transition().duration(200).style("opacity",.9),J.html(`
                            <strong>Age: ${ft}</strong><br/>
                            <strong>Female</strong><br/>
                            Count: ${ht}<br/>
                            Percentage: ${O}%
                        `).style("left",tt.pageX+10+"px").style("top",tt.pageY-28+"px"),W(this).attr("stroke","black").attr("stroke-width",2)}).on("mouseout",function(){J.transition().duration(500).style("opacity",0),W(this).attr("stroke",R("Female")).attr("stroke-width",1)});const dt=j.append("g").attr("class","legend").attr("transform",`translate(${x-100}, 10)`);["Male","Female"].forEach((tt,Nt)=>{dt.append("rect").attr("x",0).attr("y",Nt*20).attr("width",15).attr("height",15).attr("fill",R(tt)),dt.append("text").attr("x",20).attr("y",Nt*20+12).text(tt).style("font-size","12px")})}else{const R=xa().duration(500),Q=j.append("g").selectAll("rect").data(E).enter().append("rect").attr("x",at=>T(at.x0)).attr("width",at=>Math.max(0,T(at.x1)-T(at.x0)-1)).attr("y",b).attr("height",0).attr("fill","steelblue").attr("stroke","white").attr("stroke-width",.5);Q.transition(R).attr("y",at=>U(z(at))).attr("height",at=>b-U(z(at)));const kt=W("body").select(".age-tooltip");Q.on("mouseover",function(at,J){const lt=J.length,dt=(lt/k*100).toFixed(1),tt=`${J.x0}-${J.x1}`;kt.transition().duration(200).style("opacity",.9),kt.html(`
                        <strong>Age: ${tt}</strong><br/>
                        Count: ${lt}<br/>
                        Percentage: ${dt}%
                    `).style("left",at.pageX+10+"px").style("top",at.pageY-28+"px"),W(this).attr("stroke","black").attr("stroke-width",2)}).on("mouseout",function(){kt.transition().duration(500).style("opacity",0),W(this).attr("stroke","white").attr("stroke-width",.5)})}j.append("g").attr("transform",`translate(0,${b})`).call(Un(T).tickFormat(R=>`${R}`)).style("font-size","12px"),j.append("g").call(wr(U)).style("font-size","12px"),j.append("text").attr("x",x/2).attr("y",b+40).attr("text-anchor","middle").text("Age (years)").style("font-size","14px").attr("class","fill-text-primary"),j.append("text").attr("transform","rotate(-90)").attr("x",-260/2).attr("y",-35).attr("text-anchor","middle").text(i()?"Percentage of Cases (%)":"Number of Cases").style("font-size","14px").attr("class","fill-text-primary"),j.append("text").attr("x",x/2).attr("y",-10).attr("text-anchor","middle").style("font-size","16px").style("font-weight","bold").text("Age Distribution of Surgical Cases").attr("class","fill-text-primary");const st=T(N.median);j.append("line").attr("x1",st).attr("x2",st).attr("y1",b).attr("y2",10).attr("stroke","red").attr("stroke-width",2).attr("stroke-dasharray","5,5"),j.append("rect").attr("x",T(N.q1)).attr("width",T(N.q3)-T(N.q1)).attr("y",b+5).attr("height",10).attr("fill","rgba(255,0,0,0.3)"),j.append("text").attr("x",st).attr("y",5).attr("text-anchor","middle").style("font-size","12px").style("font-weight","bold").text(`Median: ${ie(".1f")(N.median)}`).attr("class","fill-text-primary"),j.append("text").attr("x",(T(N.q1)+T(N.q3))/2).attr("y",b+25).attr("text-anchor","middle").style("font-size","12px").text(`IQR: ${ie(".1f")(N.q1)} - ${ie(".1f")(N.q3)}`).attr("class","fill-text-primary"),N.median>60&&j.append("text").attr("x",x*.75).attr("y",b*.25).attr("text-anchor","middle").style("font-size","13px").style("font-style","italic").style("fill","#555").text("Aging patient population"),W("body").selectAll(".age-brush-tooltip").data([0]).enter().append("div").attr("class","age-brush-tooltip").style("opacity",0).style("position","fixed").style("background-color","rgba(70, 130, 180, 0.9)").style("color","white").style("border-radius","4px").style("padding","6px 12px").style("pointer-events","none").style("font-size","13px").style("font-weight","bold").style("text-align","center").style("z-index","20").style("transform","translateX(-50%)").style("box-shadow","0 2px 5px rgba(0,0,0,0.3)").style("border","1px solid rgba(255,255,255,0.2)");const ct=Wd().extent([[0,0],[x,b]]).on("start brush",R=>{if(R.selection){const[Q,kt]=R.selection.map(Nt=>Math.round(T.invert(Nt))),at=W("body").select(".age-brush-tooltip"),J=l(o).getBoundingClientRect(),lt=`Selecting Ages: ${Q} - ${kt} years`,dt=J.left+J.width/2,tt=J.bottom-20;at.html(lt).style("left",dt+"px").style("top",tt+"px").style("opacity",1)}}).on("end",R=>{if(setTimeout(()=>{W("body").select(".age-brush-tooltip").style("opacity",0)},500),!R.selection){l(c)[0]!==null&&(F(c,[null,null]),setTimeout(()=>f(),0));return}const[Q,kt]=R.selection.map(J=>T.invert(J)),at=[Math.round(Q),Math.round(kt)];(l(c)[0]!==at[0]||l(c)[1]!==at[1])&&(F(c,at),setTimeout(()=>f(),0))}),yt=j.append("g").attr("class","brush").call(ct);l(c)[0]!==null&&l(c)[1]!==null&&yt.call(ct.move,[T(l(c)[0]),T(l(c)[1])])}Ee(()=>(f(),()=>{W("body").selectAll(".age-tooltip").remove()})),Pi(f),Ee(()=>()=>{W("body").selectAll(".age-tooltip").remove(),W("body").selectAll(".age-brush-tooltip").remove()}),ot(()=>(l(c),Rt(a())),()=>{F(n,l(c)[0]!==null&&l(c)[1]!==null?a().filter(g=>g.age!==void 0&&g.age>=l(c)[0]&&g.age<=l(c)[1]):a())}),ot(()=>(l(n),er),()=>{F(r,l(n).length&&er(l(n).filter(g=>g.age!==void 0&&!isNaN(g.age)).map(g=>g.age))||0)}),ot(()=>(l(c),l(n),Rt(a())),()=>{l(c)[0]!==null?u("filter",{ageRange:l(c),data:l(n)}):l(n)===a()&&l(c)[0]===null&&u("filter",{ageRange:null,data:a()})}),ot(()=>(Rt(i()),Rt(s()),l(o),W),()=>{(i()!==void 0||s()!==void 0)&&l(o)&&(W("body").select(".age-tooltip").style("opacity",0),f())}),We(),Xe();var h=Kd(),m=v(h),A=v(m);nn(A,g=>F(o,g),()=>l(o)),p(m);var L=_(m,2);{var y=g=>{var x=Qd(),b=v(x),C=v(b);p(b);var $=_(b,2);p(x),Tt(()=>Y(C,`Age range: ${l(c)[0]??""}–${l(c)[1]??""}`)),Ve("click",$,()=>{W("body").select(".age-tooltip").style("opacity",0),F(c,[null,null]),setTimeout(()=>f(),0)}),X(g,x)};Et(L,g=>{l(c)[0]!==null&&g(y)})}p(h),X(t,h),Ae()}var Jd=K('<div class="filter-notice svelte-1xqgfk8"><span class="filter-badge svelte-1xqgfk8">Filtered</span> <span class="text-black svelte-1xqgfk8">Viewing <strong> </strong> cases only</span> <button class="clear-filter text-black svelte-1xqgfk8">Clear filter ×</button></div>'),th=K('<div class="department-distribution svelte-1xqgfk8"><div class="chart svelte-1xqgfk8"><svg class="h-auto w-full"></svg></div> <!></div>');function eh(t,e){Me(e,!1);let n=te(e,"data",24,()=>[]),r=te(e,"filteredDepartment",12,null),a=te(e,"showPercentage",8,!1),i=H(),s="Department Distribution of Surgical Cases";const o=zi();function c(){if(!n().length)return;W(l(i)).selectAll("*").remove();const y={top:30,right:30,bottom:90,left:60},g=600-y.left-y.right,x=350-y.top-y.bottom,b=Qc(n(),k=>k.length,k=>k.department),C=Array.from(b,([k,z])=>({key:k,value:z})).sort((k,z)=>fs(k.value,z.value)),$=lu(C,k=>k.value),N=C.map(k=>({...k,percent:k.value/$*100})),M=N.slice(0,2);M.reduce((k,z)=>k+z.percent,0);const T=_r().domain(C.map(k=>k.key)).range([0,g]).padding(.2),S=Ye().domain([0,a()?Te(N,k=>k.percent):Te(C,k=>k.value)]).nice().range([x,0]),E=W(l(i)).attr("viewBox",`0 0 ${g+y.left+y.right} ${x+y.top+y.bottom}`).append("g").attr("transform",`translate(${y.left},${y.top})`);E.append("text").attr("x",g/2).attr("y",-15).attr("text-anchor","middle").attr("class","chart-title").style("font-size","16px").style("font-weight","bold").text(s).attr("class","fill-text-primary");const w=new Map;C.forEach(k=>{const z=n().filter(j=>j.department===k.key),V=z.filter(j=>j.sex==="M").length,I=z.filter(j=>j.sex==="F").length,q=V/k.value*100,it=I/k.value*100,G=z.filter(j=>j.age!==void 0&&!isNaN(j.age)).map(j=>j.age),pt=G.length&&er(G)||0,B=G.length&&Pn(G,.25)||0,U=G.length&&Pn(G,.75)||0;w.set(k.key,{maleCount:V,femaleCount:I,malePercent:q,femalePercent:it,medianAge:pt,q1:B,q3:U})});const P=W("body").selectAll(".dept-tooltip").data([0]).enter().append("div").attr("class","dept-tooltip").style("position","absolute").style("visibility","hidden").style("background-color","white").style("border","1px solid #ddd").style("border-radius","5px").style("padding","10px").style("box-shadow","0 2px 5px rgba(0,0,0,0.2)").style("pointer-events","none").style("font-size","12px").style("z-index","10");E.append("g").selectAll("rect").data(N).enter().append("rect").attr("x",k=>T(k.key)).attr("y",k=>a()?S(k.percent):S(k.value)).attr("width",T.bandwidth()).attr("height",k=>a()?x-S(k.percent):x-S(k.value)).attr("fill",k=>r()===k.key?"#ff7f50":M.includes(k)?"#2a6d7c":"#5eb1c6").attr("stroke","#fff").attr("stroke-width",1).attr("class","dept-bar").style("cursor","pointer").on("mouseover",function(k,z){W(this).transition().duration(200).attr("fill","#ff7f50");const V=w.get(z.key);P.html(`
					<div style="font-weight: bold; margin-bottom: 5px; color: #2a6d7c;">${z.key}</div>
					<div>Total cases: <b>${z.value}</b> (${ie(".1f")(z.percent)}% of all)</div>
					${a()?`<div style="font-weight: bold; color: #2a6d7c; margin-top: 3px;">
							Showing as percentage: ${ie(".1f")(z.percent)}%
						</div>`:""}
					<div style="margin-top: 5px;">
						<div>Sex ratio: <b>${ie(".0f")(V.malePercent)}% M / ${ie(".0f")(V.femalePercent)}% F</b></div>
						<div>Median age: <b>${ie(".1f")(V.medianAge)}</b> years</div>
						<div>IQR: <b>${ie(".1f")(V.q1)} - ${ie(".1f")(V.q3)}</b></div>
					</div>
					<div style="margin-top: 5px; font-size: 10px; color: #666;">Click to filter dashboard by department</div>
				`).style("visibility","visible").style("left",k.pageX+15+"px").style("top",k.pageY-10+"px")}).on("mousemove",function(k){P.style("left",k.pageX+15+"px").style("top",k.pageY-10+"px")}).on("mouseout",function(){const k=W(this).datum();W(this).transition().duration(200).attr("fill",r()===k.key?"#ff7f50":M.includes(k)?"#2a6d7c":"#5eb1c6"),P.style("visibility","hidden")}).on("click",function(k,z){k.stopPropagation();const V=r()===z.key?null:z.key;o("filter",{department:V,name:z.key}),W(l(i)).selectAll(".dept-bar").transition().duration(300).attr("fill",I=>I.key===V?"#ff7f50":M.includes(I)?"#2a6d7c":"#5eb1c6"),r(V)}),E.append("g").attr("transform",`translate(0,${x})`).call(Un(T)).selectAll("text").attr("transform","rotate(-35)").attr("text-anchor","end").attr("dy","0.5em").attr("dx","-0.8em").style("font-size","12px"),E.append("g").call(wr(S).tickFormat(k=>a()?ie(".1f")(k)+"%":ie(",.0f")(k))).style("font-size","12px"),E.append("text").attr("x",g/2).attr("y",x+65).attr("text-anchor","middle").style("font-size","14px").text("Surgical Department").attr("class","fill-text-primary"),E.append("text").attr("transform","rotate(-90)").attr("x",-230/2).attr("y",-50).attr("text-anchor","middle").style("font-size","14px").text(a()?"Percentage of Cases (%)":"Number of Cases").attr("class","fill-text-primary")}function u(){r()&&(r(null),o("filter",{department:null}),c())}Ee(()=>{c();const y=l(i);return y&&y.addEventListener("click",u),()=>{y&&y.removeEventListener("click",u),W("body").selectAll(".dept-tooltip").remove()}}),Pi(c),ot(()=>(Rt(a()),l(i),W),()=>{a()!==void 0&&l(i)&&(W("body").selectAll(".dept-tooltip").style("visibility","hidden"),c())}),ot(()=>(l(i),Rt(n())),()=>{l(i)&&n()&&c()}),We(),Xe();var d=th(),f=v(d),h=v(f);nn(h,y=>F(i,y),()=>l(i)),p(f);var m=_(f,2);{var A=y=>{var g=Jd(),x=_(v(g),2),b=_(v(x)),C=v(b,!0);p(b),At(),p(x);var $=_(x,2);p(g),Tt(()=>Y(C,r())),Ve("click",$,u),X(y,g)},L=y=>{};Et(m,y=>{r()?y(A):y(L,!1)})}p(d),X(t,d),Ae()}var nh=K(`<div class="slide-container svelte-19z7s3g"><div class="content svelte-19z7s3g"><h2 class="svelte-19z7s3g">Who Steps Into the OR?</h2> <p class="description svelte-19z7s3g">Let's start by meeting our patients. The charts below reveal a striking pattern: while our
			patients span six decades, <strong>95% cluster in just two surgical departments</strong>. This concentration—combined with
			age and sex differences—creates wildly different baseline risks before the first incision. Click
			any department bar or select an age range to filter the dashboard and see how demographics shift
			across specialties.</p> <div class="controls-container svelte-19z7s3g"><div class="flex-controls svelte-19z7s3g"><label class="control-item svelte-19z7s3g"><input type="checkbox" class="svelte-19z7s3g"/> <span class="checkbox-label svelte-19z7s3g">Show percentages</span></label> <label class="control-item svelte-19z7s3g"><input type="checkbox" class="svelte-19z7s3g"/> <span class="checkbox-label svelte-19z7s3g">Split by sex</span></label> <p class="tip-text svelte-19z7s3g"><i>Tip: Click and drag on the age chart to filter by age range. Click on department bars to
						filter by department.</i></p></div></div> <div class="visualization-grid svelte-19z7s3g"><!> <!></div> <div class="insights-container svelte-19z7s3g"><h4 class="svelte-19z7s3g">Insights into Demographics</h4> <div class="insights-grid svelte-19z7s3g"><div class="insight-card svelte-19z7s3g"><p class="svelte-19z7s3g">Our surgical cases span six decades of life. The median age of 59.0 suggests an
						aging population, with implications for surgical risk and recovery
						considerations.</p></div> <div class="insight-card svelte-19z7s3g"><p class="svelte-19z7s3g">Our patients span six decades, but 95% of them cluster in just two surgical
						departments, setting the stage for wildly different baseline risks.</p></div></div></div></div></div>`);function rh(t,e){Me(e,!1);let n=H([]),r=H(null),a=H(null),i=H(!1),s=H(!1),o=te(e,"cases",24,()=>[]);function c(S){const{department:E}=S.detail;F(r,E),f()}function u(S){F(i,S.detail.showPercentage)}function d(S){const{ageRange:E}=S.detail;F(a,E),f()}function f(){let S=[...o()];l(r)&&(S=S.filter(E=>E.department===l(r))),l(a)&&(S=S.filter(E=>E.age!==void 0&&E.age>=l(a)[0]&&E.age<=l(a)[1])),F(n,S)}ot(()=>Rt(o()),()=>{if(o().length>0){let V=function(I,q){const it=I.avgWait;I.count++,I.avgWait=(it*(I.count-1)+q)/I.count,I.stdDev=Math.sqrt(((I.count-2)*I.stdDev*I.stdDev+(q-it)*(q-I.avgWait))/(I.count-1))};const S=o().filter(I=>I.emop===1&&(I.preop_alb??0)<3),E=o().filter(I=>I.emop===0&&(I.preop_alb??0)>3.5),w=S.length>0?S.reduce((I,q)=>I+(q.death_inhosp??0),0)/S.length:0,P=E.length>0?E.reduce((I,q)=>I+(q.death_inhosp??0),0)/E.length:0;console.log("Emergency Low Alb Mortality:",(w*100).toFixed(1)+"%"),console.log("Elective High Alb Mortality:",(P*100).toFixed(1)+"%"),console.log("Ratio:",(w/(P||.001)).toFixed(1)+"x");const k=new Map,z=new Map;o().forEach(I=>{if(I.department&&I.optype&&I.anestart&&I.opstart){const q=(I.opstart-I.anestart)/60;k.has(I.department)||k.set(I.department,{count:0,avgWait:0,stdDev:0}),V(k.get(I.department),q),z.has(I.optype)||z.set(I.optype,{count:0,avgWait:0,stdDev:0}),V(z.get(I.optype),q)}}),console.log(`
Department Timing Patterns (sorted by case count):`),Array.from(k.entries()).sort((I,q)=>q[1].count-I[1].count).forEach(([I,q])=>{console.log(`${I}: ${q.count} cases, avg wait ${q.avgWait.toFixed(1)} ± ${q.stdDev.toFixed(1)} min`)}),console.log(`
Surgery Type Timing Patterns (top 10 by case count):`),Array.from(z.entries()).sort((I,q)=>q[1].count-I[1].count).slice(0,10).forEach(([I,q])=>{console.log(`${I}: ${q.count} cases, avg wait ${q.avgWait.toFixed(1)} ± ${q.stdDev.toFixed(1)} min`)})}}),We(),Xe();var h=nh(),m=v(h),A=_(v(m),4),L=v(A),y=v(L),g=v(y);wt(g),At(2),p(y);var x=_(y,2),b=v(x);wt(b),At(2),p(x),At(2),p(L),p(A);var C=_(A,2),$=v(C);const N=Re(()=>l(r)?l(n):o());Zd($,{get data(){return l(N)},get showPercentage(){return l(i)},set showPercentage(S){F(i,S)},get showBySex(){return l(s)},set showBySex(S){F(s,S)},$$events:{percentageChange:u,filter:d},$$legacy:!0});var M=_($,2);const T=Re(()=>l(a)?l(n):o());eh(M,{get data(){return l(T)},get filteredDepartment(){return l(r)},get showPercentage(){return l(i)},$$events:{filter:c}}),p(C),At(2),p(m),p(h),fe(g,()=>l(i),S=>F(i,S)),fe(b,()=>l(s),S=>F(s,S)),X(t,h),Ae()}function ah(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const ih=t=>Su(t[t.length-1]);var sh=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(ah);const oh=ih(sh);function In(t,e,n){this.k=t,this.x=e,this.y=n}In.prototype={constructor:In,scale:function(t){return t===1?this:new In(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new In(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};In.prototype;var lh=K("<option> </option>"),ch=K('<div class="no-data-message svelte-17bwdb">No cases match the selected criteria.</div>'),uh=K('<div class="timeline-container svelte-17bwdb"><div class="filter-controls svelte-17bwdb"><div class="filter-group svelte-17bwdb"><label for="group-select" class="svelte-17bwdb">Group By:</label> <select id="group-select" class="svelte-17bwdb"><option>Surgery Type</option><option>Department</option></select></div> <div class="filter-group svelte-17bwdb"><label for="group-value" class="svelte-17bwdb">Filter Value:</label> <select id="group-value" class="svelte-17bwdb"><option>All</option><!></select></div> <div class="filter-group svelte-17bwdb"><label class="svelte-17bwdb">Age Range:</label> <div class="age-inputs svelte-17bwdb"><div class="age-input-group svelte-17bwdb"><input type="number" min="0" max="120" class="svelte-17bwdb"/> <input type="range" min="0" max="120" class="age-slider svelte-17bwdb"/></div> <span>to</span> <div class="age-input-group svelte-17bwdb"><input type="number" min="0" max="120" class="svelte-17bwdb"/> <input type="range" min="0" max="120" class="age-slider svelte-17bwdb"/></div></div></div></div> <div class="timeline-visualization svelte-17bwdb"></div> <!></div>');function fh(t,e){Me(e,!1);const n=H();let r=te(e,"cases",24,()=>[]),a=te(e,"groupBy",12,"optype"),i=te(e,"ageRange",28,()=>[0,120]),s=te(e,"selectedDepartment",8,null),o=H(null),c=H(),u=H(),d=H([]);const f=[{label:"Case Duration",startKey:"casestart",endKey:"caseend"},{label:"Anesthesia Duration",startKey:"anestart",endKey:"aneend"},{label:"Operation Duration",startKey:"opstart",endKey:"opend"}];function h(B){return B.length?f.map(({label:U,startKey:j,endKey:st})=>{const ct=[],yt=[];B.forEach(J=>{const lt=J.casestart,dt=J[j],tt=J[st];typeof lt=="number"&&typeof dt=="number"&&typeof tt=="number"&&(ct.push(dt-lt),yt.push(tt-lt))});const R=365*24*60*60,Q=ct.map((J,lt)=>{const dt=yt[lt];return dt>J&&dt-J<R}),kt=ct.filter((J,lt)=>Q[lt]),at=yt.filter((J,lt)=>Q[lt]);return kt.length===0?{label:U,key:j,startMean:null,endMean:null}:{label:U,key:j,startMean:oi(kt),endMean:oi(at)}}):f.map(({label:U,startKey:j})=>({label:U,key:j,startMean:null,endMean:null}))}let m=H([]),A=H(!1);function L(){if(!l(c)||(Zt(c,l(c).innerHTML=""),!l(m).length))return;const B=l(u).offsetWidth,U=l(c).clientHeight>0?l(c).clientHeight:400,j={top:20,right:100,bottom:60,left:200},st=B-j.left-j.right,ct=U-j.top-j.bottom,yt=l(m).filter(vt=>vt.startMean!==null&&vt.endMean!==null),R=yt.flatMap(vt=>[vt.startMean,vt.endMean]),Q=Math.min(...R),kt=Math.max(...R),at=10,J=Math.floor(Q/60)-at,lt=Math.ceil(kt/60)+at,dt=lt-J>120,tt=dt?60:1,Nt=dt?[J/60,lt/60]:[J,lt],O=(lt-J)/(6*tt),ft=ys(Nt[0],Nt[1]+O,O),Dt=Ye().domain(Nt).range([0,st]),Ft=_r().domain(yt.map(vt=>vt.label)).range([0,ct]).padding(.4),Ct=W(l(c)).append("svg").attr("width","100%").attr("height","100%").attr("viewBox",`0 -20 ${B} ${U+20}`).attr("preserveAspectRatio","xMidYMid meet"),xt=Ct.append("g").attr("transform",`translate(${j.left},${j.top})`),Mt=["#81C784","#FFB74D","#9575CD"],Bt=br().domain(f.map(vt=>vt.label)).range(Mt),Ht=Un(Dt).tickValues(ft).tickFormat(vt=>{const ne=vt;return dt?`${ne.toFixed(1)} hr`:`${Math.round(ne)} min`}),ee=xt.append("g").attr("transform",`translate(0,${ct})`).call(Ht);ee.selectAll("text").style("font-size","12px").style("text-anchor","middle").attr("fill","#CBD5E0").attr("dy","1em"),ee.selectAll(".tick line").remove(),ee.selectAll(".tick").append("line").attr("y1",-ct).attr("y2",0).attr("stroke","#4A5568").attr("stroke-dasharray","2,2").attr("opacity",.5),xt.append("line").attr("x1",0).attr("y1",ct).attr("x2",st).attr("y2",ct).attr("stroke","#4A5568").attr("stroke-width",1),xt.append("g").selectAll("text").data(yt).enter().append("text").attr("x",-10).attr("y",vt=>(Ft(vt.label)||0)+Ft.bandwidth()/2).attr("text-anchor","end").attr("dominant-baseline","middle").style("font-size","12px").attr("fill","#CBD5E0").text(vt=>vt.label);const qt=W(l(c)).append("div").attr("class","timeline-tooltip").style("position","absolute").style("padding","8px 12px").style("background","rgba(45, 55, 72, 0.95)").style("color","white").style("border-radius","4px").style("font-size","12px").style("pointer-events","none").style("opacity",0).style("box-shadow","0 2px 4px rgba(0,0,0,0.2)").style("z-index","1000").style("white-space","nowrap").style("transition","opacity 0.2s");xt.selectAll(".event-group").data(yt).enter().append("g").attr("class","event-group").each(function(vt){const ne=W(this),me=(Ft(vt.label)||0)+Ft.bandwidth()/2,he=dt?vt.startMean/3600:vt.startMean/60,It=dt?vt.endMean/3600:vt.endMean/60;ne.append("line").attr("x1",Dt(he)).attr("x2",Dt(It)).attr("y1",me).attr("y2",me).attr("stroke",()=>Bt(vt.label)).attr("stroke-width",6).attr("opacity",.9).style("cursor","pointer").on("mouseenter",function(Ot){qt.style("opacity",1).html(`
								<strong>${vt.label}</strong><br>
								Duration: ${dt?`${(It-he).toFixed(1)} hr`:`${((It-he)*60).toFixed(1)} min`}
							`)}).on("mousemove",Ot=>{const[ye,pe]=aa(Ot),jt=120,re=40,ve=l(c).getBoundingClientRect();let xe=Ot.pageX+10,be=Ot.pageY-re-10;xe+jt>ve.right&&(xe=Ot.pageX-jt-10),be<ve.top&&(be=Ot.pageY+10),qt.style("left",`${xe}px`).style("top",`${be}px`)}).on("mouseout",()=>{qt.transition().duration(200).style("opacity",0)}),["start","end"].forEach(Ot=>{const ye=Ot==="start"?he:It;ne.append("circle").attr("cx",Dt(ye)).attr("cy",me).attr("r",8).attr("fill",()=>Bt(vt.label)).attr("stroke","white").attr("stroke-width",2).style("cursor","pointer").on("mouseenter",function(jt){qt.style("opacity",1).html(`
									<strong>${vt.label} - ${Ot==="start"?"Start":"End"}</strong><br>
									Time: ${dt?`${ye.toFixed(1)} hr`:`${(ye*60).toFixed(1)} min`}
								`)}).on("mousemove",function(jt){const re=l(c).getBoundingClientRect(),ve=120,xe=40;let be=jt.clientX-re.left+10,ge=jt.clientY-re.top-xe-10;be+ve>re.width&&(be=jt.clientX-re.left-ve-10),ge<0&&(ge=jt.clientY-re.top+10),qt.style("left",`${be+re.left}px`).style("top",`${ge+re.top}px`)}).on("mouseleave",function(){qt.transition().duration(200).style("opacity",0)})})});let Yt="";l(o)&&(Yt+=`${a()==="optype"?"Surgery Type":"Department"}: ${l(o)}`),s()&&(Yt+=Yt?`, Department: ${s()}`:`Department: ${s()}`),(i()[0]>0||i()[1]<120)&&(Yt+=Yt?`, Age: ${i()[0]}-${i()[1]}`:`Age: ${i()[0]}-${i()[1]}`),Yt&&Ct.append("text").attr("x",j.left).attr("y",j.top-25).attr("font-size","12px").attr("fill","#CBD5E0").text(Yt),Ct.append("text").attr("x",B-j.right-10).attr("y",j.top-25).attr("text-anchor","end").attr("font-size","12px").attr("fill","#CBD5E0").text(`n = ${l(n).length} cases`)}Ee(()=>{l(c)&&L()}),ot(()=>(Rt(r()),l(o),Rt(a()),Rt(s()),Rt(i())),()=>{F(n,r().filter(B=>(!l(o)||B[a()]===l(o))&&(!s()||B.department===s())&&(B.age??0)>=i()[0]&&(B.age??120)<=i()[1]))}),ot(()=>(Rt(r()),Rt(a())),()=>{F(d,Array.from(new Set(r().map(B=>B[a()]??""))).filter(Boolean))}),ot(()=>l(n),()=>{l(n)&&(F(m,h(l(n))),F(A,!0))}),ot(()=>(l(A),l(c)),()=>{l(A)&&l(c)&&(L(),F(A,!1))}),We(),Xe();var y=uh(),g=v(y),x=v(g),b=_(v(x),2);Tt(()=>{a(),Ga(()=>{})});var C=v(b);C.value=C.__value="optype";var $=_(C);$.value=$.__value="department",p(b),p(x);var N=_(x,2),M=_(v(N),2);Tt(()=>{l(o),Ga(()=>{l(d)})});var T=v(M);T.value=(T.__value=null)??"";var S=_(T);zn(S,1,()=>l(d),Dn,(B,U)=>{var j=lh(),st={},ct=v(j,!0);p(j),Tt(()=>{st!==(st=l(U))&&(j.value=(j.__value=l(U))??""),Y(ct,l(U))}),X(B,j)}),p(M),p(N);var E=_(N,2),w=_(v(E),2),P=v(w),k=v(P);wt(k);var z=_(k,2);wt(z),p(P);var V=_(P,4),I=v(V);wt(I);var q=_(I,2);wt(q),p(V),p(w),p(E),p(g);var it=_(g,2);nn(it,B=>F(c,B),()=>l(c));var G=_(it,2);{var pt=B=>{var U=ch();X(B,U)};Et(G,B=>{l(n).length===0&&B(pt)})}p(y),nn(y,B=>F(u,B),()=>l(u)),ei(b,a),ei(M,()=>l(o),B=>F(o,B)),se(k,()=>i()[0],B=>i(i()[0]=B,!0)),se(z,()=>i()[0],B=>i(i()[0]=B,!0)),se(I,()=>i()[1],B=>i(i()[1]=B,!0)),se(q,()=>i()[1],B=>i(i()[1]=B,!0)),X(t,y),Ae()}var dh=K(`<div class="slide-container svelte-25cc9g"><div class="content svelte-25cc9g"><h2 class="svelte-25cc9g">Time on the Table</h2> <p class="description svelte-25cc9g">Each dot marks a key moment in surgery. The visualization shows <strong>mean, min, and max durations</strong> across our 6,388 cases. Try the filters above—switch between department and surgery type to see how <strong>different procedures have their own rhythm</strong>. This pre-incision time matters, as longer anesthesia exposure
			before surgery increases risk of complications. If you're facing surgery, use these filters to see
			typical timing patterns for your procedure—knowledge that can help you understand and prepare for
			your own surgical journey. Hover over dots for exact timing stats.</p> <div class="timeline-wrapper svelte-25cc9g"><!></div> <p class="timing-note svelte-25cc9g">For instance, breast surgeries average just <strong>34 minutes</strong> from anesthesia to incision, 
			while transplantations take nearly twice as long, <strong>at 70 minutes</strong>.</p></div></div>`);function hh(t,e){var n=dh(),r=v(n),a=_(v(r),4),i=v(a);fh(i,{get cases(){return e.cases}}),p(a),At(2),p(r),p(n),X(t,n)}function ph(t,e){return vh(t)||gh(t,e)||mh()}function vh(t){if(Array.isArray(t))return t}function gh(t,e){var n=[],r=!0,a=!1,i=void 0;try{for(var s=t[Symbol.iterator](),o;!(r=(o=s.next()).done)&&(n.push(o.value),!(e&&n.length===e));r=!0);}catch(c){a=!0,i=c}finally{try{!r&&s.return!=null&&s.return()}finally{if(a)throw i}}return n}function mh(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function qs(t,e,n,r){for(var a=0,i=0,s=t.length;i<s;i++){var o=t[i],c=+e(o,i,t),u=+n(o,i,t);c!=null&&isFinite(c)&&u!=null&&isFinite(u)&&r(c,u,a++)}}function yh(t,e,n,r,a){var i=0,s=0;return qs(t,e,n,function(o,c){var u=c-a(o),d=c-r;i+=u*u,s+=d*d}),1-i/s}function xh(t,e,n,r){var a=r-t*t,i=Math.abs(a)<1e-24?0:(n-t*e)/a,s=e-i*t;return[s,i]}function bh(){var t=function(i){return i[0]},e=function(i){return i[1]},n;function r(a){var i=0,s=0,o=0,c=0,u=0,d=n?+n[0]:1/0,f=n?+n[1]:-1/0;qs(a,t,e,function(x,b){++i,s+=(x-s)/i,o+=(b-o)/i,c+=(x*b-c)/i,u+=(x*x-u)/i,n||(x<d&&(d=x),x>f&&(f=x))});var h=xh(s,o,c,u),m=ph(h,2),A=m[0],L=m[1],y=function(b){return L*b+A},g=[[d,y(d)],[f,y(f)]];return g.a=L,g.b=A,g.predict=y,g.rSquared=yh(a,t,e,o,y),g}return r.domain=function(a){return arguments.length?(n=a,r):n},r.x=function(a){return arguments.length?(t=a,r):t},r.y=function(a){return arguments.length?(e=a,r):e},r}var _h=K('<div class="bg-[#1a2332] rounded-xl p-6 shadow-lg"><div class="mb-4 flex gap-6 text-sm text-gray-200"><label><input type="radio"/> <span class="ml-1">Elective</span></label> <label><input type="radio"/> <span class="ml-1">Emergency</span></label> <label><input type="radio"/> <span class="ml-1">All</span></label></div> <svg style="width: 100%; height: auto;" class="svelte-1pqg8op"></svg></div>');function wh(t,e){Me(e,!1);const n=[];let r=te(e,"patients",24,()=>[]),a=H("elective"),i=H([]),s=H();const o=640,c=320,u=48,d=100,h=Rs(M=>M<.15?"#ff0000":oh(M)).domain([5,0]);function m(M){if(!l(s))return;const T=W(l(s)).attr("viewBox",`0 0 ${o} ${c}`).html("");if(!M.length){T.append("text").attr("x",o/2).attr("y",c/2).attr("text-anchor","middle").attr("fill","#888").attr("font-size","16px").text("No cases with albumin in this view");return}const S=[...M].sort((R,Q)=>+R.preop_alb-+Q.preop_alb),E=[];for(let R=0;R<S.length;R+=5){const Q=S.slice(R,R+5);if(Q.length>0){const kt=Q.reduce((J,lt)=>J+ +lt.preop_alb,0)/Q.length,at=Q.reduce((J,lt)=>J+(lt.icu_days||0),0)/Q.length;E.push({albumin:kt,icuDays:at,count:Q.length,cases:Q})}}let w=E;(l(a)==="emergency"||l(a)==="all")&&(w=E.filter(R=>R.icuDays<20)),w=w.filter(R=>R.albumin>=2);const P=Ye().domain([2,Te(w,R=>R.albumin)||6]).nice().range([d,o-u]),k=Ye().domain([0,Te(w,R=>R.icuDays)||5]).nice().range([c-u,u]),z=T.append("g");k.ticks(5).forEach(R=>{z.append("line").attr("x1",d).attr("x2",o-u).attr("y1",k(R)).attr("y2",k(R)).attr("stroke","#e5e7eb").attr("stroke-width",1)}),P.ticks(6).forEach(R=>{z.append("line").attr("x1",P(R)).attr("x2",P(R)).attr("y1",u).attr("y2",c-u).attr("stroke","#e5e7eb").attr("stroke-width",1)}),z.append("line").attr("x1",P(3.5)).attr("x2",P(3.5)).attr("y1",u).attr("y2",c-u).attr("stroke","#ff3b3b").attr("stroke-width",2).attr("stroke-dasharray","4,4"),z.append("text").attr("x",P(3.5)).attr("y",u-10).attr("text-anchor","middle").attr("font-size","12px").attr("fill","#ff3b3b").attr("font-weight","500").text("Albumin Cliff (3.5 g/dL)");const V=bh().x(R=>R.albumin).y(R=>R.icuDays).domain(P.domain())(w),I=kf().x(R=>P(R[0])).y(R=>k(R[1])),q=Math.max(2,sa(w,R=>R.albumin)||0),it=Te(w,R=>R.albumin)||0,G=[[q,Math.max(0,V.predict(q))],[it,Math.max(0,V.predict(it))]];T.append("path").datum(G).attr("fill","none").attr("stroke","#fbbf24").attr("stroke-width",2).attr("d",R=>I(R)),T.append("g").selectAll("circle").data(w).enter().append("circle").attr("cx",R=>P(R.albumin)).attr("cy",R=>k(R.icuDays)).attr("r",R=>Math.sqrt(R.count)*2).attr("fill",R=>h(Math.min(R.icuDays,5))).attr("stroke","#374151").attr("stroke-opacity",.15).append("title").text(R=>`Average Albumin: ${R.albumin.toFixed(2)} g/dL
Average ICU Stay: ${R.icuDays.toFixed(1)} days
Number of Cases: ${R.count}`);const pt=Un(P).ticks(6).tickFormat(R=>R+" g/dL");T.append("g").attr("transform",`translate(0, ${c-u})`).call(pt).selectAll("text").attr("font-size","13px").attr("fill","#374151").attr("class","fill-text-primary");const B=wr(k).ticks(5).tickFormat(R=>R+" days");T.append("g").attr("transform",`translate(${d}, 0)`).call(B).selectAll("text").attr("font-size","13px").attr("fill","#374151").attr("class","fill-text-primary"),T.append("text").attr("x",o/2).attr("y",c-u+36).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#374151").text("Pre-operative Albumin (g/dL)").attr("class","fill-text-primary"),T.append("text").attr("transform",`translate(${d-60}, ${c/2}) rotate(-90)`).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#374151").text("Average ICU Stay (days)").attr("class","fill-text-primary"),T.append("text").attr("x",o/2).attr("y",u-32).attr("text-anchor","middle").attr("font-size","16px").attr("font-weight","600").text("Hidden Risk Factor — The Albumin Cliff").attr("class","fill-text-primary");const U=o-u-80,j=u-40,st=T.append("g").attr("transform",`translate(${U}, ${j})`),ct=[0,1,2,3,4,5],yt=15;st.selectAll("rect").data(ct).enter().append("rect").attr("x",(R,Q)=>Q*(yt+2)).attr("y",0).attr("width",yt).attr("height",10).attr("fill",R=>h(R)),st.append("text").attr("x",0).attr("y",24).attr("font-size","12px").attr("fill","#374151").text("ICU ≥ 5d").attr("class","fill-text-primary"),st.append("text").attr("x",(yt+2)*5+4).attr("y",24).attr("text-anchor","end").attr("font-size","12px").attr("fill","#374151").text("0–1d").attr("class","fill-text-primary")}Ee(()=>{l(s)&&m(l(i))}),ot(()=>(Rt(r()),l(a)),()=>{r()?F(i,r().filter(M=>{const T=+M.preop_alb;return!Number.isFinite(T)||T<=0?!1:l(a)==="elective"?M.emop===0&&M.ane_type==="General":l(a)==="emergency"?M.emop===1:!0})):F(i,[])}),ot(()=>(l(s),l(i)),()=>{l(s)&&m(l(i))}),We(),Xe();var A=_h(),L=v(A),y=v(L),g=v(y);wt(g),g.value=g.__value="elective",At(2),p(y);var x=_(y,2),b=v(x);wt(b),b.value=b.__value="emergency",At(2),p(x);var C=_(x,2),$=v(C);wt($),$.value=$.__value="all",At(2),p(C),p(L);var N=_(L,2);nn(N,M=>F(s,M),()=>l(s)),p(A),Pr(n,[],g,()=>l(a),M=>F(a,M)),Pr(n,[],b,()=>l(a),M=>F(a,M)),Pr(n,[],$,()=>l(a),M=>F(a,M)),X(t,A),Ae()}var kh=K(`<h2>Hidden Risk Factor — The Albumin Cliff</h2> <p>Albumin is a blood protein that reflects nutritional reserve and overall physiological resilience.
	In the pre-operative setting, low albumin levels often signal that a patient's body may struggle
	to recover. By highlighting albumin, we remind viewers that a seemingly "routine" lab value—often
	checked before surgery—can quietly predict who sails through the OR and who may end up in the ICU.
	It's the kind of hidden detail that turns "routine" into "unexpected" when no one is watching.</p> <br/> <p><strong>x-axis</strong> = pre-operative albumin (g/dL). <strong>Dot color</strong> = post-op ICU stay (<span style="color:#a50026">red ≈ ≥ 3 days</span>, <span style="color:#3288bd">deep-blue ≈ 0–1 day</span>). Use the radio buttons to flip between
	routine <b>elective</b>, urgent <b>emergency</b>, or <b>all</b> cases. Below a certain threshold, the
	risk of prolonged ICU stay climbs sharply—our so-called "Albumin Cliff."</p> <br/> <!> <div class="h-7"></div> <h3>What we actually see</h3> <ul class="list-inside list-disc space-y-1"><li><strong>In elective cases, a pronounced shift appears near 3 g/dL.</strong> Patients with albumin just under 3 g/dL begin to light up orange and red, whereas above 3 g/dL most
		stay deep-blue. <span class="font-semibold">Median ICU stay below 3 g/dL is about 2.1 days (IQR 1–4),</span> compared to <span class="font-semibold">0.7 days (IQR 0–1) above 3 g/dL</span>. A few low-albumin blue
		outliers exist, but long-stayers (amber & red) become nearly three times more common once you
		cross that cliff.</li> <li><strong>In emergencies, the "cliff" shifts upward to around 3.5 g/dL.</strong> Because urgent cases already carry extra risk, the median albumin threshold where ICU stays spike
		is higher. Below ~3.5 g/dL, <span class="font-semibold">the chance of ≥ 3-day ICU stay more than doubles</span> compared to those with albumin above 3.5 g/dL. The spread of dots is wider, but the color gradient
		still tilts toward red as albumin drops.</li> <li>High-albumin (> 4 g/dL) patients rarely linger, anchoring the schedule "clockwork" we saw in the
		opening hook.</li></ul> <p><b>Take-away&nbsp;→</b> Albumin isn't a guarantee of trouble, but a <em>silent gravity well</em>: the lower it drops, the harder it is to climb off the ICU track.
	Even in apparently routine electives, nutrition can tip the balance from day-case discharge to
	days of critical care.</p> <div class="h-16"></div>`,1);function Mh(t,e){var n=kh(),r=_(Ce(n),10);wh(r,{get patients(){return e.cases}}),At(10),X(t,n)}var Ah=K(`<div class="mx-auto max-w-2xl rounded-lg bg-indigo-50 p-8"><h2>The Takeaway</h2> <p class="text-lg text-indigo-800">The data reveals three critical insights: First, pre-op albumin levels—easily measured and often
		correctable—strongly predict ICU stays. Second, emergency status and ASA score interact in ways
		that standard checklists miss. And third, while we can't change age, we can optimize timing,
		prepare blood products, and adjust recovery expectations based on these risk factors. The data
		tells us where to look—before the knife ever touches skin.</p></div>`);function $h(t){var e=Ah();X(t,e)}var Ch=K(`<h2>Writeup</h2> <p>1. What have you done so far? So far, we’ve built a comprehensive exploratory analysis of our
	surgical patient population to lay the groundwork for outcome-based modeling. We began by
	visualizing age distribution, revealing a wide range of patients from their twenties to their
	eighties. This range emphasizes the variation in baseline risk and physiological resilience across
	the cohort. We then created a department-wise breakdown of surgical cases, showing that general
	surgery dominates in volume, with notable contributions from thoracic surgery and urology. <br/>In addition to demographic insights, we constructed a line chart to compare the average
	duration of each surgical phase (anesthesia, surgery, and recovery) across departments. This helps
	contextualize how time and resource demands vary by specialty. We also explored risk
	stratification through a radar chart comparing median outcomes for high- and low-risk cohorts.
	Metrics like mortality, ICU stay, and blood loss were visualized, clearly showing that
	pre-operative risk factors correlate with worse outcomes. Finally, we built an interactive tool
	that allows users to manipulate variables like age, ASA status, and emergency status to simulate
	predicted risks, making the data both accessible and actionable. <br/><br/>2. What will be the most challenging part of your project to design and why? The most
	challenging component of the project will likely be the design and refinement of the “Build Your
	Own Patient” predictive interface. While the tool currently visualizes model output based on
	user-selected inputs, accurately modeling risk for ICU stay and in-hospital mortality from such a
	small set of parameters introduces complexity. Capturing the nuances of surgical risk—especially
	interactions between variables like age and ASA score—requires both careful feature engineering
	and robust validation against clinical outcomes. <br/>Additionally, designing an interface that is intuitive yet scientifically accurate presents
	a UI/UX challenge. Users must understand the sensitivity of predictions without misinterpreting
	them as deterministic. Balancing simplicity with explanatory power, and ensuring the tool reflects
	real-world risk distributions without bias, will require tight integration between the front-end
	experience and the underlying model logic. Finally, scaling the model for more granular or
	department-specific predictions while maintaining speed and clarity will require thoughtful
	architectural decisions as the project evolves.</p>`,1);function Sh(t){var e=Ch();At(2),X(t,e)}function _a(t,e){const n=t.filter(u=>u.age!=null&&Math.abs(u.age-e.age)<=10),r=t.filter(u=>u.bmi!=null&&Math.abs(u.bmi-e.bmi)<=8),a=t.filter(u=>u.height!=null&&Math.abs(u.height-e.height)<=10.16),i=t.filter(u=>u.asa!=null&&Math.abs(u.asa-e.asa)<=3),c=n.filter(u=>r.includes(u)).filter(u=>a.includes(u)).filter(u=>i.includes(u));return console.log("Matching cases:",{ageMatches:n.length,bmiMatches:r.length,heightMatches:a.length,asaMatches:i.length,finalMatches:c.length,profile:e}),c}function pn(t){if(t.length===0)return{avgICUStay:0,mortalityRate:0,avgBloodLoss:0,icuIQR:{q1:0,q3:0},bloodLossIQR:{q1:0,q3:0},icuValues:[],bloodLossValues:[]};const e=t.map(c=>Number(c.icu_days)).filter(c=>!isNaN(c)).sort((c,u)=>c-u),n=e.reduce((c,u)=>c+u,0)/e.length,r={q1:e[Math.floor(e.length*.25)],q3:e[Math.floor(e.length*.75)]},a=t.reduce((c,u)=>c+(u.death_inhosp||0),0)/t.length,i=t.map(c=>Number(c.intraop_ebl)).filter(c=>!isNaN(c)).sort((c,u)=>c-u),s=i.reduce((c,u)=>c+u,0)/i.length,o={q1:i[Math.floor(i.length*.25)],q3:i[Math.floor(i.length*.75)]};return{avgICUStay:n,mortalityRate:a,avgBloodLoss:s,icuIQR:r,bloodLossIQR:o,icuValues:e,bloodLossValues:i}}function ta(t,e,n){if(e===0&&t===0)return 1;if(e===0||t===0)return 0;const r=Math.abs(t-e)/Math.max(e,1);return Math.exp(-r)}var Rh=K(`<p class="mb-3 text-sm opacity-80">There are no historical cases that match your current patient profile.</p> <div class="space-y-1"><p class="text-sm font-medium opacity-80">Consider:</p> <ul class="ml-4 space-y-1 text-sm opacity-70"><li>• Relaxing some of your filters</li> <li>• Adjusting the patient's characteristics to more common values</li> <li>• Using a broader range for age, BMI, or ASA score</li></ul></div>`,1),Th=K('<p class="mb-3 text-sm opacity-80"> </p> <div class="space-y-1"><p class="text-sm font-medium opacity-80">Consider:</p> <ul class="ml-4 space-y-1 text-sm opacity-70"><li>• Relaxing some filters to get more comparable cases</li> <li>• Adjusting the patient profile to match more common characteristics</li></ul></div>',1),Nh=K('<div class="chart-wrapper svelte-1ehvwb8"><div class="flex items-start gap-3"><div class="flex h-10 w-10 items-center justify-center rounded-full bg-red-100"><span class="text-lg">⚠️</span></div> <div class="flex-1"><div class="flex items-center justify-between"><h4 class="mb-2 font-bold text-red-700"> </h4> <div class="flex items-center justify-center gap-2 min-w-[200px]"><span class="text-base font-medium">Overall Risk Level:</span> <span> </span></div></div> <!></div></div></div>'),Eh=K('<div class="chart-wrapper svelte-1ehvwb8"><div class="flex items-start gap-3"><div class="flex h-10 w-10 items-center justify-center rounded-full bg-yellow-100"><span class="text-lg">👍</span></div> <div class="flex-1"><div class="flex items-center justify-between"><h4 class="mb-2 font-bold text-yellow-700">Good Sample Size</h4> <div class="flex items-center justify-center gap-2 min-w-[200px]"><span class="text-base font-medium">Overall Risk Level:</span> <span> </span></div></div> <p class="text-sm opacity-80"> </p></div></div></div>'),Ih=K('<div class="chart-wrapper svelte-1ehvwb8"><div class="flex items-start gap-3"><div class="flex h-10 w-10 items-center justify-center rounded-full bg-green-100"><span class="text-lg">✅</span></div> <div class="flex-1"><div class="flex items-center justify-between"><h4 class="mb-2 font-bold text-green-700">Excellent Sample Size</h4> <div class="flex items-center justify-center gap-2 min-w-[200px]"><span class="text-base font-medium">Overall Risk Level:</span> <span> </span></div></div> <p class="text-sm opacity-80"> </p></div></div></div>'),Fh=K('<div class="grid grid-cols-1 gap-3 md:grid-cols-3"><div class="control-item svelte-1ehvwb8"><div class="flex items-center gap-3"><div><span class="text-base text-white">🏥</span></div> <div><h3 class="text-sm font-medium opacity-80">ICU Stay</h3> <p> </p></div></div></div> <div class="control-item svelte-1ehvwb8"><div class="flex items-center gap-3"><div><span class="text-base text-white">💗</span></div> <div><h3 class="text-sm font-medium opacity-80">Mortality Rate</h3> <p> </p></div></div></div> <div class="control-item svelte-1ehvwb8"><div class="flex items-center gap-3"><div><span class="text-base text-white">🩸</span></div> <div><h3 class="text-sm font-medium opacity-80">Blood Loss</h3> <p> </p></div></div></div></div>'),Lh=K('<div class="mt-6 space-y-4"><h3 class="text-lg font-semibold">Make Your Predictions</h3> <div class="grid gap-4"><div><label class="block text-sm opacity-80">Predicted ICU Stay (days)</label> <input type="number" min="0" step="0.1" class="mt-1 w-full rounded border p-2"/></div> <div><label class="block text-sm opacity-80">Predicted Mortality (%)</label> <input type="number" min="0" max="100" step="0.1" class="mt-1 w-full rounded border p-2"/></div> <div><label class="block text-sm opacity-80">Predicted Blood Loss (mL)</label> <input type="number" min="0" step="1" class="mt-1 w-full rounded border p-2"/></div></div></div>'),Dh=K(`<p class="mt-2 opacity-80">Your predictions were quite far from the actual outcomes. Consider reviewing the
							patient's risk factors more carefully.</p>`),zh=K('<div class="mt-4 rounded p-3 text-sm shadow-sm"> <!></div>'),Ph=K('<h3 class="mt-6 text-lg font-semibold">Outcomes from Similar Cases</h3> <div class="grid grid-cols-3 gap-4"><div><p class="text-sm opacity-80">Average ICU Stay</p> <p class="font-medium"> </p> <p class="text-xs opacity-60"> </p></div> <div><p class="text-sm opacity-80">Mortality Rate</p> <div class="h-2 w-full rounded-full" style="background: linear-gradient(to right, #22c55e, #ef4444)"></div> <p class="font-medium"> </p></div> <div><p class="text-sm opacity-80">Average Blood Loss</p> <p class="font-medium"> </p> <p class="text-xs opacity-60"> </p></div></div> <!>',1),Bh=K('<div class="container svelte-1ehvwb8"><div class="space-y-4 rounded-lg p-3 shadow-sm bg-[#0e192b]"><div class="controls-panel svelte-1ehvwb8"><div class="controls-content svelte-1ehvwb8"><div class="flex items-center justify-between"><h3 class="text-base font-semibold">Adjust Patient Profile</h3> <div class="flex items-center gap-3"><label class="flex items-center gap-2"><input type="checkbox" class="rounded border-gray-300"/> <span class="factor-name svelte-1ehvwb8">Age</span></label> <label class="flex items-center gap-2"><input type="checkbox" class="rounded border-gray-300"/> <span class="factor-name svelte-1ehvwb8">Height</span></label> <label class="flex items-center gap-2"><input type="checkbox" class="rounded border-gray-300"/> <span class="factor-name svelte-1ehvwb8">BMI</span></label> <label class="flex items-center gap-2"><input type="checkbox" class="rounded border-gray-300"/> <span class="factor-name svelte-1ehvwb8">ASA</span></label></div></div> <div class="grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-4"><div><label class="block text-xs opacity-80"> </label> <input type="range" class="w-full svelte-1ehvwb8"/> <p class="text-xs opacity-60"> </p></div> <div><label class="block text-xs opacity-80"> </label> <input type="range" class="w-full svelte-1ehvwb8"/> <p class="text-xs opacity-60"> </p></div> <div><label class="block text-xs opacity-80"> </label> <input type="range" step="0.1" class="w-full svelte-1ehvwb8"/> <p class="text-xs opacity-60"> </p></div> <div><label class="block text-xs opacity-80"> </label> <input type="range" min="1" max="5" step="1" class="w-full svelte-1ehvwb8"/> <p class="text-xs opacity-60"> </p></div></div></div></div> <!> <div class="grid grid-cols-1 gap-4 lg:grid-cols-12"><div class="space-y-2 lg:col-span-3"><h4 class="text-center text-sm font-semibold">Patient Visualization</h4> <div class="flex items-center justify-center"><svg class="h-full w-full" style="min-height: 250px; max-height: 350px;"><circle cx="100" cy="30" r="20"></circle><line x1="100" y1="50" x2="100"></line><ellipse cx="100"></ellipse><line x1="100" y1="80"></line><line x1="100" y1="80"></line><line x1="100" x2="70"></line><line x1="100" x2="130"></line><path d="M80,20 Q100,0 120,20" fill="none"></path></svg></div></div> <div class="space-y-2 lg:col-span-6"><h4 class="text-center text-sm font-semibold">Patient Outcomes Radar</h4> <div class="flex justify-center h-[450px] -mt-10 w-[120%] -ml-[10%]"><svg class="radar-chart h-full svelte-1ehvwb8"></svg></div></div> <div class="space-y-3 max-w-[350px] ml-auto lg:col-span-3"><div class="control-item svelte-1ehvwb8"><h4 class="mb-2 text-sm font-semibold">How to Read This Chart</h4> <div class="space-y-1 text-xs opacity-80"><p>• <strong>Distance from center</strong> = Risk level (0-100%)</p> <p>• <strong>Triangle shape</strong> = Overall risk profile</p> <p>• <strong>Color</strong> = Risk severity level</p></div></div> <div class="control-item svelte-1ehvwb8"><h4 class="mb-2 text-sm font-semibold">Scale Ranges</h4> <div class="space-y-1 text-xs opacity-80"><div><strong>ICU Stay:</strong> </div> <div><strong>Mortality Rate:</strong> </div> <div><strong>Blood Loss:</strong> </div> <div class="mt-2 text-xs opacity-60"><em>Ranges based on 95th percentile of dataset</em></div></div></div> <div class="control-item svelte-1ehvwb8"><h4 class="mb-2 text-sm font-semibold">Risk Levels</h4> <div class="space-y-1 text-xs opacity-80"><div class="flex items-center gap-2"><span class="h-2 w-2 rounded-full bg-green-500"></span> <span class="font-medium text-green-500">Low Risk</span></div> <div class="flex items-center gap-2"><span class="h-2 w-2 rounded-full bg-yellow-500"></span> <span class="font-medium text-yellow-500">Medium Risk</span></div> <div class="flex items-center gap-2"><span class="h-2 w-2 rounded-full bg-red-500"></span> <span class="font-medium text-red-500">High Risk</span></div></div></div></div></div> <!> <!> <!></div></div>');function qh(t,e){Me(e,!1);const n=H(),r=H(),a=H(),i=H(),s=H(),o=H(),c=H(),u=H(),d=H(),f=H(),h=H(),m=H(),A=H(),L=H(),y=H(),g=H(),x=H(),b=H(),C=H(),$=H();let N=te(e,"predictors",12),M=te(e,"cases",24,()=>[]),T=H(!1),S=H({icuDays:0,mortality:0,bloodLoss:0}),E=H(!1),w=0,P=H(!1),k=H({age:!0,height:!0,bmi:!0,asa:!0}),z=H(10),V=H(.3),I=H(1500);const q=160,it=80,G=q*2+it*2,pt=G;let B=H();function U(D){const nt=D/2.54,_t=Math.floor(nt/12),et=Math.round(nt%12);return{feet:_t,inches:et}}function j(D,nt){return Math.round((D*12+nt)*2.54)}const st={min:{feet:4,inches:5},max:{feet:7,inches:5}};let ct=H(0),yt=H(0),R=H(0),Q=H(0),kt=H({q1:0,q3:0}),at=H({q1:0,q3:0});const J={1:"#22c55e",2:"#a3e635",3:"#eab308",4:"#f97316",5:"#ef4444"};function lt(D){if(M().length===0)return{icuStay:0,mortality:0,bloodLoss:0};const nt=_a(M(),D);if(nt.length===0){const et=M().filter(ut=>ut.age!=null&&ut.bmi!=null&&ut.height!=null&&ut.asa!=null&&Math.abs(ut.age-D.age)<=15&&Math.abs(ut.bmi-D.bmi)<=10&&Math.abs(ut.asa-D.asa)<=1);if(et.length===0){const ut=pn(M());return{icuStay:ut.avgICUStay,mortality:ut.mortalityRate,bloodLoss:ut.avgBloodLoss}}const gt=pn(et);return{icuStay:gt.avgICUStay,mortality:gt.mortalityRate,bloodLoss:gt.avgBloodLoss}}const _t=pn(nt);return{icuStay:_t.avgICUStay,mortality:_t.mortalityRate,bloodLoss:_t.avgBloodLoss}}function dt(D){const nt=D.mortality*100,_t=D.icuStay/l(z)*100,et=D.bloodLoss/l(I)*100,gt=nt*.6+_t*.25+et*.15;return gt<20?{level:"Low",color:"text-green-600",triangleColor:"#10b981",triangleFill:"rgba(16, 185, 129, 0.15)"}:gt<50?{level:"Medium",color:"text-yellow-600",triangleColor:"#f59e0b",triangleFill:"rgba(245, 158, 11, 0.15)"}:{level:"High",color:"text-red-600",triangleColor:"#ef4444",triangleFill:"rgba(239, 68, 68, 0.15)"}}function tt(D){const nt=D/l(z);return nt<.2?{level:"Low",bgColor:"bg-green-500",textColor:"text-green-500",borderColor:"border-green-500"}:nt<.6?{level:"Medium",bgColor:"bg-yellow-500",textColor:"text-yellow-500",borderColor:"border-yellow-500"}:{level:"High",bgColor:"bg-red-500",textColor:"text-red-500",borderColor:"border-red-500"}}function Nt(D){return D<.05?{level:"Low",bgColor:"bg-green-500",textColor:"text-green-500",borderColor:"border-green-500"}:D<.15?{level:"Medium",bgColor:"bg-yellow-500",textColor:"text-yellow-500",borderColor:"border-yellow-500"}:{level:"High",bgColor:"bg-red-500",textColor:"text-red-500",borderColor:"border-red-500"}}function ht(D){const nt=D/l(I);return nt<.3?{level:"Low",bgColor:"bg-green-500",textColor:"text-green-500",borderColor:"border-green-500"}:nt<.7?{level:"Medium",bgColor:"bg-yellow-500",textColor:"text-yellow-500",borderColor:"border-yellow-500"}:{level:"High",bgColor:"bg-red-500",textColor:"text-red-500",borderColor:"border-red-500"}}function O(){W(l(B)).selectAll("*").remove();const D=W(l(B)).attr("width",G).attr("height",pt).append("g").attr("transform",`translate(${G/2},${pt/2})`).style("font-family","Inter, sans-serif"),nt=Z=>Math.PI*2/l($).length*Z-Math.PI/2,_t=Z=>({0:-Math.PI/2,1:Math.PI/6,2:5*Math.PI/6})[Z],et=(Z,mt)=>mt===0?0:Math.min(1,Math.max(0,Z/mt))*q;D.selectAll(".ring").data([.2,.4,.6,.8,1]).enter().append("circle").attr("class","ring").attr("r",Z=>Z*q).attr("fill","none").attr("stroke","#e5e7eb").attr("stroke-width",1).attr("stroke-dasharray",(Z,mt)=>mt===4?"none":"3 3"),D.append("text").attr("x",q+10).attr("y",-10).attr("text-anchor","start").attr("dominant-baseline","middle").attr("fill","#ffffff").attr("font-size",10).attr("font-weight","500").text(`Max: ${l(z).toFixed(0)}d`),D.append("text").attr("x",q+10).attr("y",5).attr("text-anchor","start").attr("dominant-baseline","middle").attr("fill","#ffffff").attr("font-size",10).attr("font-weight","500").text(`${(l(V)*100).toFixed(0)}%`),D.append("text").attr("x",q+10).attr("y",20).attr("text-anchor","start").attr("dominant-baseline","middle").attr("fill","#ffffff").attr("font-size",10).attr("font-weight","500").text(`${l(I).toFixed(0)}ml`),D.selectAll(".label-group").data(l($)).enter().append("g").attr("class","label-group").append("text").attr("x",(Z,mt)=>{const $t=nt(mt);return(q+35)*Math.cos($t)}).attr("y",(Z,mt)=>{const $t=nt(mt);return(q+35)*Math.sin($t)*-1}).attr("text-anchor","middle").attr("dominant-baseline","middle").attr("fill","#ffffff").attr("font-size",13).attr("font-weight","600").style("text-shadow","1px 1px 2px rgba(0,0,0,0.5)").text(Z=>Z.label);const bt=l($).map((Z,mt)=>{const $t=_t(mt),Wt=et(Z.value,Z.max),Vt=Math.min(q,Math.max(0,Wt));return{x:Vt*Math.cos($t),y:Vt*Math.sin($t)*-1,data:Z,index:mt,angle:$t,radius:Vt}}).filter(Z=>!isNaN(Z.x)&&!isNaN(Z.y)&&isFinite(Z.x)&&isFinite(Z.y));if(bt.length!==3){console.warn("Invalid triangle vertices detected, skipping chart rendering");return}const St=D.append("defs").append("filter").attr("id","glow").attr("x","-50%").attr("y","-50%").attr("width","200%").attr("height","200%");St.append("feGaussianBlur").attr("stdDeviation","3").attr("result","coloredBlur");const Lt=St.append("feMerge");if(Lt.append("feMergeNode").attr("in","coloredBlur"),Lt.append("feMergeNode").attr("in","SourceGraphic"),bt.length===3){const Z=`M ${bt[0].x} ${bt[0].y} 
								 L ${bt[1].x} ${bt[1].y} 
								 L ${bt[2].x} ${bt[2].y} Z`;D.append("path").attr("d",Z).attr("fill",l(g).triangleFill).attr("stroke","none").style("transition","all 0.3s ease"),[{from:0,to:1},{from:1,to:2},{from:2,to:0}].forEach(($t,Wt)=>{const Vt=bt[$t.from],_e=bt[$t.to];D.append("line").attr("class",`triangle-edge-${Wt}`).attr("x1",Vt.x).attr("y1",Vt.y).attr("x2",_e.x).attr("y2",_e.y).attr("stroke",l(g).triangleColor).attr("stroke-width",3).attr("stroke-linecap","round").style("filter","url(#glow)").style("transition","all 0.3s ease")})}W(l(B).parentElement).selectAll(".tooltip").remove();const Ut=W(l(B).parentElement).append("div").attr("class","tooltip fixed z-30 rounded bg-gray-900 px-2 py-1 text-xs text-white pointer-events-none").style("opacity","0").style("transition","opacity 0.2s ease");D.selectAll(".vertex-dot").data(bt).enter().append("circle").attr("class","vertex-dot").attr("cx",Z=>Z.x).attr("cy",Z=>Z.y).attr("r",8).attr("fill","#ffffff").attr("stroke",l(g).triangleColor).attr("stroke-width",4).style("filter","drop-shadow(0px 2px 6px rgba(37, 99, 235, 0.4))").style("cursor","pointer").on("mouseenter",function(Z,mt){Ut.style("opacity","1").html(`${mt.data.label}: ${mt.data.fmt(mt.data.value)}`),W(this).transition().duration(200).attr("r",10).attr("stroke-width",5)}).on("mousemove",function(Z,mt){Ut.style("left",Z.pageX+14+"px").style("top",Z.pageY-32+"px")}).on("mouseleave",function(){Ut.style("opacity","0"),W(this).transition().duration(200).attr("r",8).attr("stroke-width",4)}),D.selectAll(".vertex-inner-dot").data(bt).enter().append("circle").attr("class","vertex-inner-dot").attr("cx",Z=>Z.x).attr("cy",Z=>Z.y).attr("r",3).attr("fill",l(g).triangleColor).style("pointer-events","none")}Ee(()=>{l(B)&&O()}),ot(()=>Rt(M()),()=>{if(M().length>0){const D=M().map(et=>Number(et.icu_days)).filter(et=>!isNaN(et)&&et>0),nt=M().map(et=>Number(et.death_inhosp)).filter(et=>!isNaN(et)),_t=M().map(et=>Number(et.intraop_ebl)).filter(et=>!isNaN(et)&&et>0);if(D.length>0){const et=D.sort((gt,ut)=>gt-ut);F(z,Math.max(10,et[Math.floor(et.length*.95)]))}if(nt.length>0&&F(V,1),_t.length>0){const et=_t.sort((gt,ut)=>gt-ut);F(I,Math.max(1500,et[Math.floor(et.length*.95)]))}}}),ot(()=>{},()=>{F(n,{min:j(st.min.feet,st.min.inches),max:j(st.max.feet,st.max.inches)})}),ot(()=>Rt(M()),()=>{F(r,M().length>0?{min:Math.min(...M().map(D=>D.age)),max:Math.max(...M().map(D=>D.age))}:{min:0,max:0})}),ot(()=>Rt(M()),()=>{F(a,M().length>0?{min:Math.min(...M().map(D=>D.bmi)),max:Math.max(...M().map(D=>D.bmi))}:{min:0,max:0})}),ot(()=>Rt(M()),()=>{F(i,M().length>0?[...new Set(M().map(D=>D.asa))].sort():[])}),ot(()=>(Rt(M()),Rt(N()),pn),()=>{if(M().length>0){const D=_a(M(),N());if(F(Q,D.length),D.length>0){const nt=pn(D);F(ct,nt.avgICUStay),F(yt,nt.mortalityRate),F(R,nt.avgBloodLoss),F(kt,nt.icuIQR),F(at,nt.bloodLossIQR)}else F(ct,0),F(yt,0),F(R,0),F(kt,{q1:0,q3:0}),F(at,{q1:0,q3:0})}}),ot(()=>(Rt(N()),l(n)),()=>{F(s,(N().height-l(n).min)/(l(n).max-l(n).min))}),ot(()=>l(s),()=>{F(o,250+l(s)*150)}),ot(()=>(Rt(N()),l(a)),()=>{F(c,2+(N().bmi-l(a).min)/(l(a).max-l(a).min)*4)}),ot(()=>(Rt(N()),l(a)),()=>{F(u,(N().bmi-l(a).min)/(l(a).max-l(a).min))}),ot(()=>l(u),()=>{F(d,10+l(u)*25)}),ot(()=>l(o),()=>{F(f,l(o)*.2)}),ot(()=>(Rt(N()),l(r)),()=>{F(h,`rgb(${(N().age-l(r).min)/(l(r).max-l(r).min)*255}, ${(N().age-l(r).min)/(l(r).max-l(r).min)*255}, ${(N().age-l(r).min)/(l(r).max-l(r).min)*255})`)}),ot(()=>Rt(N()),()=>{F(m,J[N().asa]||J[1])}),ot(()=>l(k),()=>{F(A,Object.values(l(k)).filter(Boolean).length)}),ot(()=>l(A),()=>{F(L,l(A)===4?"all filters":`${l(A)} filter${l(A)===1?"":"s"}`)}),ot(()=>Rt(N()),()=>{F(y,lt(N()))}),ot(()=>l(y),()=>{F(g,dt(l(y)))}),ot(()=>l(y),()=>{F(x,tt(l(y).icuStay))}),ot(()=>l(y),()=>{F(b,Nt(l(y).mortality))}),ot(()=>l(y),()=>{F(C,ht(l(y).bloodLoss))}),ot(()=>(l(y),l(z),l(V),l(I)),()=>{F($,[{label:"ICU Stay (days)",key:"icu",value:Math.min(l(y).icuStay,l(z)),max:l(z),fmt:D=>D.toFixed(1)},{label:"Mortality Rate (%)",key:"mort",value:Math.min(l(y).mortality*100,l(V)*100),max:l(V)*100,fmt:D=>D.toFixed(1)+"%"},{label:"Blood Loss (mL)",key:"blood",value:Math.min(l(y).bloodLoss,l(I)),max:l(I),fmt:D=>Math.round(D).toLocaleString()}])}),ot(()=>(l(B),l($),l(z),l(V),l(I)),()=>{l(B)&&l($)&&l(z)&&l(V)&&l(I)&&O()}),We(),Xe();var ft=Bh(),Dt=v(ft),Ft=v(Dt),Ct=v(Ft),xt=v(Ct),Mt=_(v(xt),2),Bt=v(Mt),Ht=v(Bt);wt(Ht),At(2),p(Bt);var ee=_(Bt,2),qt=v(ee);wt(qt),At(2),p(ee);var Yt=_(ee,2),vt=v(Yt);wt(vt),At(2),p(Yt);var ne=_(Yt,2),me=v(ne);wt(me),At(2),p(ne),p(Mt),p(xt);var he=_(xt,2),It=v(he),Ot=v(It),ye=v(Ot);p(Ot);var pe=_(Ot,2);wt(pe);var jt=_(pe,2),re=v(jt);p(jt),p(It);var ve=_(It,2),xe=v(ve),be=v(xe);p(xe);var ge=_(xe,2);wt(ge);var Vn=_(ge,2),Ar=v(Vn);p(Vn),p(ve);var zt=_(ve,2),Xt=v(zt),Fe=v(Xt);p(Xt);var le=_(Xt,2);wt(le);var ce=_(le,2),Le=v(ce);p(ce),p(zt);var De=_(zt,2),Ge=v(De),je=v(Ge);p(Ge);var He=_(Ge,2);wt(He);var La=_(He,2),js=v(La);p(La),p(De),p(he),p(Ct),p(Ft);var Da=_(Ft,2);{var Hs=D=>{var nt=Nh(),_t=v(nt),et=_(v(_t),2),gt=v(et),ut=v(gt),bt=v(ut,!0);p(ut);var Pt=_(ut,2),St=_(v(Pt),2),Lt=v(St,!0);p(St),p(Pt),p(gt);var Ut=_(gt,2);{var Z=$t=>{var Wt=Rh();At(2),X($t,Wt)},mt=$t=>{var Wt=Th(),Vt=Ce(Wt),_e=v(Vt);p(Vt),At(2),Tt(()=>Y(_e,`Only ${l(Q)??""} cases match your current filters. The predictions may not be
								reliable.`)),X($t,Wt)};Et(Ut,$t=>{l(Q)===0?$t(Z):$t(mt,!1)})}p(et),p(_t),p(nt),Tt(()=>{Y(bt,l(Q)===0?"No Matching Cases Found":"Limited Data Available"),Kt(St,1,`text-base font-semibold ${l(g).color??""}`,"svelte-1ehvwb8"),Y(Lt,l(g).level)}),X(D,nt)},Os=(D,nt)=>{{var _t=gt=>{var ut=Eh(),bt=v(ut),Pt=_(v(bt),2),St=v(Pt),Lt=_(v(St),2),Ut=_(v(Lt),2),Z=v(Ut,!0);p(Ut),p(Lt),p(St);var mt=_(St,2),$t=v(mt);p(mt),p(Pt),p(bt),p(ut),Tt(()=>{Kt(Ut,1,`text-base font-semibold ${l(g).color??""}`,"svelte-1ehvwb8"),Y(Z,l(g).level),Y($t,`With ${l(Q)??""} matching cases, the predictions are reasonably reliable.`)}),X(gt,ut)},et=(gt,ut)=>{{var bt=Pt=>{var St=Ih(),Lt=v(St),Ut=_(v(Lt),2),Z=v(Ut),mt=_(v(Z),2),$t=_(v(mt),2),Wt=v($t,!0);p($t),p(mt),p(Z);var Vt=_(Z,2),_e=v(Vt);p(Vt),p(Ut),p(Lt),p(St),Tt(()=>{Kt($t,1,`text-base font-semibold ${l(g).color??""}`,"svelte-1ehvwb8"),Y(Wt,l(g).level),Y(_e,`Great! With ${l(Q)??""} matching cases, the predictions are highly reliable.`)}),X(Pt,St)};Et(gt,Pt=>{l(Q)>=50&&Pt(bt)},ut)}};Et(D,gt=>{l(Q)<50?gt(_t):gt(et,!1)},nt)}};Et(Da,D=>{l(Q)<10?D(Hs):D(Os,!1)})}var $r=_(Da,2),Cr=v($r),za=_(v(Cr),2),Sr=v(za),Yn=v(Sr),wn=_(Yn),Qe=_(wn),sn=_(Qe),on=_(sn),ln=_(on),cn=_(ln),Rr=_(cn);p(Sr),p(za),p(Cr);var Tr=_(Cr,2),Pa=_(v(Tr),2),Us=v(Pa);nn(Us,D=>F(B,D),()=>l(B)),p(Pa),p(Tr);var Ba=_(Tr,2),qa=_(v(Ba),2),ja=_(v(qa),2),Nr=v(ja),Vs=_(v(Nr));p(Nr);var Er=_(Nr,2),Ys=_(v(Er));p(Er);var Ha=_(Er,2),Xs=_(v(Ha));p(Ha),At(2),p(ja),p(qa),At(2),p(Ba),p($r);var Oa=_($r,2);{var Ws=D=>{var nt=Fh(),_t=v(nt),et=v(_t),gt=v(et),ut=_(gt,2),bt=_(v(ut),2),Pt=v(bt);p(bt),p(ut),p(et),p(_t);var St=_(_t,2),Lt=v(St),Ut=v(Lt),Z=_(Ut,2),mt=_(v(Z),2),$t=v(mt);p(mt),p(Z),p(Lt),p(St);var Wt=_(St,2),Vt=v(Wt),_e=v(Vt),Xn=_(_e,2),ze=_(v(Xn),2),Ke=v(ze);p(ze),p(Xn),p(Vt),p(Wt),p(nt),Tt((un,kn,Mn)=>{Kt(gt,1,`h-8 w-8 rounded-full ${l(x).bgColor??""} flex items-center justify-center`,"svelte-1ehvwb8"),Kt(bt,1,`text-xl font-bold ${l(x).textColor??""}`,"svelte-1ehvwb8"),Y(Pt,`${un??""} days`),Kt(Ut,1,`h-8 w-8 rounded-full ${l(b).bgColor??""} flex items-center justify-center`,"svelte-1ehvwb8"),Kt(mt,1,`text-xl font-bold ${l(b).textColor??""}`,"svelte-1ehvwb8"),Y($t,`${kn??""}%`),Kt(_e,1,`h-8 w-8 rounded-full ${l(C).bgColor??""} flex items-center justify-center`,"svelte-1ehvwb8"),Kt(ze,1,`text-xl font-bold ${l(C).textColor??""}`,"svelte-1ehvwb8"),Y(Ke,`${Mn??""} mL`)},[()=>l(y).icuStay.toFixed(1),()=>(l(y).mortality*100).toFixed(1),()=>Math.round(l(y).bloodLoss)],Re),X(D,nt)};Et(Oa,D=>{l(Q)!=0&&D(Ws)})}var Ua=_(Oa,2);{var Gs=D=>{var nt=Lh(),_t=_(v(nt),2),et=v(_t),gt=_(v(et),2);wt(gt),p(et);var ut=_(et,2),bt=_(v(ut),2);wt(bt),p(ut);var Pt=_(ut,2),St=_(v(Pt),2);wt(St),p(Pt),p(_t),p(nt),se(gt,()=>l(S).icuDays,Lt=>Zt(S,l(S).icuDays=Lt)),se(bt,()=>l(S).mortality,Lt=>Zt(S,l(S).mortality=Lt)),se(St,()=>l(S).bloodLoss,Lt=>Zt(S,l(S).bloodLoss=Lt)),X(D,nt)};Et(Ua,D=>{l(T)&&D(Gs)})}var Qs=_(Ua,2);{var Ks=D=>{var nt=Ph(),_t=_(Ce(nt),2),et=v(_t),gt=_(v(et),2),ut=v(gt);p(gt);var bt=_(gt,2),Pt=v(bt);p(bt),p(et);var St=_(et,2),Lt=_(v(St),4),Ut=v(Lt);p(Lt),p(St);var Z=_(St,2),mt=_(v(Z),2),$t=v(mt);p(mt);var Wt=_(mt,2),Vt=v(Wt);p(Wt),p(Z),p(_t);var _e=_(_t,2);{var Xn=ze=>{var Ke=zh(),un=v(Ke),kn=_(un);{var Mn=Ze=>{var Ir=Dh();X(Ze,Ir)};Et(kn,Ze=>{Ze(Mn)})}p(Ke),Tt(Ze=>Y(un,`Your guess was ${Ze??""}% accurate! `),[()=>(w*100).toFixed(1)],Re),X(ze,Ke)};Et(_e,ze=>{l(T)&&l(E)&&ze(Xn)})}Tt((ze,Ke,un,kn,Mn,Ze,Ir)=>{Y(ut,`${ze??""} days`),Y(Pt,`IQR: ${Ke??""} - ${un??""} days`),Y(Ut,`${kn??""}%`),Y($t,`${Mn??""} mL`),Y(Vt,`IQR: ${Ze??""} - ${Ir??""} mL`)},[()=>l(ct).toFixed(1),()=>l(kt).q1.toFixed(1),()=>l(kt).q3.toFixed(1),()=>(l(yt)*100).toFixed(1),()=>l(R).toFixed(0),()=>l(at).q1.toFixed(0),()=>l(at).q3.toFixed(0)],Re),X(D,nt)};Et(Qs,D=>{(!l(T)||l(E))&&l(P)&&D(Ks)})}p(Dt),p(ft),Tt((D,nt,_t,et,gt,ut,bt,Pt,St)=>{Kt(It,1,Gn(l(k).age?"control-item":"control-item opacity-50"),"svelte-1ehvwb8"),Y(ye,`Age: ${N().age??""} years`),rt(pe,"min",l(r).min),rt(pe,"max",l(r).max),pe.disabled=!l(k).age,Y(re,`Range: ${l(r).min??""} - ${l(r).max??""} years`),Kt(ve,1,Gn(l(k).height?"control-item":"control-item opacity-50"),"svelte-1ehvwb8"),Y(be,`Height: ${D??""}' ${nt??""}"`),rt(ge,"min",l(n).min),rt(ge,"max",l(n).max),ge.disabled=!l(k).height,Y(Ar,`Range: ${st.min.feet}'${st.min.inches}" - ${st.max.feet}'${st.max.inches}"`),Kt(zt,1,Gn(l(k).bmi?"control-item":"control-item opacity-50"),"svelte-1ehvwb8"),Y(Fe,`BMI: ${N().bmi??""}`),rt(le,"min",l(a).min),rt(le,"max",l(a).max),le.disabled=!l(k).bmi,Y(Le,`Range: ${_t??""} - ${et??""}`),Kt(De,1,Gn(l(k).asa?"control-item":"control-item opacity-50"),"svelte-1ehvwb8"),Y(je,`ASA Score: ${N().asa??""}`),He.disabled=!l(k).asa,Y(js,`ASA ${N().asa??""}: ${N().asa===1?"Healthy patient":N().asa===2?"Mild systemic disease":N().asa===3?"Severe systemic disease":N().asa===4?"Severe systemic disease that is a constant threat to life":"Moribund patient not expected to survive without the operation"}`),rt(Sr,"viewBox",`0 0 200 ${l(o)??""}`),rt(Yn,"fill",l(m)),rt(Yn,"stroke-width",l(c)),rt(Yn,"opacity",l(k).asa?1:.5),rt(wn,"y2",l(o)*.6),rt(wn,"stroke",l(m)),rt(wn,"stroke-width",l(c)),rt(wn,"opacity",l(k).asa?1:.5),rt(Qe,"cy",l(o)*.45),rt(Qe,"rx",l(d)),rt(Qe,"ry",l(f)),rt(Qe,"fill",l(m)),rt(Qe,"stroke-width",l(c)),rt(Qe,"opacity",l(k).bmi?1:.5),rt(sn,"x2",gt),rt(sn,"y2",l(o)*.4),rt(sn,"stroke",l(m)),rt(sn,"stroke-width",l(c)),rt(sn,"opacity",l(k).asa?1:.5),rt(on,"x2",ut),rt(on,"y2",l(o)*.4),rt(on,"stroke",l(m)),rt(on,"stroke-width",l(c)),rt(on,"opacity",l(k).asa?1:.5),rt(ln,"y1",l(o)*.6),rt(ln,"y2",l(o)*.9),rt(ln,"stroke",l(m)),rt(ln,"stroke-width",l(c)),rt(ln,"opacity",l(k).asa?1:.5),rt(cn,"y1",l(o)*.6),rt(cn,"y2",l(o)*.9),rt(cn,"stroke",l(m)),rt(cn,"stroke-width",l(c)),rt(cn,"opacity",l(k).asa?1:.5),rt(Rr,"stroke",l(h)),rt(Rr,"stroke-width",l(c)*1.5),rt(Rr,"opacity",l(k).age?1:.5),Y(Vs,` 0 - ${bt??""} days`),Y(Ys,` 0 - ${Pt??""}%`),Y(Xs,` 0 - ${St??""} mL`)},[()=>U(N().height).feet,()=>U(N().height).inches,()=>l(a).min.toFixed(1),()=>l(a).max.toFixed(1),()=>60-Math.max(0,l(d)-20),()=>140+Math.max(0,l(d)-20),()=>l(z).toFixed(1),()=>(l(V)*100).toFixed(0),()=>l(I).toLocaleString()],Re),fe(Ht,()=>l(k).age,D=>Zt(k,l(k).age=D)),fe(qt,()=>l(k).height,D=>Zt(k,l(k).height=D)),fe(vt,()=>l(k).bmi,D=>Zt(k,l(k).bmi=D)),fe(me,()=>l(k).asa,D=>Zt(k,l(k).asa=D)),se(pe,()=>N().age,D=>N(N().age=D,!0)),se(ge,()=>N().height,D=>N(N().height=D,!0)),se(le,()=>N().bmi,D=>N(N().bmi=D,!0)),se(He,()=>N().asa,D=>N(N().asa=D,!0)),X(t,ft),Ae()}var jh=K(`<h2>Interactive Risk Builder</h2> <p class="mb-4">Now it's your turn. Build a patient profile using the sliders below. Watch how tiny shifts—a
	single ASA notch or clicking 'Emergency'—can triple the mortality risk instantly. We'll show you
	how many similar historical cases we found, so you can trust the predictions. <br/> <br/> Once you are finished with your patient profile, you can move to the next slide to make your predictions</p> <!>`,1);function Hh(t,e){let n=ue(Rn({age:60,bmi:25,asa:2,emergency:0,height:170}));var r=jh(),a=_(Ce(r),4);qh(a,{get cases(){return e.cases},get predictors(){return l(n)},set predictors(i){F(n,i,!0)}}),X(t,r)}var Oh=K('<div class="typing-line svelte-1lomvqb"><span> </span></div>'),Uh=K('<div class="fixed inset-0 h-screen w-screen svelte-1lomvqb"><div class="text-text-primary mx-auto max-w-5xl px-4 text-center text-4xl font-semibold md:text-5xl svelte-1lomvqb"><div class="typing-container svelte-1lomvqb"><div class="typing-wrapper svelte-1lomvqb"></div></div></div></div>');function Di(t,e){var n=Uh(),r=v(n),a=v(r),i=v(a);zn(i,21,()=>e.lines,Dn,(s,o,c)=>{var u=Oh(),d=v(u);Kt(d,1,"typing-text svelte-1lomvqb",null,{},{"first-line":c===0,"second-line":c===1}),Gi(d,`--delay: ${c*1.5}s`);var f=v(d,!0);p(d),p(u),Tt(()=>Y(f,l(o))),X(s,u)}),p(i),p(a),p(r),p(n),X(t,n)}var Vh=K('<button class="mt-4 rounded bg-blue-500 px-4 py-2 text-white hover:bg-blue-600 disabled:cursor-not-allowed disabled:opacity-50"><!></button>'),Yh=K(`<p class="mt-2 text-red-600">Your predictions were quite far from the actual outcomes. Consider reviewing the
							patient's risk factors more carefully.</p>`),Xh=K(`<p class="mt-2 text-orange-600">Your predictions were somewhat off. Try to consider how different factors might
							interact to affect outcomes.</p>`),Wh=K(`<p class="mt-2 text-yellow-600">Good predictions! You're getting better at understanding how patient characteristics
							influence outcomes.</p>`),Gh=K(`<p class="mt-2 text-green-600">Excellent predictions! You have a strong understanding of how patient factors
							correlate with surgical outcomes.</p>`),Qh=K('<button class="mt-4 rounded bg-blue-500 px-4 py-2 text-white hover:bg-blue-600">Next Question</button>'),Kh=K('<div class="mt-4 space-y-4"><div class="rounded bg-green-50 p-4 text-center"><h3 class="text-lg font-semibold text-green-800">Quiz Complete!</h3> <p class="mt-2 text-green-700"> </p></div> <button class="w-full rounded bg-blue-500 px-4 py-2 text-white hover:bg-blue-600">Try Again</button></div>'),Zh=K('<div class="mt-6 space-y-4"><h3 class="text-lg font-semibold text-gray-900">Actual Outcomes from Similar Cases</h3> <div class="grid grid-cols-3 gap-4"><div><p class="text-sm text-gray-600">Average ICU Stay</p> <p class="font-medium text-gray-900"> </p> <p class="text-xs text-gray-600"> </p></div> <div><p class="text-sm text-gray-600">Mortality Rate</p> <div class="h-2 w-full rounded-full" style="background: linear-gradient(to right, #22c55e, #ef4444)"></div> <p class="font-medium text-gray-900"> </p></div> <div><p class="text-sm text-gray-600">Average Blood Loss</p> <p class="font-medium text-gray-900"> </p> <p class="text-xs text-gray-600"> </p></div></div> <div class="mt-4 rounded bg-yellow-50 p-3 text-sm text-yellow-800"> <!></div> <!></div>'),Jh=K(`<div class="space-y-6 rounded-lg bg-gray-50 p-4"><h2 class="text-2xl font-bold">Test Your Knowledge</h2> <p class="text-gray-600">Based on the patient profile below, predict their likely outcomes. Consider factors like age,
		BMI, ASA score, and height when making your predictions.</p> <div class="flex items-center justify-between text-sm text-gray-600"><span> </span> <span> </span></div> <div class="mt-4 rounded-lg bg-white p-4 shadow-sm"><h3 class="mb-2 text-lg font-semibold text-gray-900">Patient Profile</h3> <p class="mb-4 text-gray-700"> </p> <div class="grid grid-cols-1 gap-4 md:grid-cols-3"><div><p class="text-sm text-gray-600">Age</p> <p class="font-medium text-gray-900"> </p></div> <div><p class="text-sm text-gray-600">Height</p> <p class="font-medium text-gray-900"> </p></div> <div><p class="text-sm text-gray-600">BMI</p> <p class="font-medium text-gray-900"> </p></div> <div><p class="text-sm text-gray-600">ASA Score</p> <p class="font-medium text-gray-900"> </p></div></div></div> <div class="mt-6 space-y-4"><div class="grid gap-4"><div><label class="block text-sm text-gray-600">Predicted ICU Stay (days)</label> <input type="number" min="0" step="0.1" class="mt-1 w-full rounded border p-2 text-gray-900"/></div> <div><label class="block text-sm text-gray-600">Predicted Mortality (%)</label> <input type="number" min="0" max="100" step="0.1" class="mt-1 w-full rounded border p-2 text-gray-900"/></div> <div><label class="block text-sm text-gray-600">Predicted Blood Loss (mL)</label> <input type="number" min="0" step="1" class="mt-1 w-full rounded border p-2 text-gray-900"/></div></div> <!></div></div>`);function tp(t,e){Me(e,!0);function n(Ct){const xt=Ct/2.54,Mt=Math.floor(xt/12),Bt=Math.round(xt%12);return{feet:Mt,inches:Bt}}const r=[{age:45,bmi:22,asa:1,height:175,description:"A healthy middle-aged patient with normal BMI"},{age:75,bmi:32,asa:3,height:165,description:"An elderly patient with obesity and severe systemic disease"},{age:60,bmi:28,asa:2,height:170,description:"A patient with mild systemic disease and slightly elevated BMI"}];let a=ue(0),i=ue(!1),s=ue(0),o=ue(0),c=ue(0),u=!1,d=ue(Rn({icuDays:0,mortality:0,bloodLoss:0})),f=ue(0),h=ue(0),m=ue(0),A=ue(Rn({q1:0,q3:0})),L=ue(Rn({q1:0,q3:0})),y=ue(0),g=Rn(new Map);function x(){if(l(i))return;const Ct=r[l(a)],xt=_a(e.cases,Ct);F(y,xt.length,!0);const Mt=pn(xt);F(f,Mt.avgICUStay,!0),F(h,Mt.mortalityRate,!0),F(m,Mt.avgBloodLoss,!0),F(A,Mt.icuIQR,!0),F(L,Mt.bloodLossIQR,!0);const Bt=ta(l(d).icuDays,Mt.avgICUStay,Mt.icuValues),Ht=ta(l(d).mortality,Mt.mortalityRate*100,xt.map(qt=>(qt.death_inhosp??0)*100)),ee=ta(l(d).bloodLoss,Mt.avgBloodLoss,Mt.bloodLossValues);F(s,Bt*.4+Ht*.3+ee*.3),F(o,l(o)+l(s)),sr(c),F(i,!0)}function b(){l(a)<r.length-1&&(sr(a),F(i,!1),F(d,{icuDays:0,mortality:0,bloodLoss:0},!0))}function C(){F(a,0),F(i,!1),F(o,0),F(c,0),F(d,{icuDays:0,mortality:0,bloodLoss:0},!0),g.clear()}let $=Fn(()=>r[l(a)]),N=Fn(()=>l(a)===r.length-1),M=Fn(()=>l(c)>0?l(o)/l(c)*100:0);var T=Jh(),S=_(v(T),4),E=v(S),w=v(E);p(E);var P=_(E,2),k=v(P);p(P),p(S);var z=_(S,2),V=_(v(z),2),I=v(V,!0);p(V);var q=_(V,2),it=v(q),G=_(v(it),2),pt=v(G);p(G),p(it);var B=_(it,2),U=_(v(B),2),j=v(U);p(U),p(B);var st=_(B,2),ct=_(v(st),2),yt=v(ct,!0);p(ct),p(st);var R=_(st,2),Q=_(v(R),2),kt=v(Q,!0);p(Q),p(R),p(q),p(z);var at=_(z,2),J=v(at),lt=v(J),dt=_(v(lt),2);wt(dt),p(lt);var tt=_(lt,2),Nt=_(v(tt),2);wt(Nt),p(tt);var ht=_(tt,2),O=_(v(ht),2);wt(O),p(ht),p(J);var ft=_(J,2);{var Dt=Ct=>{var xt=Vh(),Mt=v(xt);{var Bt=Ht=>{var ee=Zs("Check Your Predictions");X(Ht,ee)};Et(Mt,Ht=>{Ht(Bt,!1)})}p(xt),Tt(()=>xt.disabled=u),Ve("click",xt,x),X(Ct,xt)},Ft=Ct=>{var xt=Zh(),Mt=_(v(xt),2),Bt=v(Mt),Ht=_(v(Bt),2),ee=v(Ht);p(Ht);var qt=_(Ht,2),Yt=v(qt);p(qt),p(Bt);var vt=_(Bt,2),ne=_(v(vt),4),me=v(ne);p(ne),p(vt);var he=_(vt,2),It=_(v(he),2),Ot=v(It);p(It);var ye=_(It,2),pe=v(ye);p(ye),p(he),p(Mt);var jt=_(Mt,2),re=v(jt),ve=_(re);{var xe=zt=>{var Xt=Yh();X(zt,Xt)},be=(zt,Xt)=>{{var Fe=ce=>{var Le=Xh();X(ce,Le)},le=(ce,Le)=>{{var De=je=>{var He=Wh();X(je,He)},Ge=je=>{var He=Gh();X(je,He)};Et(ce,je=>{l(s)<=.75?je(De):je(Ge,!1)},Le)}};Et(zt,ce=>{l(s)<=.5?ce(Fe):ce(le,!1)},Xt)}};Et(ve,zt=>{l(s)<=.25?zt(xe):zt(be,!1)})}p(jt);var ge=_(jt,2);{var Vn=zt=>{var Xt=Qh();Ve("click",Xt,b),X(zt,Xt)},Ar=zt=>{var Xt=Kh(),Fe=v(Xt),le=_(v(Fe),2),ce=v(le);p(le),p(Fe);var Le=_(Fe,2);p(Xt),Tt(De=>Y(ce,`Your final average score: ${De??""}%`),[()=>l(M).toFixed(1)]),Ve("click",Le,C),X(zt,Xt)};Et(ge,zt=>{l(N)?zt(Ar,!1):zt(Vn)})}p(xt),Tt((zt,Xt,Fe,le,ce,Le,De,Ge)=>{Y(ee,`${zt??""} days`),Y(Yt,`IQR: ${Xt??""} - ${Fe??""} days`),Y(me,`${le??""}%`),Y(Ot,`${ce??""} mL`),Y(pe,`IQR: ${Le??""} - ${De??""} mL`),Y(re,`Your guess was ${Ge??""}% accurate! `)},[()=>l(f).toFixed(1),()=>l(A).q1.toFixed(1),()=>l(A).q3.toFixed(1),()=>(l(h)*100).toFixed(1),()=>l(m).toFixed(0),()=>l(L).q1.toFixed(0),()=>l(L).q3.toFixed(0),()=>(l(s)*100).toFixed(1)]),X(Ct,xt)};Et(ft,Ct=>{l(i)?Ct(Ft,!1):Ct(Dt)})}p(at),p(T),Tt((Ct,xt,Mt)=>{Y(w,`Question ${l(a)+1} of ${r.length??""}`),Y(k,`Average Score: ${Ct??""}%`),Y(I,l($).description),Y(pt,`${l($).age??""} years`),Y(j,`${xt??""}' ${Mt??""}"`),Y(yt,l($).bmi),Y(kt,l($).asa)},[()=>l(M).toFixed(1),()=>n(l($).height).feet,()=>n(l($).height).inches]),se(dt,()=>l(d).icuDays,Ct=>l(d).icuDays=Ct),se(Nt,()=>l(d).mortality,Ct=>l(d).mortality=Ct),se(O,()=>l(d).bloodLoss,Ct=>l(d).bloodLoss=Ct),X(t,T),Ae()}var ep=K('<div class="insights svelte-8j7us"><h4 class="svelte-8j7us">🔍 Key Clinical Insights</h4> <div class="insights-grid svelte-8j7us"><div class="insight-card svelte-8j7us"><strong class="svelte-8j7us">Baseline Risk</strong> <span class="svelte-8j7us"> </span> <small class="svelte-8j7us">Low-risk patients</small></div> <div class="insight-card svelte-8j7us"><strong class="svelte-8j7us">Top Risk Factor</strong> <span class="svelte-8j7us"> </span> <small class="svelte-8j7us"> </small></div> <div class="insight-card svelte-8j7us"><strong class="svelte-8j7us">Maximum Risk</strong> <span class="svelte-8j7us"> </span> <small class="svelte-8j7us">All factors combined</small></div> <div class="insight-card svelte-8j7us"><strong class="svelte-8j7us">Data Source</strong> <span class="svelte-8j7us"> </span> <small class="svelte-8j7us">VitalDB surgical cases</small></div></div></div>'),np=K('<div class="controls-panel svelte-8j7us"><div class="controls-content svelte-8j7us"><h3 class="svelte-8j7us">🎯 Interactive Risk Calculator</h3> <p class="subtitle svelte-8j7us">Toggle risk factors to see how they combine and affect patient mortality</p> <div class="controls-grid svelte-8j7us"><label class="control-item major svelte-8j7us"><input type="checkbox" class="svelte-8j7us"/> <span class="factor-name svelte-8j7us">ASA ≥ 3</span> <span class="factor-impact svelte-8j7us">High Impact</span></label> <label class="control-item major svelte-8j7us"><input type="checkbox" class="svelte-8j7us"/> <span class="factor-name svelte-8j7us">Emergency</span> <span class="factor-impact svelte-8j7us">High Impact</span></label> <label class="control-item major svelte-8j7us"><input type="checkbox" class="svelte-8j7us"/> <span class="factor-name svelte-8j7us">Low Albumin</span> <span class="factor-impact svelte-8j7us">High Impact</span></label> <label class="control-item minor svelte-8j7us"><input type="checkbox" class="svelte-8j7us"/> <span class="factor-name svelte-8j7us">Age > 65</span> <span class="factor-impact svelte-8j7us">Minor Impact</span></label> <label class="control-item minor svelte-8j7us"><input type="checkbox" class="svelte-8j7us"/> <span class="factor-name svelte-8j7us">BMI > 30</span> <span class="factor-impact svelte-8j7us">Minor Impact</span></label> <label class="control-item minor svelte-8j7us"><input type="checkbox" class="svelte-8j7us"/> <span class="factor-name svelte-8j7us">Long Surgery</span> <span class="factor-impact svelte-8j7us">Minor Impact</span></label></div> <div class="current-risk svelte-8j7us"><span class="risk-label svelte-8j7us">Current Patient Risk:</span> <span class="risk-value svelte-8j7us"> </span></div> <div class="toggle-section svelte-8j7us"><label class="toggle-item svelte-8j7us"><input type="checkbox" class="svelte-8j7us"/> Show minor risk factors in chart</label></div></div></div> <div class="debug-panel svelte-8j7us"><h4 class="svelte-8j7us">📊 Data Analysis</h4> <div class="debug-stats svelte-8j7us"><span class="svelte-8j7us"><strong class="svelte-8j7us">Total Cases:</strong> </span> <span class="svelte-8j7us"><strong class="svelte-8j7us">Valid Cases:</strong> </span> <span class="svelte-8j7us"><strong class="svelte-8j7us">Active Factors:</strong> </span></div></div> <div class="chart-wrapper svelte-8j7us"><svg class="chart svelte-8j7us"></svg></div> <!>',1),rp=K('<div class="loading svelte-8j7us"><div class="loading-spinner svelte-8j7us"></div> <p class="svelte-8j7us">Loading surgical data...</p></div>'),ap=K('<div class="container svelte-8j7us"><!></div>');function ip(t,e){Me(e,!1);let n=te(e,"cases",24,()=>[]),r=H(),a=H([]),i=H(0),s=H(0),o=H({asa_high:!1,emergency:!1,low_albumin:!1,old_age:!1,obesity:!1,long_surgery:!1}),c=H(!0);function u(){if(!n()||n().length===0)return;console.log("=== WATERFALL GRAPH DEBUG ==="),console.log("Total cases:",n().length),console.log("Sample case:",n()[0]);const g=n().filter(M=>typeof M.death_inhosp=="number"&&typeof M.asa=="number"&&typeof M.emop=="number"&&typeof M.age=="number");if(F(i,n().length),F(s,g.length),console.log("Clean cases:",g.length),g.length===0){console.error("No valid cases found!");return}const x=g.filter(M=>M.asa<=2&&M.emop===0&&M.age<65),b=x.length>0?x.filter(M=>M.death_inhosp===1).length/x.length*100:2;console.log(`Baseline: ${x.length} cases, ${b.toFixed(1)}% mortality`);const N=[{name:"ASA ≥ 3",key:"asa_high",filter:M=>M.asa>=3,color:"#ef4444"},{name:"Emergency",key:"emergency",filter:M=>M.emop===1,color:"#f97316"},{name:"Low Albumin",key:"low_albumin",filter:M=>M.preop_alb&&M.preop_alb<3.5,color:"#eab308"},{name:"Age > 65",key:"old_age",filter:M=>M.age>65,color:"#64748b"},{name:"BMI > 30",key:"obesity",filter:M=>M.bmi&&M.bmi>30,color:"#6b7280"},{name:"Long Surgery",key:"long_surgery",filter:M=>M.anestart&&M.opstart&&(M.opstart-M.anestart)/60>120,color:"#71717a"}].map(M=>{const T=g.filter(M.filter),S=g.filter(k=>!M.filter(k));if(T.length===0||S.length===0)return{...M,contribution:0,withCount:T.length,withoutCount:S.length,riskWith:0,riskWithout:0};const E=T.filter(k=>k.death_inhosp===1).length/T.length*100,w=S.filter(k=>k.death_inhosp===1).length/S.length*100,P=Math.max(0,E-w);return console.log(`${M.name}: ${T.length} cases, ${E.toFixed(1)}% vs ${w.toFixed(1)}% = +${P.toFixed(1)}%`),{...M,contribution:P,withCount:T.length,withoutCount:S.length,riskWith:E,riskWithout:w}}).sort((M,T)=>T.contribution-M.contribution);F(a,[{name:"Baseline",key:"baseline",value:b,cumulative:b,type:"baseline",color:"#475569",description:`Low-risk patients (ASA≤2, elective, age<65): ${x.length} cases`}]),N.forEach((M,T)=>{M.contribution>0&&l(a).push({name:M.name,key:M.key,value:M.contribution,cumulative:0,type:T<3?"major":"minor",color:M.color,description:`${M.withCount} cases with factor, adds +${M.contribution.toFixed(1)}% risk`})}),l(a).push({name:"Total Risk",key:"total",value:0,cumulative:0,type:"total",color:"#1e40af",description:"Combined mortality risk based on selected factors"}),console.log("Final risk factors:",l(a)),d()}function d(){if(l(a).length===0)return;let g=l(a)[0].value;for(let b=1;b<l(a).length-1;b++){const C=l(a)[b],$=l(o)[C.key];C.cumulative=g,$&&(g+=C.value)}const x=l(a).length-1;Zt(a,l(a)[x].value=g),Zt(a,l(a)[x].cumulative=g)}function f(){if(l(a).length===0)return 0;let g=l(a)[0].value;for(let x=1;x<l(a).length-1;x++){const b=l(a)[x];l(o)[b.key]&&(g+=b.value)}return g}function h(){if(!l(r)||l(a).length===0)return;W(l(r)).selectAll("*").remove();const g={top:50,right:80,bottom:60,left:120},x=Math.min(800,window.innerWidth-g.left-g.right-40),b=Math.min(400,window.innerHeight*.6),C=l(a).filter(w=>w.type==="baseline"||w.type==="total"?!0:!l(c)&&w.type==="minor"?!1:w.key&&w.key!=="baseline"&&w.key!=="total"?l(o)[w.key]:!0),$=Math.max(...l(a).map(w=>w.type==="total"?w.value:w.cumulative+w.value)),N=Ye().domain([0,$*1.1]).range([0,x]),M=_r().domain(C.map(w=>w.name)).range([0,b]).padding(.3),T=W(l(r)).attr("viewBox",`0 0 ${x+g.left+g.right} ${b+g.top+g.bottom}`).append("g").attr("transform",`translate(${g.left},${g.top})`),S=W("body").selectAll(".waterfall-tooltip").data([0]).enter().append("div").attr("class","waterfall-tooltip").style("opacity",0).style("position","absolute").style("background-color","rgba(15, 23, 42, 0.95)").style("color","white").style("border","1px solid #334155").style("border-radius","8px").style("padding","12px").style("pointer-events","none").style("font-size","13px").style("box-shadow","0 4px 12px rgba(0,0,0,0.3)").style("z-index","1000"),E=T.selectAll(".bar").data(C).enter().append("g").attr("class","bar");E.append("rect").attr("x",w=>w.type==="baseline"||w.type==="total"?0:N(w.cumulative)).attr("y",w=>M(w.name)).attr("width",0).attr("height",M.bandwidth()).attr("fill",w=>w.color).attr("stroke","#1e293b").attr("stroke-width",2).attr("rx",4).style("cursor","pointer").transition().duration(800).delay((w,P)=>P*100).attr("width",w=>N(w.value)).on("end",function(){W(this.parentNode).select("text").transition().duration(200).attr("opacity",1)}),E.append("text").attr("x",w=>(w.type==="baseline"||w.type==="total"?0:N(w.cumulative))+N(w.value)/2).attr("y",w=>M(w.name)+M.bandwidth()/2).attr("dy","0.35em").attr("text-anchor","middle").attr("fill","#ffffff").attr("opacity",0).style("font-weight","600").style("font-size","12px").style("text-shadow","0 1px 2px rgba(0,0,0,0.3)").text(w=>`${w.value.toFixed(1)}%`),E.on("mouseover",function(w,P){W(this).select("rect").transition().duration(200).attr("opacity",.8),S.transition().duration(200).style("opacity",1),S.html(`
				<div style="font-weight: bold; margin-bottom: 6px; color: #f1f5f9;">${P.name}</div>
				<div style="margin-bottom: 4px;">${P.description}</div>
				<div style="font-weight: bold; color: #60a5fa;">Risk: +${P.value.toFixed(1)}%</div>
			`).style("left",w.pageX+10+"px").style("top",w.pageY-28+"px")}).on("mouseout",function(){W(this).select("rect").transition().duration(200).attr("opacity",1),S.transition().duration(300).style("opacity",0)});for(let w=1;w<C.length-1;w++){const P=C[w],k=C[w+1];P.type!=="total"&&k.type!=="total"&&T.append("line").attr("x1",N(P.cumulative+P.value)).attr("y1",M(P.name)+M.bandwidth()).attr("x2",N(k.cumulative)).attr("y2",M(k.name)).attr("stroke","#475569").attr("stroke-width",1.5).attr("stroke-dasharray","4,4").attr("opacity",0).transition().duration(1e3).delay(800).attr("opacity",.6)}T.append("g").attr("transform",`translate(0,${b})`).call(Un(N).tickFormat(w=>`${w}%`)).style("color","#ffffff"),T.append("g").call(wr(M)).style("color","#ffffff"),T.append("text").attr("x",x/2).attr("y",-35).attr("text-anchor","middle").style("font-size","18px").style("font-weight","bold").style("fill","#ffffff").style("dominant-baseline","text-before-edge").text("Interactive Risk Calculator - Real Data"),T.append("text").attr("x",x/2).attr("y",b+45).attr("text-anchor","middle").style("font-size","14px").style("fill","#ffffff").text("Mortality Risk (%)"),T.append("g").attr("class","grid").selectAll("line").data(N.ticks()).enter().append("line").attr("x1",w=>N(w)).attr("x2",w=>N(w)).attr("y1",0).attr("y2",b).attr("stroke","#334155").attr("stroke-width",1).attr("stroke-dasharray","4,4").attr("opacity",.3)}Ee(()=>(n()&&n().length>0&&u(),()=>{W("body").selectAll(".waterfall-tooltip").remove()})),ot(()=>Rt(n()),()=>{n()&&n().length>0&&u()}),ot(()=>(l(r),l(a)),()=>{l(r)&&l(a).length>0&&(d(),h())}),ot(()=>(l(o),l(c),l(a)),()=>{(l(o)||l(c))&&l(a).length>0&&(d(),h())}),We(),Xe();var m=ap(),A=v(m);{var L=g=>{var x=np(),b=Ce(x),C=v(b),$=_(v(C),4),N=v($),M=v(N);wt(M),At(4),p(N);var T=_(N,2),S=v(T);wt(S),At(4),p(T);var E=_(T,2),w=v(E);wt(w),At(4),p(E);var P=_(E,2),k=v(P);wt(k),At(4),p(P);var z=_(P,2),V=v(z);wt(V),At(4),p(z);var I=_(z,2),q=v(I);wt(q),At(4),p(I),p($);var it=_($,2),G=_(v(it),2),pt=v(G);p(G),p(it);var B=_(it,2),U=v(B),j=v(U);wt(j),At(),p(U),p(B),p(C),p(b);var st=_(b,2),ct=_(v(st),2),yt=v(ct),R=_(v(yt));p(yt);var Q=_(yt,2),kt=_(v(Q));p(Q);var at=_(Q,2),J=_(v(at));p(at),p(ct),p(st);var lt=_(st,2),dt=v(lt);nn(dt,ht=>F(r,ht),()=>l(r)),p(lt);var tt=_(lt,2);{var Nt=ht=>{var O=ep(),ft=_(v(O),2),Dt=v(ft),Ft=_(v(Dt),2),Ct=v(Ft);p(Ft),At(2),p(Dt);var xt=_(Dt,2),Mt=_(v(xt),2),Bt=v(Mt,!0);p(Mt);var Ht=_(Mt,2),ee=v(Ht);p(Ht),p(xt);var qt=_(xt,2),Yt=_(v(qt),2),vt=v(Yt);p(Yt),At(2),p(qt);var ne=_(qt,2),me=_(v(ne),2),he=v(me,!0);p(me),At(2),p(ne),p(ft),p(O),Tt((It,Ot,ye,pe)=>{var jt;Y(Ct,`${It??""}%`),Y(Bt,(jt=l(a)[1])==null?void 0:jt.name),Y(ee,`+${Ot??""}% mortality`),Y(vt,`${ye??""}%`),Y(he,pe)},[()=>{var It;return(It=l(a)[0])==null?void 0:It.value.toFixed(1)},()=>{var It;return(It=l(a)[1])==null?void 0:It.value.toFixed(1)},()=>{var It;return(It=l(a)[l(a).length-1])==null?void 0:It.value.toFixed(1)},()=>l(s).toLocaleString()],Re),X(ht,O)};Et(tt,ht=>{l(a).length>3&&ht(Nt)})}Tt((ht,O,ft,Dt)=>{Y(pt,`${ht??""}%`),Y(R,` ${O??""}`),Y(kt,` ${ft??""}`),Y(J,` ${Dt??""}`)},[()=>f().toFixed(1),()=>l(i).toLocaleString(),()=>l(s).toLocaleString(),()=>Object.values(l(o)).filter(Boolean).length],Re),fe(M,()=>l(o).asa_high,ht=>Zt(o,l(o).asa_high=ht)),fe(S,()=>l(o).emergency,ht=>Zt(o,l(o).emergency=ht)),fe(w,()=>l(o).low_albumin,ht=>Zt(o,l(o).low_albumin=ht)),fe(k,()=>l(o).old_age,ht=>Zt(o,l(o).old_age=ht)),fe(V,()=>l(o).obesity,ht=>Zt(o,l(o).obesity=ht)),fe(q,()=>l(o).long_surgery,ht=>Zt(o,l(o).long_surgery=ht)),fe(j,()=>l(c),ht=>F(c,ht)),X(g,x)},y=g=>{var x=rp();X(g,x)};Et(A,g=>{n()&&n().length>0?g(L):g(y,!1)})}p(m),X(t,m),Ae()}var sp=K('<p class="py-16 text-center text-lg">Loading VitalDB dataset …</p>'),op=K('<button class="absolute top-1/2 left-4 z-50 -translate-y-1/2 cursor-pointer rounded-full bg-gray-800/80 p-2 shadow-lg hover:bg-gray-700"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-200" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></button>'),lp=K('<button class="absolute top-1/2 right-4 z-50 -translate-y-1/2 cursor-pointer rounded-full bg-gray-800/80 p-2 shadow-lg hover:bg-gray-700"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-200" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button>'),cp=K("<button></button>"),up=K('<div class="absolute inset-0 overflow-y-auto transition-opacity duration-300 svelte-1xekagg"><!></div>'),fp=K('<!> <!> <div class="absolute bottom-4 left-1/2 z-50 flex -translate-x-1/2 gap-2"></div> <!>',1);function bp(t,e){Me(e,!1);let n=H([]),r=H(!0),a=H(0),i=H(!1);const s=300,o=[{id:"hook",content:ll},{id:"transition",content:Di,props:{lines:["First, let's meet our patients:","who are they, and where do they come from?"]}},{id:"demographics",content:rh},{id:"transition",content:Di,props:{lines:["Knowing who our patients are, the next question is:","how long do we spend on each phase of their care?"]}},{id:"timeline",content:hh},{id:"waterfall",content:ip},{id:"albumin",content:Mh},{id:"buildPatient",content:Hh},{id:"makeAGuess",content:tp},{id:"takeaway",content:$h},{id:"writeup",content:Sh}],c=o.length;function u(){l(a)<c-1&&!l(i)&&(F(i,!0),sr(a),setTimeout(()=>{F(i,!1)},s))}function d(){l(a)>0&&!l(i)&&(F(i,!0),sr(a,-1),setTimeout(()=>{F(i,!1)},s))}function f(x){x>=0&&x<c&&!l(i)&&(F(i,!0),F(a,x),setTimeout(()=>{F(i,!1)},s))}function h(x){x.key==="ArrowRight"||x.key==="ArrowDown"?u():(x.key==="ArrowLeft"||x.key==="ArrowUp")&&d()}Ee(()=>(window.addEventListener("keydown",h),()=>{window.removeEventListener("keydown",h)}));function m(x){return x==null||x.trim()===""?"":/^[+\-]?\d+(\.\d+)?$/.test(x)?+x:x}Ee(async()=>{const x=`${Co}/cases.csv`;F(n,await tl(x,b=>{const C={};for(const $ in b)C[$]=m(b[$]);return C})),F(r,!1)}),ot(()=>l(n),()=>{if(l(n).length>0){let T=function(S,E){const w=S.avgWait;S.count++,S.avgWait=(w*(S.count-1)+E)/S.count,S.stdDev=Math.sqrt(((S.count-2)*S.stdDev*S.stdDev+(E-w)*(E-S.avgWait))/(S.count-1))};const x=l(n).filter(S=>S.emop===1&&(S.preop_alb??0)<3),b=l(n).filter(S=>S.emop===0&&(S.preop_alb??0)>3.5),C=x.length>0?x.reduce((S,E)=>S+(E.death_inhosp??0),0)/x.length:0,$=b.length>0?b.reduce((S,E)=>S+(E.death_inhosp??0),0)/b.length:0;console.log("Emergency Low Alb Mortality:",(C*100).toFixed(1)+"%"),console.log("Elective High Alb Mortality:",($*100).toFixed(1)+"%"),console.log("Ratio:",(C/($||.001)).toFixed(1)+"x");const N=new Map,M=new Map;l(n).forEach(S=>{if(S.department&&S.optype&&S.anestart&&S.opstart){const E=(S.opstart-S.anestart)/60;N.has(S.department)||N.set(S.department,{count:0,avgWait:0,stdDev:0}),T(N.get(S.department),E),M.has(S.optype)||M.set(S.optype,{count:0,avgWait:0,stdDev:0}),T(M.get(S.optype),E)}}),console.log(`
Department Timing Patterns (sorted by case count):`),Array.from(N.entries()).sort((S,E)=>E[1].count-S[1].count).forEach(([S,E])=>{console.log(`${S}: ${E.count} cases, avg wait ${E.avgWait.toFixed(1)} ± ${E.stdDev.toFixed(1)} min`)}),console.log(`
Surgery Type Timing Patterns (top 10 by case count):`),Array.from(M.entries()).sort((S,E)=>E[1].count-S[1].count).slice(0,10).forEach(([S,E])=>{console.log(`${S}: ${E.count} cases, avg wait ${E.avgWait.toFixed(1)} ± ${E.stdDev.toFixed(1)} min`)})}}),We(),Xe();var A=Wn(),L=Ce(A);{var y=x=>{var b=sp();X(x,b)},g=x=>{var b=fp(),C=Ce(b);{var $=E=>{var w=op();Tt(()=>w.disabled=l(a)===0||l(i)),Ve("click",w,d),X(E,w)};Et(C,E=>{l(a)>0&&E($)})}var N=_(C,2);{var M=E=>{var w=lp();Tt(()=>w.disabled=l(a)===c-1||l(i)),Ve("click",w,u),X(E,w)};Et(N,E=>{l(a)<c-1&&E(M)})}var T=_(N,2);zn(T,5,()=>o,Dn,(E,w,P)=>{var k=cp();Tt(()=>{Kt(k,1,`h-3 w-3 rounded-full transition-all duration-300
					${l(a)===P?"bg-text-accent ":"bg-gray-700 hover:bg-gray-500"}`),k.disabled=l(i)}),Ve("click",k,()=>f(P)),X(E,k)}),p(T);var S=_(T,2);zn(S,1,()=>o,Dn,(E,w,P)=>{var k=Wn(),z=Ce(k);{var V=I=>{var q=up(),it=v(q);{var G=B=>{var U=Wn(),j=Ce(U);const st=Re(()=>{var ct;return((ct=l(w).props)==null?void 0:ct.lines)||[]});Qa(j,()=>l(w).content,(ct,yt)=>{yt(ct,{get lines(){return l(st)}})}),X(B,U)},pt=B=>{Uo(B,{class:"min-h-full py-10",children:(U,j)=>{var st=Wn(),ct=Ce(st);Qa(ct,()=>l(w).content,(yt,R)=>{R(yt,Ao({get cases(){return l(n)}},()=>l(w).props||{}))}),X(U,st)}})};Et(it,B=>{l(w).id==="transition"?B(G):B(pt,!1)})}p(q),Tt(()=>Gi(q,`opacity: ${l(i)?0:1}`)),X(I,q)};Et(z,I=>{l(a)===P&&I(V)})}X(E,k)}),X(x,b)};Et(L,x=>{l(r)?x(y):x(g,!1)})}X(t,A),Ae()}export{bp as component};
